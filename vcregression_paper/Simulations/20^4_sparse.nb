(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    195189,       5097]
NotebookOptionsPosition[    179987,       4859]
NotebookOutlinePosition[    180498,       4878]
CellTagsIndexPosition[    180455,       4875]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Set up", "Section",
 CellChangeTimes->{{3.8587611622123327`*^9, 
  3.8587611631546793`*^9}},ExpressionUUID->"8255f4dc-e6d6-45f6-b95a-\
c7a6e3991284"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"alpha", "=", "20"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"l", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"hd", "=", "\"\</Users/keitokiddo/VC_revision/Simulations/\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"fl", "=", "\"\<20_4_SPR\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"wd", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"hd", ",", "fl"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "wd", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.860875605343582*^9, 3.8608756137532263`*^9}, 
   3.861886504407048*^9, {3.863525178299096*^9, 3.863525178720635*^9}, {
   3.8635262735586157`*^9, 3.863526279211999*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c6201ce7-f7de-481b-bfbf-c8977f47e32b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrep", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nprop", "=", "13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"schemes", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<random\>\"", ",", "\"\<noised\>\"", ",", "\"\<mut\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nschemes", "=", 
   RowBox[{"Length", "@", "schemes"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8596383416012373`*^9, 3.8596383431295357`*^9}, {
   3.860872000883339*^9, 3.860872001769627*^9}, 3.861882666167819*^9, {
   3.861954994024149*^9, 3.861954997642892*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"970b4e34-1f33-4eaa-9d44-033321ed119b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"alpha", "-", "1"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"the", " ", "alphabet", " ", "in", " ", "numbers", " ", "0"}], 
    "-", "19"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sequences", "=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"A", ",", "l"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"list", " ", "of", " ", "all", " ", "sequences"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"seq2pos", "[", "seq_", "]"}], ":=", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{"seq", ",", "alpha"}], "]"}], "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"multiplicities", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{"l", ",", "k"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"alpha", "-", "1"}], ")"}], "^", "k"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"wt", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "l"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<K\>\"", ",", "\"\<R\>\"", ",", "\"\<H\>\"", ",", "\"\<E\>\"", ",", 
     "\"\<D\>\"", ",", "\"\<N\>\"", ",", "\"\<Q\>\"", ",", "\"\<T\>\"", ",", 
     "\"\<S\>\"", ",", "\"\<C\>\"", ",", "\"\<G\>\"", ",", "\"\<A\>\"", ",", 
     "\"\<V\>\"", ",", "\"\<L\>\"", ",", "\"\<I\>\"", ",", "\"\<M\>\"", ",", 
     "\"\<P\>\"", ",", "\"\<Y\>\"", ",", "\"\<F\>\"", ",", "\"\<W\>\""}], 
    "}"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"the", " ", "alphabet", " ", "in", " ", "amino", " ", "acids"}], 
   "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AAtoDigitRules", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AA", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
      RowBox[{"i", "-", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "20"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"convert", " ", "amino", " ", "acids", " ", "to", " ", "numbers"}],
    "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DigitToAARules", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"i", "-", "1"}], "->", 
      RowBox[{"AA", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "20"}], "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"convert", " ", "numbers", " ", "to", " ", "amino", " ", "acids"}],
    "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sequencesAA", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"#", "/.", "DigitToAARules"}], "]"}], "&"}], "/@", 
    "sequences"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "list", " ", "of", " ", "all", " ", "possible", " ", "sequences", " ", 
    "in", " ", "amino", " ", "acids"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"wtAA", " ", "=", " ", 
  RowBox[{"sequencesAA", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Binomial", "[", 
       RowBox[{"l", ",", "k"}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"alpha", "-", "1"}], ")"}], "^", "k"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.765809188632872*^9, 3.765809230513093*^9, {3.765818554425509*^9, 
   3.7658185803234243`*^9}, 3.766229531853812*^9, 3.766229579196743*^9, {
   3.766229619564746*^9, 3.766229838748877*^9}, {3.766229919109879*^9, 
   3.7662301636376123`*^9}, {3.7662301945029373`*^9, 
   3.7662302338331842`*^9}, {3.783274186128935*^9, 3.783274231984097*^9}, {
   3.783274330146632*^9, 3.783274333883054*^9}, {3.783275180656855*^9, 
   3.783275195589322*^9}, 3.783275352797121*^9, {3.785018447155464*^9, 
   3.785018451227006*^9}, {3.8586726205152683`*^9, 3.858672621253992*^9}, 
   3.8586729723301907`*^9, {3.858765737585622*^9, 3.8587657377362957`*^9}, 
   3.859024992185452*^9, {3.8592882938463078`*^9, 3.85928829451423*^9}, {
   3.860614807245092*^9, 3.860614808145941*^9}, {3.860874232977372*^9, 
   3.860874235506974*^9}, 3.8608755799879217`*^9, {3.861882671117221*^9, 
   3.861882680609467*^9}, 3.8635264143343163`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"1e78e5b0-f344-45ff-8e2b-0fb43558fe94"],

Cell[BoxData["\<\"KKKK\"\>"], "Output",
 CellChangeTimes->{{3.863526415998824*^9, 3.863526420140534*^9}, 
   3.863526688117106*^9, 3.863814218468355*^9, 3.8638186736237917`*^9, 
   3.863902920785366*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"0ef5c60d-c5ed-4da3-8229-3cb0c44ed6dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MakeLapRec", "[", 
   RowBox[{"alpha_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L1", ",", "L", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"L1", " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"alpha", "*", 
         RowBox[{"IdentityMatrix", "[", "alpha", "]"}]}], " ", "-", " ", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"alpha", "^", "2"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"alpha", ",", "alpha"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", "L1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"m", "<", "l"}], ",", " ", 
       RowBox[{
        RowBox[{"L", " ", "=", " ", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"L", ",", " ", 
            RowBox[{"IdentityMatrix", "[", "alpha", "]"}]}], "]"}], " ", "+", 
          " ", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"alpha", "^", "m"}], "]"}], ",", "L1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", "L"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["L",
     FontSize->14], "=", 
    RowBox[{"MakeLapRec", "[", 
     RowBox[{"alpha", ",", "l"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{3.860614940006853*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"72640224-a894-4f22-99de-148c168d8b97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.563417`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.861045820432228*^9, 3.861093593102775*^9, 
  3.861093623671279*^9, 3.861096096984899*^9, 3.861720277864979*^9, 
  3.861804815732686*^9, 3.8618826493449907`*^9, 3.861882692508133*^9, 
  3.863523655628274*^9, 3.863525346314151*^9, 3.863526310560869*^9, 
  3.86352642119879*^9, 3.863526688722562*^9, 3.8638142211192827`*^9, 
  3.863818674463643*^9, 3.863902921605959*^9, 3.863902970383005*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"fc432362-7d5a-4e1d-bf94-99d7dd2190da"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samplesizes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"i", " ", 
       RowBox[{"Length", "[", "sequences", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".01", ",", ".05"}], "}"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{".1", ",", ".9", ",", ".1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{".95", ",", ".99"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"proportions", "=", 
   RowBox[{"samplesizes", "/", 
    RowBox[{"(", 
     RowBox[{"alpha", "^", "l"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783344917635714*^9, 3.783344957829818*^9}, {
   3.785242990982191*^9, 3.785242998510944*^9}, 3.8610973995209913`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"e0a7b1b7-80db-45ce-bc80-b60878572f29"],

Cell[CellGroupData[{

Cell["Export design matrix for glmnet", "Subsubsection",
 CellChangeTimes->{{3.8606174063126907`*^9, 
  3.8606174107511797`*^9}},ExpressionUUID->"5426ef2c-f775-46b3-b6e0-\
9cb34b9e7f57"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"varall", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"alpha", "^", "l"}]}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.858683469175782*^9, 3.858683478361032*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"1b567513-385b-46b7-9d23-15c55aa9b243"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"designAllonehot", "=", 
     RowBox[{"s2donehot", "[", 
      RowBox[{"sequences", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "l"}], "]"}]}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7838770543431377`*^9, 3.783877058392404*^9}, {
  3.785257343865099*^9, 3.785257350230983*^9}, {3.785257780115623*^9, 
  3.7852577840989428`*^9}, {3.787334756906878*^9, 3.787334780354789*^9}, {
  3.787335186703807*^9, 3.787335187276825*^9}, {3.8608737667839737`*^9, 
  3.86087376898272*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"96adc3ed-5a30-4499-9da1-6f5b1219ebce"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"rules", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"designrules", "[", 
             RowBox[{
              RowBox[{"sequences", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "k", ",", "wt", ",", 
              "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "sequences", "]"}]}], "}"}]}], "]"}], ",", 
       "2"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"null3", "=", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"rules", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sequences", "]"}], ",", 
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{"l", ",", " ", "k"}], "]"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "k"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<data/rules.tsv\>\"", ",", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Most", "[", 
            RowBox[{"ArrayRules", "[", "null3", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Most", "[", 
            RowBox[{"ArrayRules", "[", "null3", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], ",", 
      "\"\<TSV\>\""}], "]"}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.787336150219553*^9, 3.787336156771068*^9}, {
  3.860615713236985*^9, 3.860615713773657*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"08cd1362-02fa-4e84-8cb7-7e548c6c9c35"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import FL", "Subsection",
 CellChangeTimes->{{3.860770032999793*^9, 
  3.8607700463272753`*^9}},ExpressionUUID->"79ce1be8-de6f-4bab-9b49-\
30f382e09f8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nrep"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
        "\"\<data/\>\"", ",", "fl", ",", "  ", "\"\<_f_\>\"", ",", " ", 
         RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
       "]"}], "//", "Flatten"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "nrep"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fns", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "nrep"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fns", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
        "\"\<data/\>\"", ",", "fl", ",", "  ", "\"\<_f_\>\"", ",", 
         "\"\<noised_\>\"", ",", " ", 
         RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
         "\"\<0.2\>\"", ",", "\"\<.tsv\>\""}], "]"}], "]"}], "//", 
      "Flatten"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "nrep"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.86077009602034*^9, 3.860770102229315*^9}, 
   3.860770306181979*^9, {3.860770819541499*^9, 3.860770831158914*^9}, {
   3.862317713148353*^9, 3.862317761207322*^9}, {3.8623866172410583`*^9, 
   3.8623866174380713`*^9}, {3.863725301632058*^9, 3.863725317632436*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"4f4df399-5ad1-420e-8b08-094c8e61618e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import training samples", "Subsection",
 CellChangeTimes->{{3.86077004763728*^9, 
  3.860770054963491*^9}},ExpressionUUID->"bd51a80d-6127-42f4-af36-\
3c001b6cbe7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Length", "@", "proportions"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"trs", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<data/\>\"", ",", " ", "\"\<tr_\>\"", ",", 
        RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
      "]"}], "//", "Flatten"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "@", "proportions"}]}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"tts", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"alpha", "^", "l"}], "]"}], ",", 
       RowBox[{"trs", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "trs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"fb56d93f-a92a-43ab-9941-b4f921c1f35b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trsmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Length", "@", "proportions"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"trsmut", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<data/\>\"", ",", " ", "\"\<tr_mut_\>\"", ",", 
        RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
      "]"}], "//", "Flatten"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "@", "trsmut"}]}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"ttsmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"alpha", "^", "l"}], "]"}], ",", 
       RowBox[{"trsmut", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "trsmut", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.860770191972074*^9, 3.860770201134274*^9}, 
   3.860770303309534*^9, {3.860770793353057*^9, 3.860770815604604*^9}, {
   3.860832112039754*^9, 3.860832118904027*^9}, 3.8608399111540127`*^9, {
   3.861306224871719*^9, 3.8613062254843197`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"2be41ddf-3da4-46b0-a469-4c40be47093b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["*Functions", "Section",
 CellChangeTimes->{{3.7335158887380867`*^9, 3.733515889676353*^9}, 
   3.786385528376131*^9},ExpressionUUID->"7e936800-8126-4c8e-aa8f-\
97aadbe0ddde"],

Cell[CellGroupData[{

Cell["Basic functions", "Subsection",
 CellChangeTimes->{{3.783446856410367*^9, 3.7834468579394484`*^9}, {
  3.7836868814985313`*^9, 
  3.783686883507257*^9}},ExpressionUUID->"db3b4267-3ba0-4972-a7c8-\
6da316e8d80c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dp", "[", "v_", "]"}], ":=", 
  RowBox[{"v", "//", "DeleteDuplicates"}]}], "\n", 
 RowBox[{
  RowBox[{"uqc", "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{"v", "//", "DeleteDuplicates"}], "//", "Length"}]}], "\n", 
 RowBox[{
  RowBox[{"lg", "[", "v_", "]"}], ":=", 
  RowBox[{"v", "//", "Length"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", "[", "m_", "]"}], ":=", 
  RowBox[{"m", "//", "Dimensions"}]}]}], "Input",
 CellChangeTimes->{{3.7818888604652367`*^9, 3.781888869322523*^9}, {
   3.781906467636136*^9, 3.781906484693853*^9}, 3.785018461724689*^9, 
   3.7850185069229517`*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"5c33b1d5-d0c7-4e1f-a7e2-c3a497aecdf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"seq2posAA", "[", "seqAA_", "]"}], ":=", 
  RowBox[{"seq2pos", "[", 
   RowBox[{
    RowBox[{"Characters", "[", "seqAA", "]"}], "/.", "AAtoDigitRules"}], 
   "]"}]}]], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"cc1c5b1a-d627-4144-bd4c-4b625d1c56ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"associate0", "[", 
   RowBox[{"list_", ",", "obj_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"list", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "->", "obj"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7832653184669533`*^9, 3.783265348782815*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"5cf94715-b799-418f-a7b0-d75b1bef617c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeDiagonal", "[", "vect_", "]"}], ":=", " ", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "i"}], "}"}], "->", 
      RowBox[{"vect", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "vect", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"a83161ee-3c08-4d6b-862e-4338bfc3968e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nbysum", "[", "y_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"Total", "[", "y", "]"}]}], ")"}], "*", "y"}]}], "\n", 
 RowBox[{
  RowBox[{"Nbyfirst", "[", "y_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"First", "@", "y"}]}], ")"}], "*", "y"}]}]}], "Input",
 CellChangeTimes->{{3.739979078807541*^9, 3.739979101020073*^9}, 
   3.7832913778620567`*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"bb1f8a3f-4306-403e-bd6a-4c8a7e959465"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ginv", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "[", "x", "]"}], "==", "0."}], ",", "0", ",", 
    RowBox[{"1", "/", "x"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.783344035981493*^9, 3.783344065586173*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"21d0be93-3ad9-4411-b57e-658e863a8524"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"r2", "[", 
     RowBox[{"x_", ",", " ", "y_"}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "x"}], "<", "2"}], ",", " ", 
      RowBox[{"{", "}"}], ",", " ", 
      RowBox[{
       RowBox[{"Correlation", "[", 
        RowBox[{"x", ",", " ", "y"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], 
  "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mse", "[", 
    RowBox[{"x_", ",", " ", "y_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Mean", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", " ", "-", " ", "y"}], ")"}], "^", "2"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"maxorder", "[", "list_", "]"}], " ", ":=", " ", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", " ", "\n", "   ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", " ", ";;"}], "]"}], "]"}], " ", "!=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"Length", "[", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"i", " ", ";;"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         " ", "\n", "    ", 
         RowBox[{"i", "++"}]}], "]"}], ";", " ", 
       RowBox[{"i", " ", "-", " ", "1"}]}]}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "From", " ", "sequence", " ", "to", " ", "lexicographical", " ", 
    "position"}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"seq2pos", "[", "seq_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{"seq", ",", " ", "alpha"}], "]"}], " ", "+", " ", "1"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Map", " ", "a", " ", "vector", " ", "of", " ", "length", " ", "m", " ", 
    "to", " ", "a", " ", "vector", " ", "of", " ", "length", " ", 
    RowBox[{
     RowBox[{"alpha", "^", "l"}], ".", " ", "\"\<list\>\""}], " ", "contains",
     " ", "the", " ", "lexicographical", " ", "positions", " ", "for", " ", 
    "all", " ", "sequences", " ", "in", " ", "\"\<data\>\""}], "*)"}], 
  RowBox[{
   RowBox[{"MapPartialVal", "[", 
    RowBox[{"list_", ",", "data_", ",", "height_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Ab", "}"}], ",", 
     RowBox[{
      RowBox[{"Ab", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"list", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", 
               RowBox[{"Length", "[", "list", "]"}]}], "]"}]}], "}"}], "]"}], 
          "->", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"height", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      RowBox[{"Ab", ".", "data"}]}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.766313986573913*^9, 3.7663139865999117`*^9}, 
   3.766314018570455*^9, 3.766314054454777*^9, {3.766918374798053*^9, 
   3.766918375323598*^9}, {3.766933287510947*^9, 3.766933303779005*^9}, {
   3.76693447774188*^9, 3.766934479190014*^9}, {3.783275084640926*^9, 
   3.7832751364618587`*^9}, {3.783292092099407*^9, 3.783292092576839*^9}, {
   3.783686214211725*^9, 3.783686219245088*^9}, {3.78368660982717*^9, 
   3.783686647156082*^9}, {3.7850184617356033`*^9, 3.785018461748094*^9}, {
   3.859280425446402*^9, 3.859280439984137*^9}, {3.8592804937568073`*^9, 
   3.859280499607479*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"b6327d00-ec2c-41f7-aaa1-cdea5c1c9128"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projection operators", "Subsection",
 CellChangeTimes->{{3.783686545560483*^9, 
  3.78368655178538*^9}},ExpressionUUID->"2c17d055-e7e1-447e-8254-\
2d0b511173ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pby", "[", 
    RowBox[{"x_", ",", "Pcoeffs_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Pcoeffs", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", 
       RowBox[{"maxorder", "[", "Pcoeffs", "]"}]}], "]"}], "]"}], ".", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
      RowBox[{
       RowBox[{"maxorder", "[", "Pcoeffs", "]"}], "-", "1"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.7392763243559313`*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"68507c79-5cf7-467d-bf80-de3e8afd0df4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pkby", "[", 
    RowBox[{"x_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Pcoeffs", "}"}], ",", 
     RowBox[{
      RowBox[{"Pcoeffs", "=", 
       RowBox[{
        RowBox[{"Inverse", "[", "LPs", "]"}], ".", 
        RowBox[{"wkd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"Pcoeffs", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"maxorder", "[", "Pcoeffs", "]"}]}], "]"}], "]"}], ".", 
       RowBox[{"NestList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
         RowBox[{
          RowBox[{"maxorder", "[", "Pcoeffs", "]"}], "-", "1"}]}], 
        "]"}]}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7832761735711946`*^9, 3.7832761931318903`*^9}, {
  3.7832762386144876`*^9, 3.7832762534338827`*^9}, {3.783276354301653*^9, 
  3.783276354546401*^9}, {3.785018461756366*^9, 3.7850184617592688`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"d5b672b6-30c8-4eab-b184-291d55998634"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regression functions", "Subsection",
 CellChangeTimes->{{3.783686555977028*^9, 3.783686562291398*^9}, {
  3.7836869188645353`*^9, 
  3.7836869199685*^9}},ExpressionUUID->"7fbe713f-9d09-45cc-a360-8534445537a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Ridge", " ", "regression", " ", "with", " ", "regularization", " ", 
    "parameter", " ", "\"\<\[CapitalIHat]\[RightGuillemet]\>\"", " ", "and", 
    " ", "design", " ", "matrix", " ", "\"\<design\>\""}], "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"RidgeRegression", "[", 
     RowBox[{
     "design_", ",", " ", "response_", ",", " ", 
      "\[CapitalIHat]\[RightGuillemet]_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cross", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"cross", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "design", "]"}], ".", "design"}]}], ";", 
       "\n", "  ", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cross", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "+=", " ", 
          RowBox[{"\[CapitalIHat]\[RightGuillemet]", "^", "2"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "cross", "]"}]}], "}"}]}], "]"}], ";", "\n",
        "  ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"cross", ",", "\n", "   ", 
         RowBox[{
          RowBox[{"Transpose", "[", "design", "]"}], ".", "response"}], ",", 
         "\n", "   ", 
         RowBox[{"Method", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Krylov\>\"", ",", " ", 
            RowBox[{
            "\"\<Method\>\"", " ", "->", " ", "\"\<ConjugateGradient\>\""}], 
            ",", " ", "\n", "     ", 
            RowBox[{
            "\"\<Preconditioner\>\"", " ", "->", " ", "\"\<ILU0\>\""}]}], 
           "}"}]}]}], "]"}]}]}], "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Ordinary", " ", "least", " ", "square", " ", "regression"}], 
    "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"OrdinaryRegression", "[", 
     RowBox[{"design_", ",", " ", "response_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cross", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"cross", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "design", "]"}], ".", "design"}]}], ";", 
       "\n", "  ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"cross", ",", " ", 
         RowBox[{
          RowBox[{"Transpose", "[", "design", "]"}], ".", "response"}], ",", 
         " ", 
         RowBox[{"Method", " ", "->", " ", "\"\<Krylov\>\""}]}], "]"}]}]}], 
     "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Build", " ", "design", " ", "vector", " ", "for", " ", "a", " ", 
     "sequence", " ", "using", " ", "the", " ", "Taylor", " ", "encoding"}], 
    "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"s2dTaylor", "[", 
     RowBox[{"seq_", ",", " ", "order_", ",", " ", "wt_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "seqprime", ",", " ", "sub1", ",", " ", "sub2", ",", " ", "pos"}], 
       "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"seqprime", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"seq", " ", "-", " ", "wt"}], ",", " ", "alpha"}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"sub1", " ", "=", " ", 
        RowBox[{"Subsets", "[", 
         RowBox[{"seqprime", ",", " ", 
          RowBox[{"{", "order", "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"sub2", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", " ", 
            RowBox[{"sub1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "sub1", "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", "\n", "  ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rest", "[", "#", "]"}], " ", "-", " ", "1"}], ",", " ", 
             RowBox[{"alpha", " ", "-", " ", "1"}]}], "]"}], " ", "+", " ", 
           "\n", "      ", "1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "order"}], 
             ")"}]}]}], " ", "&"}], " ", "/@", " ", "\n", "    ", 
         RowBox[{"Select", "[", 
          RowBox[{"sub2", ",", " ", 
           RowBox[{
            RowBox[{"!", " ", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", " ", "0"}], "]"}]}], " ", "&"}]}], "]"}]}]}], 
       ";", "\n", "  ", 
       RowBox[{"SparseArray", "[", "\n", "   ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "->", " ", "1"}], ",", " ", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "\n", "     ", 
             RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ",", " ", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{"l", ",", " ", "order"}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "order"}]}], 
          "}"}]}], "]"}]}]}], "\n", "  ", "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Build", " ", "design", " ", "vector", " ", "for", " ", "sequence", " ", 
      "using", " ", "the", " ", "one"}], "-", 
     RowBox[{"hot", " ", "encoding"}]}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"s2d", "[", 
     RowBox[{"seq_", ",", " ", "order_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sub1", ",", " ", "sub2", ",", " ", "pos"}], "}"}], ",", "\n", 
      "  ", 
      RowBox[{
       RowBox[{"sub1", " ", "=", " ", 
        RowBox[{"Subsets", "[", 
         RowBox[{"seq", ",", " ", 
          RowBox[{"{", "order", "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"sub2", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", " ", 
            RowBox[{"sub1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "sub1", "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", "\n", "  ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{"Rest", "[", "#", "]"}], ",", " ", "alpha"}], "]"}], " ",
            "+", " ", "\n", "      ", "1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{"alpha", "^", "order"}], ")"}]}]}], " ", "&"}], " ", "/@",
          " ", "sub2"}]}], ";", "\n", "  ", 
       RowBox[{"SparseArray", "[", "\n", "   ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "->", " ", "1"}], ",", " ", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "\n", "     ", 
             RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ",", " ", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{"l", ",", " ", "order"}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", "alpha", ")"}], "^", "order"}]}], "}"}]}], "]"}]}]}],
      "\n", "  ", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"designrules", "[", 
     RowBox[{"seq_", ",", " ", "order_", ",", " ", "wt_", ",", "j_"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "seqprime", ",", " ", "sub1", ",", " ", "sub2", ",", " ", "pos"}], 
       "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"seqprime", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"seq", " ", "-", " ", "wt"}], ",", " ", "alpha"}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"sub1", " ", "=", " ", 
        RowBox[{"Subsets", "[", 
         RowBox[{"seqprime", ",", " ", 
          RowBox[{"{", "order", "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"sub2", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", " ", 
            RowBox[{"sub1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "sub1", "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", "\n", "  ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rest", "[", "#", "]"}], " ", "-", " ", "1"}], ",", " ", 
             RowBox[{"alpha", " ", "-", " ", "1"}]}], "]"}], " ", "+", " ", 
           "\n", "      ", "1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "order"}], 
             ")"}]}], "+", " ", 
           RowBox[{"Total", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Binomial", "[", 
                RowBox[{"l", ",", "k"}], "]"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], "^", 
                RowBox[{"(", "k", ")"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "0", ",", 
                RowBox[{"order", "-", "1"}]}], "}"}]}], "]"}]}]}], "&"}], " ",
          "/@", " ", "\n", "    ", 
         RowBox[{"Select", "[", 
          RowBox[{"sub2", ",", " ", 
           RowBox[{
            RowBox[{"!", " ", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", " ", "0"}], "]"}]}], " ", "&"}]}], "]"}]}]}], 
       ";", "\n", "  ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], " ", "->", " ", "1"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "\n", "     ", 
           RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}]}]}], "\n", 
     "  ", "]"}]}], "\n", 
   RowBox[{
    RowBox[{"s2dTaylor2", "[", 
     RowBox[{"seqs_", ",", "order_", ",", "wt_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"designrules", "[", 
                RowBox[{
                 RowBox[{"seqs", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "k", ",", "wt", ",", 
                 "j"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "order"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "seqs", "]"}]}], "}"}]}], "]"}], ",", 
          "2"}], "]"}]}], ";", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"rules", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "seqs", "]"}], ",", 
           RowBox[{"Total", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Binomial", "[", 
                RowBox[{"l", ",", " ", "k"}], "]"}], "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "k"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "order"}], "}"}]}], "]"}]}]}], "}"}]}], 
        "]"}]}]}], "]"}]}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.785018461771922*^9, 3.78501846177962*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"122b81da-d265-40d1-93da-30c64380b579"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kernelized regressions", "Subsection",
 CellChangeTimes->{{3.7836869114185877`*^9, 
  3.783686914475037*^9}},ExpressionUUID->"f4997e82-59c3-4cb9-9040-\
88a5534f6e23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CIby", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"-", "alpha"}], "/", "2"}], ",", 
      RowBox[{"1", "/", "2"}]}], "}"}], ".", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", "2"}], "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Similar", " ", "to", " ", 
     RowBox[{"C", ".", "f"}]}], ",", " ", 
    RowBox[{
    "we", " ", "implement", " ", "multiplication", " ", "by", " ", "a", " ", 
     "matrix", " ", "that", " ", "can", " ", "be", " ", "expressed", " ", 
     "as", " ", "a", " ", "polynomial", " ", "in", " ", "L", " ", "using", 
     " ", 
     RowBox[{"NestList", "."}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"coeffsinLn", ":", " ", 
    RowBox[{"vector", " ", "of", " ", "coefficients", " ", "for", " ", 
     RowBox[{"L", "^", "n"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SprsinLnBy", "[", 
    RowBox[{"x_", ",", "coeffsinLn_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"coeffsinLn", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", 
       RowBox[{"maxorder", "[", "coeffsinLn", "]"}]}], "]"}], "]"}], ".", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
      RowBox[{
       RowBox[{"maxorder", "[", "coeffsinLn", "]"}], "-", "1"}]}], "]"}]}]}], 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Apply", " ", "the", " ", "locally", " ", "non"}], "-", 
    RowBox[{
    "epistatic", " ", "smoother", " ", "M", " ", "to", " ", "a", " ", 
     "vector"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Smooth", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{"l", ",", "2"}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"alpha", "-", "1"}], ")"}], "^", "2"}]}], ")"}]}], 
       ")"}]}], 
     RowBox[{"CIby", "[", "x", "]"}]}], "+", "x"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "the", " ", "average", " ", "squared", " ", "epistasic", 
    " ", "coefficient", " ", "for", " ", "a", " ", "vector", " ", "x"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cnorm", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"(", "nfaces", ")"}]}], ")"}], 
   RowBox[{"x", ".", 
    RowBox[{"CIby", "[", "x", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.785018538945465*^9, 3.785018550834106*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"824ea2bf-89a7-4baf-be69-4785e762c74f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Multiplication", " ", "by", " ", "the", " ", "C", " ", "matrix", " ", 
     "defined", " ", "in", " ", "the", " ", "main", " ", 
     RowBox[{"text", ".", " ", "For"}], " ", "the", " ", "matrix", " ", "by", 
     " ", "vector", " ", "multiplication", " ", 
     RowBox[{"C", ".", "f"}]}], ",", " ", 
    RowBox[{"we", " ", "evaluate", " ", "it", " ", "as", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "alpha"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], ".", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"L", ".", "f"}], ",", 
        RowBox[{"L", ".", "L", ".", "f"}]}], "}"}]}], " ", "using", " ", 
     "the", " ", "function", " ", 
     RowBox[{"NestList", ".", " ", "Note"}], " ", "that", " ", "we", " ", 
     "have", " ", "omitted", " ", "the", " ", "constant", " ", 
     RowBox[{"1", "/", "s"}]}], ",", " ", 
    RowBox[{
    "since", " ", "it", " ", "does", " ", "not", " ", "affect", " ", "the", 
     " ", "solution", " ", "to", " ", "the", " ", "linear", " ", 
     "equation"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Minimum", " ", "epistasis", " ", "interpolation", " ", "solver"}],
    "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Cinterp", "[", 
     RowBox[{"training_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ai", ",", "Ab"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Ai", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"alpha", "^", "l"}]}], "]"}], ",", "training"}], 
               "]"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{
                 RowBox[{"alpha", "^", "l"}], "-", 
                 RowBox[{"Length", "[", "training", "]"}]}]}], "]"}]}], "}"}],
             "]"}], "->", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"alpha", "^", "l"}], ",", 
            RowBox[{
             RowBox[{"alpha", "^", "l"}], "-", 
             RowBox[{"Length", "[", "training", "]"}]}]}], "}"}]}], "]"}]}], 
       ";", 
       RowBox[{"Ab", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"training", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "training", "]"}]}], "]"}]}], "}"}], 
            "]"}], "->", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"alpha", "^", "l"}], ",", 
            RowBox[{"Length", "[", "training", "]"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ai", ".", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "Ai", "]"}], ".", 
              RowBox[{"CIby", "[", 
               RowBox[{"Ai", ".", "#"}], "]"}]}], "&"}], ",", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"Transpose", "[", "Ai", "]"}], ".", 
              RowBox[{"CIby", "[", 
               RowBox[{"Ab", ".", "y"}], "]"}]}]}], ",", 
            RowBox[{"Method", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<Krylov\>\"", ",", 
               RowBox[{"Method", "->", "\"\<ConjugateGradient\>\""}], ",", 
               RowBox[{"Tolerance", "->", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "15"}]}]}]}], "}"}]}]}], "]"}]}], ")"}], "+", 
        RowBox[{"Ab", ".", "y"}]}]}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "Regularized", " ", "regression", " ", "with", " ", "regularization", " ",
      "parameter", " ", "given", " ", "by", " ", 
     RowBox[{"\"\<rp\>\"", ".", " ", "\"\<Ccoeffs\>\""}], " ", "and", " ", 
     "\"\<Pcoeffs\>\"", " ", "contain", " ", "entries", " ", "for", " ", "a", 
     " ", "general", " ", "cost", " ", "matrix", " ", "C", " ", 
     RowBox[{"(", 
      RowBox[{
      "not", " ", "necessarily", " ", "the", " ", "C", " ", "used", " ", "in",
        " ", "the", " ", "minimum", " ", "epistasis", " ", "interpolation", 
       " ", "problem"}], ")"}], " ", "and", " ", "projection", " ", "matrix", 
     " ", "P", " ", "each", " ", "of", " ", "which", " ", "is", " ", 
     "represented", " ", "as", " ", "the", " ", "coefficients", " ", "of", 
     " ", "a", " ", "polynomial", " ", "in", " ", 
     RowBox[{"L", ".", " ", "\"\<Ccoeffs\>\""}], " ", "and", " ", 
     "\"\<Pcoeffs\>\"", " ", "for", " ", "fitting", " ", "models", " ", "of", 
     " ", "different", " ", "orders", " ", "are", " ", "defined", " ", 
     "below"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Creg", "[", 
     RowBox[{
     "Ccoeffs_", ",", "Pcoeffs_", ",", "training_", ",", "data_", ",", "rp_", 
      ",", "var_", ",", "startingvector_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ab", ",", "W", ",", "Cby", ",", "Pby"}], "}"}], ",", 
      RowBox[{
       RowBox[{"W", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Length", "[", "data", "]"}]}], ")"}], " ", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"training", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"training", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "->", 
              RowBox[{"(", 
               RowBox[{"1", "/", 
                RowBox[{"var", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "training", "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"alpha", "^", "l"}], ",", 
             RowBox[{"alpha", "^", "l"}]}], "}"}]}], "]"}]}]}], ";", 
       RowBox[{"Ab", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"training", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "training", "]"}]}], "]"}]}], "}"}], 
            "]"}], "->", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"alpha", "^", "l"}], ",", 
            RowBox[{"Length", "[", "training", "]"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"Cby", "[", "x_", "]"}], ":=", 
        RowBox[{"rp", "*", 
         RowBox[{
          RowBox[{"Ccoeffs", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"maxorder", "[", "Ccoeffs", "]"}]}], "]"}], "]"}], ".", 
          RowBox[{"NestList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
            RowBox[{
             RowBox[{"maxorder", "[", "Ccoeffs", "]"}], "-", "1"}]}], 
           "]"}]}]}]}], ";", 
       RowBox[{
        RowBox[{"Pby", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Pcoeffs", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"maxorder", "[", "Pcoeffs", "]"}]}], "]"}], "]"}], ".", 
         RowBox[{"NestList", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
           RowBox[{
            RowBox[{"maxorder", "[", "Pcoeffs", "]"}], "-", "1"}]}], 
          "]"}]}]}], ";", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cby", "[", "#", "]"}], "+", 
            RowBox[{"Pby", "[", 
             RowBox[{"W", ".", 
              RowBox[{"Pby", "[", "#", "]"}]}], "]"}]}], ")"}], "&"}], ",", 
         RowBox[{"Pby", "[", 
          RowBox[{"W", ".", "Ab", ".", "data"}], "]"}], ",", 
         RowBox[{"Method", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<Krylov\>\"", ",", 
            RowBox[{"Method", "->", "\"\<ConjugateGradient\>\""}], ",", 
            RowBox[{"\"\<StartingVector\>\"", "->", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "startingvector", "]"}], "==", "0"}], 
               ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"alpha", "^", "l"}]}], "]"}], ",", 
               "startingvector"}], "]"}]}]}], "}"}]}]}], "]"}]}]}], "]"}]}], 
   "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"10", "-", 
     RowBox[{
     "fold", " ", "crossvalidation", " ", "using", " ", "the", " ", 
      "function", " ", "Creg"}]}], "*)"}], 
   RowBox[{
    RowBox[{"CrossvalidationC", "[", 
     RowBox[{
     "Ccoeffs_", ",", "Pcoeffs_", ",", "list_", ",", "response_", ",", "rps_",
       ",", "variance_", ",", "fold_", ",", "rep_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "subsets", ",", "r", ",", "rpsr"}], "}"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"size", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{
          RowBox[{"Length", "[", "response", "]"}], "/", "fold"}], "]"}]}], 
       ";", " ", "\n", 
       RowBox[{"subsets", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "response", "]"}]}], "]"}], "]"}], ",", 
          "size", ",", "size", ",", "1", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", 
       RowBox[{"r", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "rps", "]"}], "+", "1"}]}], "]"}], ",", 
          "rep"}], "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Creg", "[", 
             RowBox[{"Ccoeffs", ",", "Pcoeffs", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"subsets", ",", 
                   RowBox[{"{", "k", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"response", "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"subsets", ",", 
                   RowBox[{"{", "k", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"rps", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"variance", "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"subsets", ",", 
                   RowBox[{"{", "k", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "rps", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "rep"}], "}"}]}], "]"}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"mse", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"subsets", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], "]"}], 
           ",", 
           RowBox[{"response", "[", 
            RowBox[{"[", 
             RowBox[{"subsets", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], "]"}], "\n", 
         ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "rep"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "rps", "]"}]}], "}"}]}], "]"}]}]}], "\n", 
     "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Extract", " ", "best", " ", "regularization", " ", "parameter", " ", 
     "from", " ", "the", " ", "crossvalidation", " ", "outputs"}], "*)"}], 
   RowBox[{
    RowBox[{"CV", "[", 
     RowBox[{"mse_", ",", "rps_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"means", ",", "ses", ",", "min", ",", "bestlambda"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"means", "=", 
        RowBox[{"Mean", "[", "mse", "]"}]}], ";", 
       RowBox[{"ses", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "mse", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "1"}], ",", 
          RowBox[{
           RowBox[{"StandardDeviation", "[", "mse", "]"}], "/", 
           SqrtBox[
            RowBox[{
             RowBox[{"Dimensions", "[", "mse", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]]}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "mse", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       RowBox[{"min", "=", 
        RowBox[{"First", "[", 
         RowBox[{"Ordering", "[", "means", "]"}], "]"}]}], ";", 
       RowBox[{"bestlambda", "=", 
        RowBox[{"rps", "[", 
         RowBox[{"[", "min", " ", "]"}], "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"bestlambda", ",", "means", ",", "ses"}], "}"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7837004472487507`*^9, 3.783700448186143*^9}, {
   3.78501846185739*^9, 3.785018462051797*^9}, 3.785018497034924*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"1e7e2cbc-f673-4c10-93b2-69b34e29b82f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix coefficients", "Subsection",
 CellChangeTimes->{{3.7836865046179857`*^9, 
  3.783686514734417*^9}},ExpressionUUID->"ade545aa-8a37-4b35-abc8-\
53743685e7a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Krawtchouk", " ", "polynomial"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"alpha_", ",", " ", "k_", ",", " ", "d_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{"alpha", "^", 
      RowBox[{"(", 
       RowBox[{"-", "l"}], ")"}]}], " ", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"q", "=", "0"}], 
       RowBox[{"Min", "[", 
        RowBox[{"k", ",", "d"}], "]"}]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "q"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"alpha", "-", "1"}], ")"}], 
        RowBox[{"k", "-", "q"}]], 
       RowBox[{"Binomial", "[", 
        RowBox[{"d", ",", "q"}], "]"}], 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"l", "-", "d"}], ",", 
         RowBox[{"k", "-", "q"}]}], "]"}]}]}]}]}], "\n", 
   RowBox[{
    RowBox[{"wkd", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"alpha", ",", "k", ",", "d"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7836869289740562`*^9, 3.783686929363192*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"09c0fdfd-0756-4cff-bb15-6d9820b7b25c"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"LPs", " ", "contains", " ", "entries", " ", "of", " ", 
      RowBox[{"L", "^", "n"}], " ", "defined", " ", "at", " ", "d"}], "=", 
     "0"}], ",", "1", ",", 
    RowBox[{
     RowBox[{"...", 
      RowBox[{"l", ".", " ", "For"}], " ", "any", " ", "matrix", " ", "whose",
       " ", 
      RowBox[{"(", 
       RowBox[{"i", ",", "j"}], ")"}]}], "-", 
     RowBox[{
     "th", " ", "entry", " ", "only", " ", "depends", " ", "on", " ", "d", 
      RowBox[{"(", 
       RowBox[{"i", ",", "j"}], ")"}]}]}], ",", " ", 
    RowBox[{
    "we", " ", "can", " ", "then", " ", "solve", " ", "a", " ", "linear", " ",
      "equation", " ", "for", " ", "the", " ", "coefficients"}]}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"B", "=", 
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", "-", "1"}], ")"}], "*", "l"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"l", "+", "1"}], ",", 
          RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], "-", 
      RowBox[{"1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
             RowBox[{"i", "\[Equal]", "j"}]}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"alpha", "-", "2"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", 
             RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], "+", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
             RowBox[{
              RowBox[{"i", "-", "j"}], "\[Equal]", "1"}]}], "\[RuleDelayed]", 
            
            RowBox[{"i", "-", "1"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", 
             RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], "+", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
             RowBox[{
              RowBox[{"i", "-", "j"}], "\[Equal]", 
              RowBox[{"-", "1"}]}]}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "-", "j", "+", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"alpha", "-", "1"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", 
             RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LPs", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"l", "+", "1"}]}], "]"}], ",", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"alpha", "-", "1"}], ")"}], "*", "l"}], ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"l", "+", "1"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixPower", "[", 
              RowBox[{"B", ",", "i"}], "]"}], ".", 
             RowBox[{"PadRight", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"alpha", "-", "1"}], ")"}], "*", "l"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"l", "+", "1"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"l", "+", "1"}], ",", 
          RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], "//", "Transpose"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Entries", " ", "of", " ", "the", " ", "pseudo"}], "-", 
     RowBox[{
     "inverse", " ", "of", " ", "the", " ", "interpolation", " ", "matrix", 
      " ", "C"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"KIentries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "2"}], "length"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], "  ", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"a", " ", "k"}], ")"}], "2"], "-", 
                 RowBox[{"a", 
                  RowBox[{"(", 
                   RowBox[{"a", " ", "k"}], ")"}]}]}], ")"}], 
               SuperscriptBox["a", "length"]}]], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for", 
     " ", "pairwise", " ", "regression"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C2entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "2"}], "2"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], "  ", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for",
       " ", "three"}], "-", 
     RowBox[{"way", " ", "regression"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"C3entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "2"}], "3"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], "  ", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for", 
     " ", "the", " ", "Additive", " ", "model"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "0"}], "1"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for", 
     " ", "the", " ", "Pairwise", " ", "model"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P2entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "0"}], "2"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for",
       " ", "the", " ", "Three"}], "-", 
     RowBox[{"way", " ", "model"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P3entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "0"}], "3"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "interpolation", " ", 
     "matrix", " ", "C", " ", "in", " ", "L"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"CIinLn", "=", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "alpha"}], "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}]}], "}"}], ",", 
       RowBox[{"l", "+", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "interpolation", " ", 
     "kernel", " ", "matrix", " ", "K", " ", "in", " ", "L"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KIinLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "KIentries"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "cost", " ", "matrix", " ", 
     "for", " ", "the", " ", "Pairwise", " ", "model", " ", "in", " ", "L"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"C2inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "C2entries"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Coefficients", " ", "for", " ", "the", " ", "cost", " ", "matrix", " ", 
      "for", " ", "the", " ", "Three"}], "-", 
     RowBox[{"way", " ", "model", " ", "in", " ", "L"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C3inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "C3entries"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Coefficients", " ", "for", " ", "the", " ", "projection", " ", "matrix",
       " ", "for", " ", "the", " ", "Three"}], "-", 
     RowBox[{"way", " ", "model", " ", "in", " ", "L"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P3inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "P3entries"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "projection", " ", "matrix", 
     " ", "for", " ", "the", " ", "Pairwise", " ", "model", " ", "in", " ", 
     "L"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P2inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "P2entries"}]}], ";"}], "\n",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "projection", " ", "matrix", 
     " ", "for", " ", "the", " ", "Additive", " ", "model", " ", "in", " ", 
     "L"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "P1entries"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"64f41619-5af5-4d02-b1b2-bbbe978a14ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Build matrices", "Subsection",
 CellChangeTimes->{{3.7836861789098473`*^9, 
  3.7836861805844584`*^9}},ExpressionUUID->"c8dcdf49-3bf7-4b8a-84ac-\
40a31965c2a5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Build", " ", "graph", " ", "Laplacian", " ", "of", " ", "the", " ", 
     "sequence", " ", 
     RowBox[{"space", ".", " ", "L"}], " ", "is", " ", "a", " ", "sparse", 
     " ", "matrix", " ", "with", " ", "sparsity"}], " ", "=", " ", 
    RowBox[{"1", " ", "-", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", "-", "1"}], ")"}], "l"}], "+", "1"}], ")"}], "/", 
       
       RowBox[{
        RowBox[{"(", 
         RowBox[{"alpha", "^", "l"}], ")"}], ".", " ", "Therefore"}]}], " ", 
      RowBox[{"we", "'"}], "ll", " ", "use", " ", "it", " ", "to", " ", 
      "facilitate", " ", "fast", " ", "solution", " ", "of", " ", "most", " ",
       "linear", " ", "equations", " ", "in", " ", "this", " ", 
      "notebook"}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"MakeLaplacian", "[", 
    RowBox[{"A_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "i"}], "}"}], "->", 
         RowBox[{"l", 
          RowBox[{"(", 
           RowBox[{"A", "-", "1"}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"A", "^", "l"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"FromDigits", "[", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "A", ",", "l"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"-", "k"}], "->", "alt"}]}], "]"}], ",", "A"}], 
               "]"}], "+", "1"}]}], "}"}], "->", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"A", "^", "l"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "l"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"alt", ",", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"A", "-", "1"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "A", ",", "l"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "k"}], "]"}], "]"}], "}"}]}], "]"}]}], "}"}]}], 
         "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.785018462180134*^9, 3.785018462190578*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"6b960a29-61cd-4284-9bc6-cf544cfddd40"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"L", "=", 
     RowBox[{"MakeLaplacian", "[", 
      RowBox[{"alpha", ",", "l"}], "]"}]}], ";"}], "]"}], "*)"}]], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"061eaed5-c6b8-4085-a91a-c6e9a91a6b79"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"MakeAdj", "[", 
    RowBox[{"A_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "A", ",", "l"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"-", "k"}], "->", "alt"}]}], "]"}], ",", "A"}], 
             "]"}], "+", "1"}]}], "}"}], "->", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"A", "^", "l"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "l"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"alt", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"A", "-", "1"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "A", ",", "l"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "k"}], "]"}], "]"}], "}"}]}], "]"}]}], "}"}]}], 
       "]"}], ",", "2"}], "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.73888181943016*^9, 3.738881847259314*^9}, {
   3.738881904602605*^9, 3.7388819047778797`*^9}, 3.738881967991172*^9, {
   3.785018462199798*^9, 3.7850184622063217`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"d2da7df9-23f3-49af-af22-bb79a337eb9a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Adj", "=", 
     RowBox[{"MakeAdj", "[", 
      RowBox[{"alpha", ",", "l"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.738881972238666*^9, 3.738882007258684*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"4b28ccd6-884c-4166-a752-ce7db1538040"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Adj", " ", "=", " ", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"L", " ", "-", " ", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", "-", "1"}], ")"}], "*", "l"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"alpha", "^", "l"}]}], "}"}]}], "]"}], ",", "2"}], 
         "]"}], "]"}]}], ")"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.858673114922086*^9, 3.8586732039972153`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"dd4dd8fc-29ff-43ea-890c-694641d16ca2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"null", " ", "=", " ", 
     RowBox[{"Table", "[", "\n", "   ", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"s2dTaylor", "[", 
          RowBox[{
           RowBox[{"sequences", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "0", ",", " ", "wt"}], 
          "]"}], ",", " ", "\n", "    ", 
         RowBox[{"s2dTaylor", "[", 
          RowBox[{
           RowBox[{"sequences", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "1", ",", " ", "wt"}], 
          "]"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"Length", "[", "sequences", "]"}]}], "}"}]}], "]"}]}], ";"}],
    "//", "AbsoluteTiming"}], "*)"}]], "Input",
 CellChangeTimes->{{3.783291500319695*^9, 3.783291505408485*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"d6933549-160a-4e95-85ea-85dfe7dab3ab"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"null2", "=", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"s2dTaylor", "[", 
           RowBox[{"seq", ",", "0", ",", "wt"}], "]"}], ",", 
          RowBox[{"s2dTaylor", "[", 
           RowBox[{"seq", ",", "1", ",", "wt"}], "]"}], ",", 
          RowBox[{"s2dTaylor", "[", 
           RowBox[{"seq", ",", "2", ",", "wt"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"seq", ",", "sequences"}], "}"}]}], "]"}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.783267830897606*^9, {3.7832914179990473`*^9, 3.783291431980976*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"497efe51-3f1b-48d4-9579-7f912c2caae6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"designrulesonehot", "[", 
   RowBox[{"seq_", ",", " ", "order_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"sub1", ",", " ", "sub2", ",", " ", "pos"}], "}"}], ",", "\n", 
    "\n", "  ", 
    RowBox[{
     RowBox[{"sub1", " ", "=", " ", 
      RowBox[{"Subsets", "[", 
       RowBox[{"seq", ",", " ", 
        RowBox[{"{", "order", "}"}]}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"sub2", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "i", "}"}], ",", " ", 
          RowBox[{"sub1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", "sub1", "]"}]}], "}"}]}], "]"}]}], ";", " ", 
     "\n", "  ", 
     RowBox[{"pos", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FromDigits", "[", 
          RowBox[{
           RowBox[{"Rest", "[", "#", "]"}], " ", ",", " ", "alpha"}], " ", 
          "]"}], " ", "+", " ", "\n", "      ", "1", " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], " ", ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", "alpha", " ", ")"}], "^", "order"}], ")"}]}], "+", 
         " ", 
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{"l", ",", "k"}], "]"}], 
             RowBox[{
              RowBox[{"(", "alpha", ")"}], "^", 
              RowBox[{"(", "k", ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"order", "-", "1"}]}], "}"}]}], "]"}]}]}], "&"}], " ", "/@",
        " ", "\n", "    ", "sub2"}]}], ";", "\n", "  ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"pos", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], " ", "->", " ", "1"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "\n", "     ", 
         RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}]}]}], "\n", 
   "  ", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"s2donehot", "[", 
   RowBox[{"seqs_", ",", "order_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "rules", "}"}], ",", 
    RowBox[{
     RowBox[{"rules", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"designrulesonehot", "[", 
              RowBox[{
               RowBox[{"seqs", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "k", ",", "j"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "order"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "seqs", "]"}]}], "}"}]}], "]"}], ",", 
        "2"}], "]"}]}], ";", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"rules", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "seqs", "]"}], ",", 
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{"l", ",", " ", "k"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"alpha", " ", "^", "k"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "order"}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.785257164975732*^9, 3.785257165156413*^9}, {
   3.7852572616506367`*^9, 3.785257262300872*^9}, {3.7852573022902603`*^9, 
   3.7852573814812927`*^9}, {3.7852574598940077`*^9, 3.78525746923743*^9}, {
   3.785257644843088*^9, 3.785257646286978*^9}, {3.785257739293095*^9, 
   3.7852577410231333`*^9}, 3.7873347600022287`*^9},
 CellLabel->"In[87]:=",ExpressionUUID->"65dd250a-5c8b-4298-a04b-3cfbfbe310a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"designrulesonehot", "[", 
            RowBox[{
             RowBox[{"sequences", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", "k", ",", "j"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", " ", "1"}], "}"}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "sequences", "]"}]}], "}"}]}], "]"}], ",", 
      "2"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{3.860056917425178*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"13e95f12-fa86-4963-bb48-9f9fe435172d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.64774`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.860057080232312*^9, 3.860615008363172*^9, 
  3.860616301891281*^9, 3.8608720828170958`*^9, 3.860874587594965*^9, 
  3.860875811721603*^9, 3.8610460569096727`*^9, 3.861720288214199*^9, 
  3.8618048272243567`*^9, 3.861882724247613*^9, 3.863523668809548*^9, 
  3.8635264341589117`*^9, 3.863526704993176*^9, 3.8638143065259523`*^9, 
  3.863818693095318*^9, 3.8639029325811567`*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"382f8c01-28ad-4289-99ac-8412f1d06151"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nullonehot", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"rules", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "sequences", "]"}], ",", 
       RowBox[{"Total", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{"l", ",", " ", "k"}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", "alpha", ")"}], "^", "k"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.8600569687662287`*^9},
 CellLabel->"In[90]:=",ExpressionUUID->"384f0514-12a1-4cbf-b030-48e1c864a88e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Simulate ", "Section",
 CellChangeTimes->{{3.858672469023692*^9, 3.858672477042664*^9}, {
  3.859631604998*^9, 3.859631607964817*^9}, {3.8607699723099003`*^9, 
  3.86076997563197*^9}},ExpressionUUID->"d6179839-f5b4-48a9-af4f-\
190dd806ec7f"],

Cell[CellGroupData[{

Cell["Simulate landscapes by sampling columns of design matrix", "Subsection",
 CellChangeTimes->{{3.858765812030665*^9, 
  3.858765824336657*^9}},ExpressionUUID->"27d4f9c3-e974-4c19-ae8f-\
18146b4b68cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"associate", "[", "tab_", "]"}], ":=", 
  RowBox[{"tab", "\[Rule]", "1"}]}], "\n", 
 RowBox[{
  RowBox[{"weights", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Binomial", "[", 
       RowBox[{"l", ",", "k"}], "]"}], 
      RowBox[{
       RowBox[{"(", "alpha", ")"}], "^", "k"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s", "=", ".1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"Round", "[", 
    RowBox[{"s", "*", 
     RowBox[{"Total", "[", "mks", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.860616350680039*^9, 3.860616373183486*^9}, {
   3.860616942363886*^9, 3.860616945462675*^9}, 3.8638183246543827`*^9, {
   3.863818799258917*^9, 3.863818802511847*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"1fe486ba-c93d-4f45-9ff1-21a43109114b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"order", ",", " ", "sites", ",", " ", "pos"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"order", "=", 
        RowBox[{
         RowBox[{"RandomSample", "[", 
          RowBox[{
           RowBox[{"weights", "->", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "l"}], "]"}]}], ",", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sites", "=", 
        RowBox[{"RandomSample", "[", 
         RowBox[{
          RowBox[{"Range", "[", "l", "]"}], ",", " ", "order"}], "]"}]}], ";", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{"#", ",", "alpha"}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "@", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"A", ",", " ", "l"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"site", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"RandomChoice", "[", "A", "]"}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"site", ",", "sites"}], "}"}]}], "]"}]}], "]"}]}]}], 
         "+", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rules", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"associate", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"i", ",", " ", 
              RowBox[{"Length", "@", "pos"}]}], "]"}], ",", "pos"}], 
           "}"}]}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "m"}], "}"}]}], "]"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.863524897299938*^9, 3.8635249046274567`*^9}, {
  3.863524961248887*^9, 3.863524961788393*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"43b95777-438c-4060-8dff-083bb7cb53b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.329672`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.863524907349703*^9, 3.8635249689155617`*^9, 3.863525353165553*^9, 
   3.863815539356196*^9, {3.863816085379094*^9, 3.863816102956805*^9}, 
   3.863816391091716*^9, 3.863816591527989*^9, 3.86381665480324*^9, 
   3.86381674959723*^9, 3.863816785152958*^9, 3.863816883196559*^9, 
   3.863817508554268*^9, 3.863817610705435*^9, 3.863818328279114*^9, 
   3.863818730966001*^9, 3.86381880591713*^9, 3.863818849873777*^9},
 CellLabel->
  "Out[279]=",ExpressionUUID->"94721158-a9d7-4c77-bb60-fdc0f01cacf7"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"rules", ",", "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"designmatrix", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"rules", ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"alpha", "^", "l"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"designmatrix", " ", "=", " ", 
   RowBox[{"Transpose", "@", "designmatrix"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.863524970787455*^9, 3.863524976975442*^9}, 
   3.8638183317034597`*^9},
 CellLabel->
  "In[280]:=",ExpressionUUID->"cf52b895-7274-4100-9815-e6ed73eacd9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrep", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "beta", "}"}], ",", 
       RowBox[{
        RowBox[{"beta", "=", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "m"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"designmatrix", ".", "beta"}]}]}], "]"}], ",", "nrep"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fs", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "/", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"fs", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<data/\>\"", ",", "fl", ",", "\"\<_f_\>\"", ",", 
       RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], ",", 
     RowBox[{"fs", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.787335235298904*^9, 3.7873352373876047`*^9}, 
   3.788129175165431*^9, {3.863816459984439*^9, 3.863816460695755*^9}, {
   3.863817098215331*^9, 3.863817098849407*^9}, 3.8638174644484167`*^9, 
   3.863818353622505*^9, 3.86381838672678*^9, 3.8638188538808002`*^9},
 CellLabel->
  "In[286]:=",ExpressionUUID->"61652206-d1e9-443a-b842-c5cf2f72732b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ldaObs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{"Pkby", "[", 
         RowBox[{
          RowBox[{"fs", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "k"}], "]"}], "]"}], "^", 
       "2"}], "/", 
      RowBox[{"mks", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nrep"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8638155973117523`*^9, 3.863815616877089*^9}, {
  3.86381565003065*^9, 3.86381565272929*^9}, {3.863816103307385*^9, 
  3.863816120140255*^9}, {3.8638164058870173`*^9, 3.863816424792782*^9}, {
  3.8638174132982273`*^9, 3.863817413904611*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"0039833d-7a23-4bd0-80e9-30009f89e308"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"Nbyfirst", "/@", "ldaObs"}], "]"}]], "Input",
 CellChangeTimes->{{3.863816149776107*^9, 3.863816156810491*^9}, {
  3.863816428791712*^9, 3.863816434420747*^9}, {3.863817106713119*^9, 
  3.863817107395755*^9}, {3.8638184141430597`*^9, 3.86381841447208*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"ff9ddef1-37e0-464e-a551-74c9176c9d71"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "0.059546504215134084`", ",", "0.002462030283645143`", ",", 
   "0.00012133450975778411`"}], "}"}]], "Output",
 CellChangeTimes->{{3.863816147353477*^9, 3.863816157056563*^9}, {
   3.863816401220509*^9, 3.863816434673386*^9}, 3.8638164667180157`*^9, 
   3.863816629703733*^9, 3.863816753677285*^9, {3.863817087177026*^9, 
   3.8638171076661043`*^9}, 3.86381758866581*^9, 3.863817690307632*^9, {
   3.8638183910873327`*^9, 3.8638184147481213`*^9}, 3.863818733197393*^9, 
   3.863818807929584*^9, 3.8638188650551863`*^9},
 CellLabel->
  "Out[291]=",ExpressionUUID->"7ba4ba74-e227-4674-8252-96846278bf25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VCObs", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Nbysum", "[", 
      RowBox[{
       RowBox[{"Rest", "@", "mks"}], "*", 
       RowBox[{"ldaObs", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nrep"}], "}"}]}], "]"}], "//", "N"}]}]], "Input",
 CellChangeTimes->{{3.863815644654427*^9, 3.863815656033564*^9}, {
  3.863817367044128*^9, 3.8638174030539417`*^9}},
 CellLabel->
  "In[292]:=",ExpressionUUID->"b406ba62-8653-48df-9c77-1c77f9448849"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.23129347056617233`", ",", "0.47795341208066433`", ",", 
     "0.23472276553391058`", ",", "0.05603035181925284`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.2732207716452797`", ",", "0.4305180937097145`", ",", 
     "0.23927849869662374`", ",", "0.056982635948382036`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.29427131376565013`", ",", "0.42642088082762125`", ",", 
     "0.22829050822328367`", ",", "0.05101729718344488`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.863815656307167*^9, {3.863816109132978*^9, 3.8638161222299633`*^9}, 
   3.863817403589157*^9, 3.863818424289782*^9, 3.8638187332076483`*^9, 
   3.8638188079423857`*^9, 3.863818865177203*^9},
 CellLabel->
  "Out[292]=",ExpressionUUID->"f841334c-916f-4dab-8763-3dabe8a0b165"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lambdaExpected", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "m"}], ")"}], "*", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"l", "-", "i"}], ")"}]}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"alpha", "-", "1"}], ")"}], "*", ".5"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"l", "-", "i"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], "//", "N"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.858682047762006*^9, 3.858682051277516*^9}, {
   3.859467533958294*^9, 3.859467539594418*^9}, {3.8596273071442823`*^9, 
   3.859627307371921*^9}, {3.859630693654537*^9, 3.859630728428801*^9}, 
   3.859630817786688*^9, {3.860840598150487*^9, 3.860840607804257*^9}, {
   3.8638184559179773`*^9, 3.8638184772381887`*^9}, 3.8638185262380238`*^9},
 CellLabel->
  "In[293]:=",ExpressionUUID->"e9c8ab10-9613-4f14-b5ed-4ca21fe8c308"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<tru_lda.tsv\>\"", ",", "lambdaExpected"}], "]"}]], "Input",
 CellChangeTimes->{{3.8618864496219788`*^9, 3.861886463071609*^9}, 
   3.863523794911257*^9},
 CellLabel->
  "In[294]:=",ExpressionUUID->"1793cbb3-3217-4316-aa7d-596b57faf34a"],

Cell[BoxData["\<\"tru_lda.tsv\"\>"], "Output",
 CellChangeTimes->{3.8618864634598713`*^9, 3.8618865132225513`*^9, 
  3.863525020604041*^9, 3.863525361088294*^9, 3.863815670739102*^9, 
  3.863818482355558*^9, 3.863818528790689*^9, 3.863818733279488*^9, 
  3.863818808023717*^9, 3.863818866784647*^9},
 CellLabel->
  "Out[294]=",ExpressionUUID->"67628aa5-f1ee-4e5e-ab5d-905d9bc46859"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Analytical", " ", "results", " ", "of", " ", "variance", " ", 
     "components", " ", "under", " ", "sparse", " ", "one"}], "-", 
    RowBox[{"hot", " ", "basis"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"VCExpected", "=", 
    RowBox[{
     RowBox[{"Nbysum", "[", 
      RowBox[{
       RowBox[{"Rest", "@", "mks"}], "*", "lambdaExpected"}], "]"}], "//", 
     "N"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.858681166844335*^9, 3.858681172173223*^9}, {
   3.859289968642592*^9, 3.859289969090576*^9}, {3.859381450803899*^9, 
   3.859381475323373*^9}, {3.859630915142241*^9, 3.859630917996778*^9}, {
   3.86381849640699*^9, 3.8638185035264063`*^9}, 3.8638185424491*^9},
 CellLabel->
  "In[295]:=",ExpressionUUID->"092afc48-0a0e-4e77-873f-c0a909421b16"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Nbysum", "@", 
        RowBox[{"Rest", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"Pkby", "[", 
              RowBox[{
               RowBox[{"fs", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "k"}], "]"}], "]"}], "^",
             "2"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "nrep"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotRange", "->", "All"}]}], "]"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"VCExpected", ",", " ", 
     RowBox[{"DataRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "l"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.783276446437621*^9, 3.783276454890402*^9}, {
   3.7832770154890213`*^9, 3.783277016676408*^9}, {3.783344186149413*^9, 
   3.783344203172229*^9}, {3.783353886308242*^9, 3.783353889135353*^9}, {
   3.78386318762929*^9, 3.7838631893472853`*^9}, 3.7838786759925528`*^9, {
   3.785260645185783*^9, 3.785260653283647*^9}, 3.78733525504102*^9, {
   3.859384736446316*^9, 3.859384739445195*^9}, {3.863818560313794*^9, 
   3.863818586787264*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"5a71f4f0-6c6a-4f77-8b02-4937762f2a19"],

Cell[BoxData[
 GraphicsBox[{{{}, {{{}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
       LineBox[{{1., 0.23129347056617233`}, {2., 0.47795341208066433`}, {3., 
        0.23472276553391058`}, {4., 0.056030351819252824`}}]}, 
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
       LineBox[{{1., 0.2732207716452797}, {2., 0.4305180937097145}, {3., 
        0.23927849869662374`}, {4., 0.056982635948382036`}}]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
       LineBox[{{1., 0.29427131376565013`}, {2., 0.4264208808276212}, {3., 
        0.22829050822328364`}, {4., 0.05101729718344487}}]}}, {
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6]}}, {
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[
       1.6]}, {}, {}, {}, {}, {}, {}, {}}, {
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[
       1.6]}, {}, {}, {}, {}, {}, {}, {}}}, {{}, {}}}, {{}, {{{}, {}, 
      {RGBColor[1, 0, 0], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
       LineBox[{{1., 0.2975397787969575}, {2., 0.4038039855101565}, {3., 
        0.2435643087204119}, {4., 0.055091926972474115`}}]}}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6]}, {
      {RGBColor[1, 0, 0], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[
       1.6]}, {}}, {
      {RGBColor[1, 0, 0], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[
       1.6]}, {}}}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.9375000000000003, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0.9375000000000003, 4.}, {0, 0.47795341208066433`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.86061700933479*^9, 3.8606736846725082`*^9, {3.8635249884501543`*^9, 
   3.863525010644809*^9}, 3.863525360881819*^9, 3.8638184360556183`*^9, {
   3.863818567680365*^9, 3.86381858620339*^9}, 3.86381873554389*^9, 
   3.8638188100279503`*^9, 3.863818870767475*^9},
 CellLabel->
  "Out[296]=",ExpressionUUID->"2cce8835-d3c5-4096-a68b-ce4a09862348"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Noised FL", "Subsection",
 CellChangeTimes->{{3.860617438254055*^9, 
  3.860617444813998*^9}},ExpressionUUID->"0182df01-9ef5-472f-9117-\
4a3f901a79b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noiseprops", "=", 
   RowBox[{"{", 
    RowBox[{
    ".05", ",", " ", ".1", ",", " ", ".2", ",", " ", ".3", ",", " ", ".4", 
     ",", " ", ".5", ",", " ", ".8"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8618079586052523`*^9, 3.8618079831817636`*^9}, {
  3.861829700802211*^9, 3.861829704904521*^9}, {3.8618833094688663`*^9, 
  3.8618833125749063`*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"2842fd60-1e75-4399-9e4f-119861ca3156"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"varnoiselist", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "#"}], ")"}]}], " ", "-", "1"}], ")"}], "&"}], "/@",
     "noiseprops"}], " ", "*", " ", 
   RowBox[{"Variance", "[", 
    RowBox[{
     RowBox[{"fs", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "//", "Flatten"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.86182975351157*^9, 3.861829769761751*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"26a74903-913a-4674-a152-4c90c2128a4b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.052631578947368376`", ",", "0.11111111111111119`", ",", 
   "0.25000000000000006`", ",", "0.4285714285714287`", ",", 
   "0.6666666666666669`", ",", "1.0000000000000002`", ",", 
   "4.000000000000002`"}], "}"}]], "Output",
 CellChangeTimes->{3.861829770110518*^9, 3.861883345013125*^9, 
  3.861888988799814*^9, 3.863525031939945*^9, 3.8635253611484737`*^9, 
  3.8638187359190493`*^9, 3.8638188101284103`*^9, 3.863818876626546*^9},
 CellLabel->
  "Out[298]=",ExpressionUUID->"345c54da-9a4a-4f0f-bb22-99ff9637e1ba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"noisevecslist", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"varnoiselist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", " ", 
       RowBox[{"alpha", "^", "l"}]}], "]"}], ",", " ", "nrep", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "noiseprops"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.861829815528352*^9, 3.86182985387817*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"30587f63-8f4b-4d6c-a89e-d4ac6fe14a91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fnlist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fs", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "+", 
      RowBox[{"noisevecslist", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nrep"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "noiseprops"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.861829883410408*^9, 3.8618299444405947`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"2305ad30-5894-4e1c-a541-5e09f0a52db3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"r2", "[", 
    RowBox[{
     RowBox[{"fnlist", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", " ", 
     RowBox[{"fs", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "@", "noiseprops"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.861829978859387*^9, 3.861830025915204*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"d87cb1c3-adf7-451d-ab3a-5e3bb882f2f7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9500517736942338`", ",", "0.9003017235685066`", ",", 
   "0.799987023099531`", ",", "0.6985706676819278`", ",", 
   "0.5991068501684669`", ",", "0.500441338177318`", ",", 
   "0.2013197490999823`"}], "}"}]], "Output",
 CellChangeTimes->{{3.861829997884638*^9, 3.8618300262990932`*^9}, 
   3.861883393611261*^9, 3.861888988878441*^9, 3.863525032028837*^9, 
   3.863525361196424*^9, 3.8638187360729733`*^9, 3.8638188102525578`*^9, 
   3.86381887675161*^9},
 CellLabel->
  "Out[301]=",ExpressionUUID->"19472f54-52a5-4813-b5ce-8f127bbb5c53"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "\"\<data/\>\"", ",", "fl", ",", "  ", "\"\<_f_\>\"", ",", 
       "\"\<noised_\>\"", ",", " ", 
       RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", " ", 
       RowBox[{"ToString", "[", 
        RowBox[{"noiseprops", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
     ",", 
     RowBox[{"fnlist", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"Length", "@", "noiseprops"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.861830050330503*^9, 3.861830090484296*^9}, {
  3.861883405853897*^9, 3.861883408328821*^9}, {3.8618869501638613`*^9, 
  3.861886964240015*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"48ceda01-7be7-4017-bb20-714e0190afe5"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate training samples", "Section",
 CellChangeTimes->{{3.858674902923584*^9, 3.858674905441621*^9}, {
  3.85938143473862*^9, 3.85938143703601*^9}, {3.86061649906289*^9, 
  3.860616513696723*^9}},ExpressionUUID->"f5e4c734-0ae0-482c-bc41-\
15ba975d06e8"],

Cell[CellGroupData[{

Cell["Random sampling", "Subsection",
 CellChangeTimes->{{3.8606165175793552`*^9, 
  3.86061654481107*^9}},ExpressionUUID->"368a7ea7-3e00-4077-bea2-\
3b5f29832627"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samplesizes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"i", " ", 
       RowBox[{"Length", "[", "sequences", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".01", ",", ".05"}], "}"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{".1", ",", ".9", ",", ".1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{".95", ",", ".99"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"proportions", "=", 
   RowBox[{"samplesizes", "/", 
    RowBox[{"(", 
     RowBox[{"alpha", "^", "l"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783344917635714*^9, 3.783344957829818*^9}, {
   3.785242990982191*^9, 3.785242998510944*^9}, 3.859630930925025*^9},
 CellLabel->
  "In[303]:=",ExpressionUUID->"f08e873e-10a3-4c3f-a9cd-978a6fb11970"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomSample", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "sequences", "]"}], "]"}], ",", 
       RowBox[{"samplesizes", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "samplesizes", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tts", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"alpha", "^", "l"}], "]"}], ",", 
       RowBox[{"trs", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "trs", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", " ", 
       RowBox[{"\"\<data/\>\"", ",", " ", "\"\<tr_\>\"", ",", 
        RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
      ",", 
      RowBox[{"trs", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"lg", "@", "trs"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7833448976781483`*^9, 3.7833448984662333`*^9}, {
   3.783344963121048*^9, 3.783344979261902*^9}, 3.8594545593130713`*^9, {
   3.8606170904665813`*^9, 3.8606170919280987`*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"f5fdeb68-2426-4033-8be3-1b140f269d5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulated mutagenesis", "Subsection",
 CellChangeTimes->{{3.860616548361465*^9, 
  3.8606165531717577`*^9}},ExpressionUUID->"62ed04da-fe6f-4147-a058-\
6b6efef6d7ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wt", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "l"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[308]:=",ExpressionUUID->"6ed64fc1-c52a-49e9-be17-64c7549b67d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wg", "=", 
  RowBox[{
   RowBox[{"mks", "^", 
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}]}], "//", "N"}]}]], "Input",
 CellChangeTimes->{{3.785718747868567*^9, 3.785718813012555*^9}, {
  3.785718891970484*^9, 3.785718894007209*^9}, {3.785718961509604*^9, 
  3.785718980696171*^9}, {3.7857845469499063`*^9, 3.78578454707887*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"5c0c2f54-116d-47d4-ad7a-738c5de0f782"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "0.013157894736842105`", ",", "0.0004616805170821791`", ",", 
   "0.00003644846187490888`", ",", "7.673360394717659`*^-6"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.785718748464738*^9, 3.785718813787648*^9}, 
   3.785718894656073*^9, 3.7857189314326487`*^9, {3.7857189618048763`*^9, 
   3.785718981028264*^9}, 3.785725341786572*^9, 3.785784274961919*^9, 
   3.7857845474615097`*^9, 3.785785313522851*^9, 3.78584789577177*^9, 
   3.785853277790097*^9, 3.785860668094639*^9, 3.786458899901606*^9, 
   3.786458973644125*^9, 3.786557763327383*^9, 3.78671682584937*^9, 
   3.859028555483366*^9, 3.8606171406918077`*^9, {3.860874607007057*^9, 
   3.860874618786274*^9}, 3.860875829711288*^9, 3.861883442660632*^9, 
   3.8635250612255697`*^9, 3.863525389088408*^9, 3.8635268976794357`*^9, 
   3.863818961718012*^9},
 CellLabel->
  "Out[309]=",ExpressionUUID->"33c1773c-1a80-4431-94a4-06d2ae39dd3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nbysum", "[", 
      RowBox[{"mks", "^", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"Nbysum", "[", "wg", "]"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.785718793821918*^9, 3.785718817128313*^9}, {
  3.78571889779423*^9, 3.785718911368473*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"96966889-66c6-4323-8a10-aa493dbe3780"],

Cell[BoxData[
 GraphicsBox[{{}, {{
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{1., 0.9865204829613555}, {2., 0.012980532670544151`}, {3., 
       0.0004554572866857597}, {4., 0.00003595715421203366}, {5., 
       7.569927202533402*^-6}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{1., 0.9865204829613555}, {2., 0.012980532670544151`}, {3., 
       0.0004554572866857597}, {4., 0.00003595715421203366}, {5., 
       7.569927202533402*^-6}}]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}, {}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}, {}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.916666666666667, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0.916666666666667, 5.}, {0, 0.9865204829613555}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.785718794617687*^9, 3.78571881751191*^9}, {
   3.785718899078416*^9, 3.785718932239875*^9}, {3.785718962850931*^9, 
   3.785718981934436*^9}, 3.7857253419434*^9, 3.7857842765542107`*^9, 
   3.7857845489974337`*^9, 3.785785316035932*^9, 3.785847895911126*^9, 
   3.7858532794053097`*^9, 3.78586066821959*^9, 3.78645897513547*^9, 
   3.786557763395751*^9, 3.7867168267018223`*^9, 3.8590285562007227`*^9, 
   3.86061714204972*^9, {3.8608746070584793`*^9, 3.860874618853669*^9}, 
   3.860875829779896*^9, 3.861883442776462*^9, 3.8635250612902737`*^9, 
   3.863525389155258*^9, 3.863526897869957*^9, 3.863818961783442*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"b54d9d3d-0c05-4dc0-ab7c-da67e147fee4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samplesizes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"i", " ", 
       RowBox[{"Length", "[", "sequences", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".01", ",", ".05"}], "}"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{".1", ",", ".9", ",", ".1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{".95", ",", ".99"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"proportions", "=", 
   RowBox[{"samplesizes", "/", 
    RowBox[{"(", 
     RowBox[{"alpha", "^", "l"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783344917635714*^9, 3.783344957829818*^9}, {
   3.785242990982191*^9, 3.785242998510944*^9}, 3.8610973995209913`*^9},
 CellLabel->
  "In[311]:=",ExpressionUUID->"57188d89-da16-40c6-8eac-feb575fc4a79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hd", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"HammingDistance", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "l"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
    "sequences"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"seqbyhd", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"hd", ",", "d"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"seqsbyD", "=", 
   RowBox[{
    RowBox[{"GatherBy", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"HammingDistance", "[", 
            RowBox[{"#", ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", "l"}], "]"}]}], "]"}], "&"}], "/@", 
          "sequences"}], ",", "sequences"}], "}"}]}], ",", "First"}], "]"}], 
    "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"hdsub", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomSample", "[", 
       RowBox[{
        RowBox[{"seq2pos", "/@", 
         RowBox[{"seqsbyD", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"lg", "@", "seqsbyD"}]}], "}"}]}], "]"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.7808437630307817`*^9, 3.780843794011559*^9}, 
   3.7864529625379143`*^9},
 CellLabel->
  "In[313]:=",ExpressionUUID->"58717cb0-2ac9-4d04-8eb1-8a40f4bd088d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", ".1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"weights", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], 
       RowBox[{
        RowBox[{"-", "#"}], "+", "l"}]], " ", 
      SuperscriptBox["p", "#"]}], " ", "&"}], "/@", "hd"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.780843757554625*^9, 3.780843760258093*^9}, {
   3.780844073425549*^9, 3.7808441131864862`*^9}, 3.780844717772211*^9, {
   3.78084493748734*^9, 3.7808449414672823`*^9}, {3.780845794902852*^9, 
   3.780845828736547*^9}, {3.780845872963282*^9, 3.7808458733050528`*^9}, {
   3.78084591037824*^9, 3.780845910912065*^9}, 3.780852074320318*^9, {
   3.780852131113812*^9, 3.780852132112256*^9}, 3.7808521701664658`*^9, 
   3.859278277360279*^9, {3.859299230184499*^9, 3.859299259883484*^9}, {
   3.8592993396444607`*^9, 3.859299339986712*^9}, 3.859299421392777*^9, {
   3.860617267326071*^9, 3.860617269762301*^9}, {3.860617322592774*^9, 
   3.860617328512431*^9}, 3.860617364590962*^9},
 CellLabel->
  "In[317]:=",ExpressionUUID->"29de2cd7-75d0-4dd0-a7d6-5cfb661f81d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "give", " ", "minimum", " ", "epistasis", " ", "interpolation",
      " ", "1", "%"}], ",", " ", 
    RowBox[{"10", "%"}], ",", " ", 
    RowBox[{
    "50", "%", " ", "and", " ", "90", "%", " ", "of", " ", "all", " ", "data",
      " ", "as", " ", "training", " ", "and", " ", "use", " ", "the", " ", 
     "rest", " ", "of", " ", "the", " ", "data", " ", "as", " ", "test"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"trsmut", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomSample", "[", 
        RowBox[{
         RowBox[{"weights", "\[Rule]", 
          RowBox[{"Range", "[", 
           RowBox[{"alpha", "^", "l"}], "]"}]}], ",", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"i", " ", 
           RowBox[{"alpha", "^", "l"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "proportions"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tstmut", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"alpha", "^", "l"}], "]"}], ",", 
          RowBox[{"trsmut", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "//", "Flatten"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "proportions", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.762085512756638*^9, 3.7620855807492867`*^9}, {
   3.762094727170327*^9, 3.762094741497457*^9}, 3.765806908555455*^9, {
   3.766228416379088*^9, 3.766228479898402*^9}, 3.780844793196917*^9, {
   3.780852316904729*^9, 3.780852321121105*^9}, {3.7808526959889383`*^9, 
   3.780852705451377*^9}, {3.780853156192951*^9, 3.780853160610716*^9}, {
   3.780854667019451*^9, 3.7808546698144608`*^9}, {3.784978967643351*^9, 
   3.784978969711825*^9}, {3.784979302892748*^9, 3.7849793032094307`*^9}, 
   3.786110783203618*^9, {3.7861112660029383`*^9, 3.7861112672788553`*^9}, 
   3.786365218447443*^9, {3.8592785254495487`*^9, 3.859278528694048*^9}, 
   3.860617211420224*^9},
 CellLabel->
  "In[319]:=",ExpressionUUID->"3761c8b8-dfe1-4870-8901-6b318cf58746"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"proportions", "//", "N"}]], "Input",
 CellChangeTimes->{{3.859278474099537*^9, 3.859278476954382*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"00132ea2-084a-4f93-b7d5-5494e18b8e34"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.01`", ",", "0.05`", ",", "0.1`", ",", "0.2`", ",", "0.3`", ",", "0.4`", 
   ",", "0.5`", ",", "0.6`", ",", "0.7`", ",", "0.8`", ",", "0.9`", ",", 
   "0.95`", ",", "0.99`"}], "}"}]], "Output",
 CellChangeTimes->{{3.859278475067452*^9, 3.859278477190246*^9}, 
   3.8592990664350777`*^9, 3.859299238283675*^9, 3.859299307952413*^9, 
   3.8592993472577877`*^9, 3.8592994283870564`*^9, 3.860617214787805*^9, 
   3.860617299491477*^9, 3.860617331502055*^9, {3.860617362052259*^9, 
   3.860617366085486*^9}, {3.8608746080423603`*^9, 3.860874619728917*^9}, 
   3.86087583065709*^9, 3.8618834434580927`*^9, 3.863525061990156*^9, 
   3.8635253899969397`*^9, 3.863526899869836*^9, 3.8638189639493313`*^9},
 CellLabel->
  "Out[321]=",ExpressionUUID->"4db3943b-4fd8-43cc-a51c-f041618de848"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SortBy", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"hd", "[", 
     RowBox[{"[", 
      RowBox[{"trsmut", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "//", "Tally"}], ",", 
   "First"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", 
   RowBox[{"mks", "[", 
    RowBox[{"[", 
     RowBox[{";;", 
      RowBox[{"Length", "[", "%", "]"}]}], "]"}], "]"}]}], "//", 
  "N"}]}], "Input",
 CellChangeTimes->{{3.859278219094694*^9, 3.8592782217289877`*^9}, {
   3.859278283445943*^9, 3.859278308048358*^9}, {3.859278382328753*^9, 
   3.8592784055816727`*^9}, 3.8592992152579517`*^9, 3.859299320838296*^9, {
   3.85929939220018*^9, 3.859299392364882*^9}, {3.859299435567957*^9, 
   3.8592994421277637`*^9}, {3.8606172314108887`*^9, 3.860617231563191*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"5eba1d0b-e5b4-4805-87c7-eb74b1b9f3be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "66"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "470"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "676"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "387"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.859278221969943*^9, {3.859278270778862*^9, 3.8592784059691057`*^9}, 
   3.8592990708186493`*^9, {3.8592992157334003`*^9, 3.859299240493765*^9}, {
   3.859299309493019*^9, 3.859299347321466*^9}, 3.859299392720882*^9, {
   3.859299428438273*^9, 3.859299445545127*^9}, {3.860617218065856*^9, 
   3.860617231888188*^9}, 3.8606173001039124`*^9, 3.8606173325042152`*^9, {
   3.860617362713732*^9, 3.8606173666346407`*^9}, {3.860874608046736*^9, 
   3.860874619766877*^9}, 3.860875830696907*^9, 3.861883443501194*^9, 
   3.863525062030169*^9, 3.863525390032834*^9, 3.8635269000256567`*^9, 
   3.863818963963296*^9},
 CellLabel->
  "Out[322]=",ExpressionUUID->"f5e9c057-a8fa-4795-9a29-ca438c290d7e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "0.868421052631579`", ",", "0.2169898430286242`", ",", 
   "0.0246391602274384`", ",", "0.002969590472755734`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.859278221969943*^9, {3.859278270778862*^9, 3.8592784059691057`*^9}, 
   3.8592990708186493`*^9, {3.8592992157334003`*^9, 3.859299240493765*^9}, {
   3.859299309493019*^9, 3.859299347321466*^9}, 3.859299392720882*^9, {
   3.859299428438273*^9, 3.859299445545127*^9}, {3.860617218065856*^9, 
   3.860617231888188*^9}, 3.8606173001039124`*^9, 3.8606173325042152`*^9, {
   3.860617362713732*^9, 3.8606173666346407`*^9}, {3.860874608046736*^9, 
   3.860874619766877*^9}, 3.860875830696907*^9, 3.861883443501194*^9, 
   3.863525062030169*^9, 3.863525390032834*^9, 3.8635269000256567`*^9, 
   3.8638189639647837`*^9},
 CellLabel->
  "Out[323]=",ExpressionUUID->"ad2f3d5f-7bb1-48bb-834e-95ce8dd4568b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<data/\>\"", ",", " ", "\"\<tr_mut_\>\"", ",", 
        RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
      ",", 
      RowBox[{"trsmut", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"lg", "@", "trsmut"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.784935958802273*^9, 3.784936002407185*^9}, {
   3.7849360607381687`*^9, 3.784936076668084*^9}, {3.784936808900751*^9, 
   3.784936817740769*^9}, {3.784937096793487*^9, 3.784937097170569*^9}, {
   3.7849371382792683`*^9, 3.784937138675311*^9}, {3.784937249731298*^9, 
   3.784937251024476*^9}, {3.785190847292749*^9, 3.7851908781409807`*^9}, {
   3.785243045706354*^9, 3.785243046848991*^9}, {3.7873350526526613`*^9, 
   3.787335064330497*^9}, 3.78733515996841*^9, 3.787335385431644*^9, 
   3.787336249203082*^9, {3.8586754227234297`*^9, 3.858675424720295*^9}, {
   3.8586755499512777`*^9, 3.8586755564660587`*^9}, {3.8592785168741283`*^9, 
   3.8592785428649406`*^9}, 3.860617306034151*^9},
 CellLabel->
  "In[324]:=",ExpressionUUID->"d270c1bc-0932-4862-82ac-3b68ae56ec39"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Export data to GE", "Section",
 CellChangeTimes->{{3.860616580170353*^9, 3.860616580266287*^9}, {
  3.860875845676409*^9, 
  3.860875848385839*^9}},ExpressionUUID->"a33a3c75-e857-41dc-995e-\
f8633519efb9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"geWD", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "\"\</Users/keitokiddo/Dropbox (UFL)/VC_revision/GE/\>\"", ",", " ", 
     "fl"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "geWD", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.858685415753504*^9, 3.858685417146699*^9}, {
   3.8596316559381247`*^9, 3.85963165802564*^9}, {3.860054897099617*^9, 
   3.860054901392017*^9}, {3.8600559355596533`*^9, 3.8600559366773376`*^9}, {
   3.860671770772121*^9, 3.860671793639415*^9}, 3.8608730886981783`*^9},
 CellLabel->
  "In[325]:=",ExpressionUUID->"78d906c7-5e82-4126-be09-db1e261974c5"],

Cell[CellGroupData[{

Cell["Random", "Subsubsection",
 CellChangeTimes->{{3.8183271886295557`*^9, 3.818327195356439*^9}, {
  3.860672365752698*^9, 
  3.8606723663117456`*^9}},ExpressionUUID->"c5969c56-10a9-4459-ad8d-\
1cc20e7c64db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scheme", "=", "\"\<random\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.858683954393511*^9, 3.858683956148291*^9}, {
  3.8606719738525953`*^9, 3.860671978222046*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"c1e80cfe-6ad2-40b2-a27b-13d71b541d53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"name", " ", "=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "fl", ",", " ", "\"\<_\>\"", ",", " ", "scheme", ",", "\"\<_\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.860672081620222*^9, 3.860672088405491*^9}, {
   3.860672143210979*^9, 3.8606721445025797`*^9}, 3.860672818966502*^9},
 CellLabel->
  "In[328]:=",ExpressionUUID->"9bb52a62-4b28-4ac5-859c-fdab17ec2451"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"name", ",", 
       RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
       RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<.txt\>\""}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sequencesAA", "[", 
           RowBox[{"[", 
            RowBox[{"trs", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"fs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"trs", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"trs", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "//", "Length"}]}], "]"}], ",", 
          " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"fl", ",", " ", 
            RowBox[{"Length", "@", 
             RowBox[{"trs", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<mut\>\"", ",", "\"\<f\>\"", ",", "\"\<v\>\"", ",", 
         "\"\<condition\>\""}], "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"Length", "@", "trs"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764341765398015*^9, 3.764341827947495*^9}, {
   3.76434190977564*^9, 3.7643419100786867`*^9}, {3.789629952147429*^9, 
   3.789629962231992*^9}, {3.789630104236558*^9, 3.789630129081153*^9}, 
   3.7896302731122723`*^9, 3.789633186174459*^9, 3.7896334121212053`*^9, {
   3.789970349924099*^9, 3.789970349925536*^9}, {3.8586836270935097`*^9, 
   3.8586836365906343`*^9}, {3.85868387561753*^9, 3.8586838896630583`*^9}, {
   3.858683950204829*^9, 3.858683952540492*^9}, {3.86067198327949*^9, 
   3.8606719856744137`*^9}, {3.860672018355348*^9, 3.860672020059945*^9}, {
   3.860672079408794*^9, 3.8606720937643833`*^9}, {3.8606721487928133`*^9, 
   3.860672149031541*^9}, {3.860672432261229*^9, 3.860672435884112*^9}, {
   3.860672484954348*^9, 3.8606724853863363`*^9}, {3.861883479508594*^9, 
   3.861883500588504*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"f8cf8107-f99e-48c0-9825-e4fda48cc3cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<dataf = CSV.read(\\\"file\\\")\>\"", ",", 
         RowBox[{"\"\<file\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<.txt\>\""}], 
           "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
        "\"\<d = prepdata(dataf, :mut, :sequence, \\\"WT\\\", :f, cname = \
:condition, vname = :v)\>\"", ",", " ", 
         RowBox[{"\"\<WT\>\"", "\[Rule]", "wtAA"}]}], "]"}], ",", 
       "\"\<@time mlin = nonepistatic_model(d)\>\"", ",", 
       "\"\<@time m = fit(mlin, nk = 4, tol = 1e-14)\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"b_#.tsv\\\",m[:b])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"a_#.tsv\\\",m[:a])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"yhat_#.tsv\\\",m[:yhat])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nrep"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "@", "trs"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.860875342090604*^9},
 CellLabel->
  "In[330]:=",ExpressionUUID->"723ec223-be32-44dc-8346-7744d828a315"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"name", ",", " ", "\"\<terminal.txt\>\""}], "]"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"\"\<cd(\\\"#\\\")\>\"", ",", 
          RowBox[{"\"\<#\>\"", "\[Rule]", "geWD"}]}], "]"}], ",", 
        "\"\<using CSV\>\"", ",", "\"\<using DataFrames\>\"", ",", 
        "\"\<using GlobalEpistasis\>\""}], "}"}], ",", "%"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.764342952455517*^9, 3.764342975459733*^9}, {
   3.7643433310174723`*^9, 3.764343335543046*^9}, 3.7644082192700157`*^9, {
   3.789630292975759*^9, 3.7896302952427883`*^9}, {3.789633586210349*^9, 
   3.7896335949846487`*^9}, {3.789633785740715*^9, 3.789633785897174*^9}, {
   3.789633957503099*^9, 3.789633979375195*^9}, 3.789691898692636*^9, 
   3.789692208745694*^9, 3.804518042723241*^9, {3.8586854460716667`*^9, 
   3.858685451401875*^9}, 3.8586854980787153`*^9, {3.860672184472376*^9, 
   3.860672196417255*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"1956f195-1747-42b7-8ab5-229d3e7403d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Noised", "Subsubsection",
 CellChangeTimes->{{3.8183271886295557`*^9, 3.818327195356439*^9}, {
  3.860672365752698*^9, 
  3.860672378673863*^9}},ExpressionUUID->"cb575a94-6898-4779-a163-\
5f1b208c45ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scheme", "=", "\"\<noised\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.858683954393511*^9, 3.858683956148291*^9}, {
  3.8606719738525953`*^9, 3.860671978222046*^9}, {3.8606723798966293`*^9, 
  3.860672380507712*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"52f95640-6904-4562-bbdf-504004f4b84d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"name", " ", "=", " ", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
   "fl", ",", " ", "\"\<_\>\"", ",", " ", "scheme", ",", "\"\<_\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.860672081620222*^9, 3.860672088405491*^9}, {
  3.860672143210979*^9, 3.8606721445025797`*^9}},
 CellLabel->
  "In[333]:=",ExpressionUUID->"dd1d5e1d-e87c-49a1-ace1-02b9ffb16118"],

Cell[BoxData["\<\"20_4_SPR_noised_\"\>"], "Output",
 CellChangeTimes->{3.8606720886396637`*^9, 3.860672153831336*^9, 
  3.860672383000381*^9, 3.8606726437059517`*^9, 3.860833226831188*^9, 
  3.860873291831231*^9, 3.860875279126074*^9, 3.860875892258898*^9, 
  3.863526224714364*^9, 3.8635271785029163`*^9, 3.863819090549871*^9},
 CellLabel->
  "Out[333]=",ExpressionUUID->"23ef1b05-2b96-4d63-9949-362af3e58905"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"J", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.8618836630613613`*^9, 3.86188366479422*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"60850495-54e8-4ca2-8f4e-499bba256abb"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"name", ",", 
       RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
       RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<.txt\>\""}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sequencesAA", "[", 
           RowBox[{"[", 
            RowBox[{"trs", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"fnlist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "J"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"trs", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"varnoiselist", "[", 
             RowBox[{"[", "J", "]"}], "]"}], ",", " ", 
            RowBox[{"Length", "@", 
             RowBox[{"trs", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"fl", ",", " ", 
            RowBox[{"Length", "@", 
             RowBox[{"trs", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<mut\>\"", ",", "\"\<f\>\"", ",", "\"\<v\>\"", ",", 
         "\"\<condition\>\""}], "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"Length", "@", "trs"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764341765398015*^9, 3.764341827947495*^9}, {
   3.76434190977564*^9, 3.7643419100786867`*^9}, {3.789629952147429*^9, 
   3.789629962231992*^9}, {3.789630104236558*^9, 3.789630129081153*^9}, 
   3.7896302731122723`*^9, 3.789633186174459*^9, 3.7896334121212053`*^9, {
   3.789970349924099*^9, 3.789970349925536*^9}, {3.8586836270935097`*^9, 
   3.8586836365906343`*^9}, {3.85868387561753*^9, 3.8586838896630583`*^9}, {
   3.858683950204829*^9, 3.858683952540492*^9}, {3.86067198327949*^9, 
   3.8606719856744137`*^9}, {3.860672018355348*^9, 3.860672020059945*^9}, {
   3.860672079408794*^9, 3.8606720937643833`*^9}, {3.8606721487928133`*^9, 
   3.860672149031541*^9}, {3.86067242071699*^9, 3.860672421058791*^9}, {
   3.860672467406149*^9, 3.860672468102326*^9}, {3.86188357474257*^9, 
   3.861883608795059*^9}, {3.86188364680511*^9, 3.861883661579998*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"25ea2286-f604-43e5-a6ce-89637ca87872"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<dataf = CSV.read(\\\"file\\\")\>\"", ",", 
         RowBox[{"\"\<file\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<.txt\>\""}], 
           "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
        "\"\<d = prepdata(dataf, :mut, :sequence, \\\"WT\\\", :f, cname = \
:condition, vname = :v)\>\"", ",", " ", 
         RowBox[{"\"\<WT\>\"", "\[Rule]", "wtAA"}]}], "]"}], ",", 
       "\"\<@time mlin = nonepistatic_model(d)\>\"", ",", 
       "\"\<@time m = fit(mlin, nk = 4, tol = 1e-14)\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"b_#.tsv\\\",m[:b])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"a_#.tsv\\\",m[:a])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"yhat_#.tsv\\\",m[:yhat])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nrep"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "@", "trs"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7643429322649117`*^9, 3.764342944583015*^9}, {
   3.7643430700482388`*^9, 3.764343071106475*^9}, {3.76434319263198*^9, 
   3.764343193094243*^9}, 3.764343240991868*^9, {3.764343581500609*^9, 
   3.764343592257764*^9}, {3.789630169564464*^9, 3.789630278769821*^9}, 
   3.789633441487934*^9, 3.7899703499346523`*^9, 3.8586838978821297`*^9, {
   3.858683969436791*^9, 3.858684000239835*^9}, {3.858685331121874*^9, 
   3.858685335086525*^9}, {3.859635861160777*^9, 3.859635861256249*^9}, {
   3.8606721091114902`*^9, 3.860672109425041*^9}, {3.860672162087819*^9, 
   3.8606721797370768`*^9}, {3.8606725689718533`*^9, 
   3.8606725691219254`*^9}, {3.860875164152392*^9, 3.860875182426817*^9}},
 CellLabel->
  "In[336]:=",ExpressionUUID->"8722e4a1-8356-48d4-bec2-b7829b9ec3e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"name", ",", " ", "\"\<terminal.txt\>\""}], "]"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"\"\<cd(\\\"#\\\")\>\"", ",", 
          RowBox[{"\"\<#\>\"", "\[Rule]", "geWD"}]}], "]"}], ",", 
        "\"\<using CSV\>\"", ",", "\"\<using DataFrames\>\"", ",", 
        "\"\<using GlobalEpistasis\>\""}], "}"}], ",", "%"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.764342952455517*^9, 3.764342975459733*^9}, {
   3.7643433310174723`*^9, 3.764343335543046*^9}, 3.7644082192700157`*^9, {
   3.789630292975759*^9, 3.7896302952427883`*^9}, {3.789633586210349*^9, 
   3.7896335949846487`*^9}, {3.789633785740715*^9, 3.789633785897174*^9}, {
   3.789633957503099*^9, 3.789633979375195*^9}, 3.789691898692636*^9, 
   3.789692208745694*^9, 3.804518042723241*^9, {3.8586854460716667`*^9, 
   3.858685451401875*^9}, 3.8586854980787153`*^9, {3.860672184472376*^9, 
   3.860672196417255*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"5293dde7-7bb7-4df3-98b6-48f4437c1532"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mut", "Subsubsection",
 CellChangeTimes->{{3.8183271886295557`*^9, 3.818327195356439*^9}, {
  3.860672365752698*^9, 3.8606723663117456`*^9}, {3.860672518996893*^9, 
  3.86067252220437*^9}},ExpressionUUID->"9e5cddff-8b3e-4ea3-a423-\
3b3fc045a8a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scheme", "=", "\"\<mut\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.858683954393511*^9, 3.858683956148291*^9}, {
  3.8606719738525953`*^9, 3.860671978222046*^9}, {3.8606725249093103`*^9, 
  3.860672525298085*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"777cc921-8b2b-433d-a1d0-2131dbcc684e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"name", " ", "=", " ", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
   "fl", ",", " ", "\"\<_\>\"", ",", " ", "scheme", ",", "\"\<_\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.860672081620222*^9, 3.860672088405491*^9}, {
  3.860672143210979*^9, 3.8606721445025797`*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"ab94bdf6-6865-4177-9cad-b4d46cb24ca6"],

Cell[BoxData["\<\"20_4_SPR_mut_\"\>"], "Output",
 CellChangeTimes->{3.8606720886396637`*^9, 3.860672153831336*^9, 
  3.86067252876114*^9, 3.8606726918445177`*^9, 3.860833262525386*^9, 
  3.860873316526518*^9, 3.8608753220683947`*^9, 3.86087593098769*^9, 
  3.861883721805469*^9, 3.863527303322823*^9, 3.863819212763426*^9},
 CellLabel->
  "Out[339]=",ExpressionUUID->"6ece6171-4eb0-4acf-9ef9-745fc395b5bb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"name", ",", 
       RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
       RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<.txt\>\""}], "]"}], ",", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sequencesAA", "[", 
           RowBox[{"[", 
            RowBox[{"trs", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"fs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"trsmut", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"trsmut", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"fl", ",", " ", 
            RowBox[{"Length", "@", 
             RowBox[{"trsmut", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<mut\>\"", ",", "\"\<f\>\"", ",", "\"\<v\>\"", ",", 
         "\"\<condition\>\""}], "}"}]}], "]"}], ",", "\"\<CSV\>\""}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"Length", "@", "trs"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764341765398015*^9, 3.764341827947495*^9}, {
   3.76434190977564*^9, 3.7643419100786867`*^9}, {3.789629952147429*^9, 
   3.789629962231992*^9}, {3.789630104236558*^9, 3.789630129081153*^9}, 
   3.7896302731122723`*^9, 3.789633186174459*^9, 3.7896334121212053`*^9, {
   3.789970349924099*^9, 3.789970349925536*^9}, {3.8586836270935097`*^9, 
   3.8586836365906343`*^9}, {3.85868387561753*^9, 3.8586838896630583`*^9}, {
   3.858683950204829*^9, 3.858683952540492*^9}, {3.86067198327949*^9, 
   3.8606719856744137`*^9}, {3.860672018355348*^9, 3.860672020059945*^9}, {
   3.860672079408794*^9, 3.8606720937643833`*^9}, {3.8606721487928133`*^9, 
   3.860672149031541*^9}, {3.860672448525195*^9, 3.860672450859165*^9}, {
   3.860672535244835*^9, 3.8606725484438143`*^9}, {3.861883726695231*^9, 
   3.861883731968416*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"c895f3e7-55fb-4d3c-a4df-4370892c1c2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<dataf = CSV.read(\\\"file\\\")\>\"", ",", 
         RowBox[{"\"\<file\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}], ",", "\"\<.txt\>\""}], 
           "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
        "\"\<d = prepdata(dataf, :mut, :sequence, \\\"WT\\\", :f, cname = \
:condition, vname = :v)\>\"", ",", " ", 
         RowBox[{"\"\<WT\>\"", "\[Rule]", "wtAA"}]}], "]"}], ",", 
       "\"\<@time mlin = nonepistatic_model(d)\>\"", ",", 
       "\"\<@time m = fit(mlin, nk = 4, tol = 1e-14)\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"b_#.tsv\\\",m[:b])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"a_#.tsv\\\",m[:a])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"yhat_#.tsv\\\",m[:yhat])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"name", ",", " ", 
            RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nrep"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "@", "trs"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8608759699139843`*^9, 3.860875971028613*^9}},
 CellLabel->
  "In[341]:=",ExpressionUUID->"1f12101d-d386-4a60-a4e5-7d28f783cd3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"name", ",", " ", "\"\<terminal.txt\>\""}], "]"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"\"\<cd(\\\"#\\\")\>\"", ",", 
          RowBox[{"\"\<#\>\"", "\[Rule]", "geWD"}]}], "]"}], ",", 
        "\"\<using CSV\>\"", ",", "\"\<using DataFrames\>\"", ",", 
        "\"\<using GlobalEpistasis\>\""}], "}"}], ",", "%"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.764342952455517*^9, 3.764342975459733*^9}, {
   3.7643433310174723`*^9, 3.764343335543046*^9}, 3.7644082192700157`*^9, {
   3.789630292975759*^9, 3.7896302952427883`*^9}, {3.789633586210349*^9, 
   3.7896335949846487`*^9}, {3.789633785740715*^9, 3.789633785897174*^9}, {
   3.789633957503099*^9, 3.789633979375195*^9}, 3.789691898692636*^9, 
   3.789692208745694*^9, 3.804518042723241*^9, {3.8586854460716667`*^9, 
   3.858685451401875*^9}, 3.8586854980787153`*^9, {3.860672184472376*^9, 
   3.860672196417255*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"3d638036-7de5-410f-8c66-22a9d7b3d1d3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Import GE results", "Section",
 CellChangeTimes->{{3.8607700696112432`*^9, 
  3.860770071749626*^9}},ExpressionUUID->"59e49ede-d00b-4fb4-b5bb-\
49eea8a88db1"],

Cell[CellGroupData[{

Cell["Bulk import GE results", "Subsubsection",
 CellChangeTimes->{{3.859631811900302*^9, 
  3.859631819820139*^9}},ExpressionUUID->"2b06d36c-1795-4408-87c5-\
1d398cc03d05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", "-", 
     RowBox[{"spline", " ", "basis", " ", "degree"}]}], ",", " ", 
    RowBox[{"I", "-", 
     RowBox[{"spline", " ", "degree", " ", "is", " ", "deg"}], "+", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"elem", "=", "5"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "splines", " ", "in", " ", "finished", " ", 
    "basis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"knots", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "1", ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"elem", "-", "deg"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"knots", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"knots", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "deg"}], "]"}], ",", "knots", 
     ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"knots", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", "deg"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"BSplineBasis", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"deg", ",", "knots"}], "}"}], ",", "i", ",", "x"}], "]"}], 
      ",", "x"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{
       RowBox[{"Length", "[", "knots", "]"}], "-", "deg", "-", "2"}]}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReplacePart", "[", 
   RowBox[{"%", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{
        RowBox[{"BSplineBasis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"deg", ",", "knots"}], "}"}], ",", "0", ",", "0"}], "]"}], 
        "x"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"%", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"%", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
               RowBox[{"x", "\[Rule]", "1"}]}], ")"}], "+", 
             RowBox[{
              RowBox[{"BSplineBasis", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"deg", ",", "knots"}], "}"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "knots", "]"}], "-", "deg", "-", 
                 "2"}], ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"x", "-", "1"}], ")"}]}]}], ",", 
            RowBox[{"x", ">", "1"}]}], "}"}], "}"}]}], "]"}]}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"basis", "=", 
    RowBox[{
     RowBox[{"%", "/", 
      RowBox[{"%", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}]}], 
   ")"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transform", "[", 
   RowBox[{"phi_", ",", "a_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"First", "[", "a", "]"}], "+", 
    RowBox[{"basis", ".", 
     RowBox[{"Rest", "[", "a", "]"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", "phi"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{
  3.731878182758545*^9, {3.733689392142507*^9, 3.733689403900383*^9}, {
   3.733689698950227*^9, 3.7336897221628857`*^9}, {3.733689786339237*^9, 
   3.7336897997475977`*^9}, 3.733690006683188*^9, 3.7340983797861156`*^9, {
   3.861100828193893*^9, 3.861100837735516*^9}, {3.8620615594600687`*^9, 
   3.862061559601403*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"22ff1329-67f8-4c8d-9578-0af051324b58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"geprefix", "=", "fl"}], ";"}]], "Input",
 CellChangeTimes->{{3.861100770748372*^9, 3.861100773480473*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"bc9c9aa5-d3eb-4730-9a69-702cc8130d32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"geWD", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "\"\</Users/keitokiddo/Dropbox (UFL)/VC_revision/GE/\>\"", ",", " ", 
     "fl"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "geWD", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.858685415753504*^9, 3.858685417146699*^9}, {
   3.8596316559381247`*^9, 3.85963165802564*^9}, {3.860054897099617*^9, 
   3.860054901392017*^9}, {3.8600559355596533`*^9, 3.8600559366773376`*^9}, {
   3.860671770772121*^9, 3.860671793639415*^9}, 3.860874957872004*^9},
 CellLabel->
  "In[112]:=",ExpressionUUID->"c5330029-39b0-4727-b179-40e685c1cc2f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.863809505893577*^9, 3.863809507096744*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"f68ee291-b8f8-43ea-bf52-a6f91a911e2d"],

Cell[BoxData["\<\"/Users/keitokiddo/Dropbox \
(UFL)/VC_revision/GE/20_4_SPR\"\>"], "Output",
 CellChangeTimes->{3.863809507352977*^9, 3.863809847788642*^9, 
  3.863814277270846*^9, 3.86381434239124*^9, 3.863902980677622*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"604bdba7-a167-4153-a740-19be1772ae8c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"schemes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<random\>\"", ",", " ", "\"\<noised\>\"", ",", " ", "\"\<mut\>\""}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.860672963741909*^9, 3.8606729780000677`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"099a918f-8d69-4abf-ab7a-98edbb335f06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"names", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"fl", ",", " ", "\"\<_\>\"", ",", " ", "#", ",", "\"\<_\>\""}], 
      "]"}], "&"}], "/@", "schemes"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8606729811151533`*^9, 3.860672994775576*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"6ed4ba41-2e5d-4580-a474-cf16563925ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pdsGE", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "nschemes", ",", "nrep", ",", " ", 
      RowBox[{"Length", "[", "trs", "]"}]}], "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.764343899461419*^9, 3.764343910930581*^9}, 
   3.764348185798257*^9, {3.789630300570569*^9, 3.789630300761389*^9}, {
   3.789634138910524*^9, 3.789634139846402*^9}, {3.789683996589052*^9, 
   3.789683997848209*^9}, 3.789970349944776*^9, {3.8183272059557943`*^9, 
   3.818327221796135*^9}, {3.858684479129773*^9, 3.858684481552397*^9}, {
   3.860789924953223*^9, 3.860789925555484*^9}, {3.860791061585951*^9, 
   3.860791065468185*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"83b52716-0bea-4f5f-b6e4-4b91fdc326be"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pdsGE", "[", 
      RowBox[{"[", "k", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "y", ",", "b", ",", "a", ",", "yhat", ",", "spline", ",", 
        "PossibleEffects", ",", "FactorMatrix", ",", "SortedEffects", ",", 
        "Effects", ",", "coeffsAll", ",", " ", "phige"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Import", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"\"\<b_#.tsv\>\"", ",", 
             RowBox[{"\"\<#\>\"", "\[Rule]", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"names", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
                RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
                RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], 
           "]"}], "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Import", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"\"\<a_#.tsv\>\"", ",", 
             RowBox[{"\"\<#\>\"", "\[Rule]", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"names", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
                RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
                RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], 
           "]"}], "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yhat", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Import", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"\"\<yhat_#.tsv\>\"", ",", 
             RowBox[{"\"\<#\>\"", "\[Rule]", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"names", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
                RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<_\>\"", ",", 
                RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], "]"}], 
           "]"}], "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"spline", "[", "x_", "]"}], ":=", 
        RowBox[{"transform", "[", 
         RowBox[{"x", ",", "a"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PossibleEffects", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", "l", "]"}], ",", "AA"}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"{", "geprefix", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", "l", "]"}], ",", 
             RowBox[{"Characters", "[", "wtAA", "]"}]}], "}"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FactorMatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "geprefix", "}"}], ",", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", "l", "]"}], ",", 
               RowBox[{"Characters", "[", 
                RowBox[{"sequencesAA", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"trs", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"SortedEffects", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"PossibleEffects", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"FactorMatrix", ",", "1"}], "]"}], ",", 
                  RowBox[{"PossibleEffects", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "PossibleEffects", "]"}]}], "}"}]}], 
              "]"}]}], "}"}], "]"}], ",", "Last"}], "]"}]}], ";", 
       RowBox[{"Effects", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"SortedEffects", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"NumberQ", "/@", 
           RowBox[{"SortedEffects", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
       RowBox[{"Effects", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"SortedEffects", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"NumberQ", "/@", 
           RowBox[{"SortedEffects", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
       RowBox[{"coeffsAll", "=", 
        RowBox[{"MapPartialVal", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"FromDigits", "[", 
               RowBox[{"#", ",", "alpha"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Effects", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;"}], "]"}], "]"}], "/.", "AAtoDigitRules"}], 
              ")"}]}], ")"}], " ", "-", "alpha", "+", "1"}], ",", 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
          RowBox[{"alpha", "*", "l"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"phige", " ", "=", " ", 
        RowBox[{"nullonehot", ".", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "coeffsAll"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"spline", "/@", "phige"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "3"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "13"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764343912384203*^9, 3.764343980237718*^9}, {
   3.764344138307584*^9, 3.76434414367365*^9}, {3.764344249552476*^9, 
   3.764344251401119*^9}, 3.764348186828375*^9, {3.7896303771153517`*^9, 
   3.7896303785906267`*^9}, {3.78963043390055*^9, 3.789630508036984*^9}, 
   3.789634143665848*^9, {3.789634263310788*^9, 3.789634296946513*^9}, {
   3.7896345096064453`*^9, 3.789634519081131*^9}, {3.789970349955091*^9, 
   3.789970349957296*^9}, 3.858696533392618*^9, {3.858696571858368*^9, 
   3.858696581716811*^9}, {3.858712654419792*^9, 3.85871265973447*^9}, {
   3.86005729999902*^9, 3.860057357595735*^9}, {3.860673005034728*^9, 
   3.86067303178708*^9}, 3.8607899277627163`*^9, 3.861096267025044*^9, 
   3.8610974889349413`*^9, {3.861098844355996*^9, 3.861098845486226*^9}, {
   3.861098890409254*^9, 3.861098890514818*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"fc402663-f862-487d-bc97-8e9dca49ce1f"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.86390359093721*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"dc05b954-3d2e-4e59-9663-2aa0cc106985"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pdsGE", "//", "Dimensions"}]], "Input",
 CellChangeTimes->{{3.8610975940280027`*^9, 3.861097594939131*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"fc736635-96e8-49b6-a9f7-0fc971165c65"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3", ",", "13", ",", "160000"}], "}"}]], "Output",
 CellChangeTimes->{3.861097595198409*^9, 3.861100078618099*^9, 
  3.862318726178267*^9, 3.863726592518124*^9, 3.8638108168549633`*^9, 
  3.863816712126939*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"b4ad6ea0-021b-4336-8cb9-178cdf5dd6be"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"StringJoin", "[", "wd", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.789692035857119*^9, 3.789692040071082*^9}, 
   3.789692208751072*^9, {3.789693189562523*^9, 3.7896931902265882`*^9}, 
   3.804504467133869*^9},
 CellLabel->
  "In[131]:=",ExpressionUUID->"05ae488e-07eb-4a34-a5cc-956744ad0a34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdsGE", ">>", " ", "\"\<pdsGE.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.789692045737999*^9, 3.78969204826326*^9}, {
   3.804504530460113*^9, 3.804504530816092*^9}, 3.860061218009576*^9, 
   3.860673274457623*^9, {3.8610975041846046`*^9, 3.861097505223379*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"6fc9d9bc-392e-4b67-8d9b-8af21fd0ae57"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"pdsGE", " ", "=", " ", 
    RowBox[{"Import", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"wd", ",", "\"\</pdsGE.m\>\""}], "]"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8604957339112787`*^9, 3.860495757111504*^9}, {
  3.860673335084087*^9, 3.860673351141374*^9}, {3.861097506938271*^9, 
  3.861097507960932*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"f8590a71-3297-4f22-b029-49eda370e4b1"]
}, Open  ]]
}, Open  ]],

Cell["VC", "Section",
 CellChangeTimes->{{3.860616577397707*^9, 
  3.8606165774801617`*^9}},ExpressionUUID->"45ec6db6-6942-4525-99f2-\
78da22eb89dd"],

Cell["glmnet", "Section",
 CellChangeTimes->{{3.860616585265297*^9, 
  3.8606165878632812`*^9}},ExpressionUUID->"ad9e5b66-d5da-4997-9386-\
967fb85b1bb7"]
},
Evaluator->"Kernel 2",
WindowSize->{808, 911},
WindowMargins->{{441, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1a68b835-b14e-42a7-9d99-b215e90b367b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 155, 3, 67, "Section",ExpressionUUID->"8255f4dc-e6d6-45f6-b95a-c7a6e3991284"],
Cell[738, 27, 751, 19, 136, "Input",ExpressionUUID->"c6201ce7-f7de-481b-bfbf-c8977f47e32b"],
Cell[1492, 48, 682, 16, 94, "Input",ExpressionUUID->"970b4e34-1f33-4eaa-9d44-033321ed119b"],
Cell[CellGroupData[{
Cell[2199, 68, 4543, 123, 283, "Input",ExpressionUUID->"1e78e5b0-f344-45ff-8e2b-0fb43558fe94"],
Cell[6745, 193, 282, 4, 34, "Output",ExpressionUUID->"0ef5c60d-c5ed-4da3-8229-3cb0c44ed6dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7064, 202, 1865, 51, 262, "Input",ExpressionUUID->"72640224-a894-4f22-99de-148c168d8b97"],
Cell[8932, 255, 579, 10, 34, "Output",ExpressionUUID->"fc432362-7d5a-4e1d-bf94-99d7dd2190da"]
}, Open  ]],
Cell[9526, 268, 958, 26, 73, "Input",ExpressionUUID->"e0a7b1b7-80db-45ce-bc80-b60878572f29"],
Cell[CellGroupData[{
Cell[10509, 298, 186, 3, 45, "Subsubsection",ExpressionUUID->"5426ef2c-f775-46b3-b6e0-9cb34b9e7f57"],
Cell[10698, 303, 357, 8, 30, "Input",ExpressionUUID->"1b567513-385b-46b7-9d23-15c55aa9b243"],
Cell[11058, 313, 682, 15, 30, "Input",ExpressionUUID->"96adc3ed-5a30-4499-9da1-6f5b1219ebce"],
Cell[11743, 330, 2447, 68, 157, "Input",ExpressionUUID->"08cd1362-02fa-4e84-8cb7-7e548c6c9c35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14227, 403, 159, 3, 54, "Subsection",ExpressionUUID->"79ce1be8-de6f-4bab-9b49-30f382e09f8a"],
Cell[14389, 408, 1723, 47, 178, "Input",ExpressionUUID->"4f4df399-5ad1-420e-8b08-094c8e61618e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16149, 460, 170, 3, 54, "Subsection",ExpressionUUID->"bd51a80d-6127-42f4-af36-3c001b6cbe7d"],
Cell[16322, 465, 1155, 35, 94, "Input",ExpressionUUID->"fb56d93f-a92a-43ab-9941-b4f921c1f35b"],
Cell[17480, 502, 1433, 39, 94, "Input",ExpressionUUID->"2be41ddf-3da4-46b0-a469-4c40be47093b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[18962, 547, 180, 3, 53, "Section",ExpressionUUID->"7e936800-8126-4c8e-aa8f-97aadbe0ddde"],
Cell[CellGroupData[{
Cell[19167, 554, 216, 4, 54, "Subsection",ExpressionUUID->"db3b4267-3ba0-4972-a7c8-6da316e8d80c"],
Cell[19386, 560, 710, 17, 94, "Input",ExpressionUUID->"5c33b1d5-d0c7-4e1f-a7e2-c3a497aecdf1"],
Cell[20099, 579, 289, 7, 30, "Input",ExpressionUUID->"cc1c5b1a-d627-4144-bd4c-4b625d1c56ab"],
Cell[20391, 588, 501, 13, 30, "Input",ExpressionUUID->"5cf94715-b799-418f-a7b0-d75b1bef617c"],
Cell[20895, 603, 516, 15, 30, "Input",ExpressionUUID->"a83161ee-3c08-4d6b-862e-4338bfc3968e"],
Cell[21414, 620, 538, 15, 52, "Input",ExpressionUUID->"bb1f8a3f-4306-403e-bd6a-4c8a7e959465"],
Cell[21955, 637, 373, 9, 30, "Input",ExpressionUUID->"21d0be93-3ad9-4411-b57e-658e863a8524"],
Cell[22331, 648, 3815, 99, 430, "Input",ExpressionUUID->"b6327d00-ec2c-41f7-aaa1-cdea5c1c9128"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26183, 752, 167, 3, 54, "Subsection",ExpressionUUID->"2c17d055-e7e1-447e-8254-2d0b511173ae"],
Cell[26353, 757, 614, 18, 52, "Input",ExpressionUUID->"68507c79-5cf7-467d-bf80-de3e8afd0df4"],
Cell[26970, 777, 1175, 31, 52, "Input",ExpressionUUID->"d5b672b6-30c8-4eab-b184-291d55998634"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28182, 813, 215, 3, 54, "Subsection",ExpressionUUID->"7fbe713f-9d09-45cc-a360-8534445537a6"],
Cell[28400, 818, 13100, 350, 1255, "Input",ExpressionUUID->"122b81da-d265-40d1-93da-30c64380b579"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41537, 1173, 172, 3, 54, "Subsection",ExpressionUUID->"f4997e82-59c3-4cb9-9040-88a5534f6e23"],
Cell[41712, 1178, 2749, 81, 199, "Input",ExpressionUUID->"824ea2bf-89a7-4baf-be69-4785e762c74f"],
Cell[44464, 1261, 14738, 380, 1284, "Input",ExpressionUUID->"1e7e2cbc-f673-4c10-93b2-69b34e29b82f"]
}, Closed]],
Cell[CellGroupData[{
Cell[59239, 1646, 169, 3, 38, "Subsection",ExpressionUUID->"ade545aa-8a37-4b35-abc8-53743685e7a4"],
Cell[59411, 1651, 1448, 44, 130, "Input",ExpressionUUID->"09c0fdfd-0756-4cff-bb15-6d9820b7b25c"],
Cell[60862, 1697, 18094, 496, 1990, "Input",ExpressionUUID->"64f41619-5af5-4d02-b1b2-bbbe978a14ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78993, 2198, 166, 3, 54, "Subsection",ExpressionUUID->"c8dcdf49-3bf7-4b8a-84ac-40a31965c2a5"],
Cell[79162, 2203, 3095, 82, 199, "Input",ExpressionUUID->"6b960a29-61cd-4284-9bc6-cf544cfddd40"],
Cell[82260, 2287, 289, 7, 30, "Input",ExpressionUUID->"061eaed5-c6b8-4085-a91a-c6e9a91a6b79"],
Cell[82552, 2296, 1817, 47, 136, "Input",ExpressionUUID->"d2da7df9-23f3-49af-af22-bb79a337eb9a"],
Cell[84372, 2345, 350, 9, 30, "Input",ExpressionUUID->"4b28ccd6-884c-4166-a752-ce7db1538040"],
Cell[84725, 2356, 863, 23, 30, "Input",ExpressionUUID->"dd4dd8fc-29ff-43ea-890c-694641d16ca2"],
Cell[85591, 2381, 936, 24, 94, "Input",ExpressionUUID->"d6933549-160a-4e95-85ea-85dfe7dab3ab"],
Cell[86530, 2407, 830, 21, 73, "Input",ExpressionUUID->"497efe51-3f1b-48d4-9579-7f912c2caae6"],
Cell[87363, 2430, 4254, 115, 367, "Input",ExpressionUUID->"65dd250a-5c8b-4298-a04b-3cfbfbe310a4"],
Cell[CellGroupData[{
Cell[91642, 2549, 857, 24, 52, "Input",ExpressionUUID->"13e95f12-fa86-4963-bb48-9f9fe435172d"],
Cell[92502, 2575, 562, 9, 34, "Output",ExpressionUUID->"382f8c01-28ad-4289-99ac-8412f1d06151"]
}, Open  ]],
Cell[93079, 2587, 726, 20, 73, "Input",ExpressionUUID->"384f0514-12a1-4cbf-b030-48e1c864a88e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[93854, 2613, 247, 4, 53, "Section",ExpressionUUID->"d6179839-f5b4-48a9-af4f-190dd806ec7f"],
Cell[CellGroupData[{
Cell[94126, 2621, 204, 3, 54, "Subsection",ExpressionUUID->"27d4f9c3-e974-4c19-ae8f-18146b4b68cd"],
Cell[94333, 2626, 923, 26, 94, "Input",ExpressionUUID->"1fe486ba-c93d-4f45-9ff1-21a43109114b"],
Cell[CellGroupData[{
Cell[95281, 2656, 2486, 65, 262, "Input",ExpressionUUID->"43b95777-438c-4060-8dff-083bb7cb53b6"],
Cell[97770, 2723, 607, 11, 34, "Output",ExpressionUUID->"94721158-a9d7-4c77-bb60-fdc0f01cacf7"]
}, Open  ]],
Cell[98392, 2737, 644, 18, 73, "Input",ExpressionUUID->"cf52b895-7274-4100-9815-e6ed73eacd9a"],
Cell[99039, 2757, 1762, 48, 136, "Input",ExpressionUUID->"61652206-d1e9-443a-b842-c5cf2f72732b"],
Cell[100804, 2807, 929, 25, 30, "Input",ExpressionUUID->"0039833d-7a23-4bd0-80e9-30009f89e308"],
Cell[CellGroupData[{
Cell[101758, 2836, 387, 7, 30, "Input",ExpressionUUID->"ff9ddef1-37e0-464e-a551-74c9176c9d71"],
Cell[102148, 2845, 656, 12, 34, "Output",ExpressionUUID->"7ba4ba74-e227-4674-8252-96846278bf25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102841, 2862, 554, 15, 30, "Input",ExpressionUUID->"b406ba62-8653-48df-9c77-1c77f9448849"],
Cell[103398, 2879, 851, 21, 56, "Output",ExpressionUUID->"f841334c-916f-4dab-8763-3dabe8a0b165"]
}, Open  ]],
Cell[104264, 2903, 1145, 30, 30, "Input",ExpressionUUID->"e9c8ab10-9613-4f14-b5ed-4ca21fe8c308"],
Cell[CellGroupData[{
Cell[105434, 2937, 290, 6, 30, "Input",ExpressionUUID->"1793cbb3-3217-4316-aa7d-596b57faf34a"],
Cell[105727, 2945, 382, 6, 34, "Output",ExpressionUUID->"67628aa5-f1ee-4e5e-ab5d-905d9bc46859"]
}, Open  ]],
Cell[106124, 2954, 844, 20, 52, "Input",ExpressionUUID->"092afc48-0a0e-4e77-873f-c0a909421b16"],
Cell[CellGroupData[{
Cell[106993, 2978, 1557, 38, 73, "Input",ExpressionUUID->"5a71f4f0-6c6a-4f77-8b02-4937762f2a19"],
Cell[108553, 3018, 4446, 98, 250, "Output",ExpressionUUID->"2cce8835-d3c5-4096-a68b-ce4a09862348"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113048, 3122, 157, 3, 54, "Subsection",ExpressionUUID->"0182df01-9ef5-472f-9117-4a3f901a79b9"],
Cell[113208, 3127, 479, 11, 30, "Input",ExpressionUUID->"2842fd60-1e75-4399-9e4f-119861ca3156"],
Cell[CellGroupData[{
Cell[113712, 3142, 582, 17, 30, "Input",ExpressionUUID->"26a74903-913a-4674-a152-4c90c2128a4b"],
Cell[114297, 3161, 558, 11, 34, "Output",ExpressionUUID->"345c54da-9a4a-4f0f-bb22-99ff9637e1ba"]
}, Open  ]],
Cell[114870, 3175, 719, 19, 73, "Input",ExpressionUUID->"30587f63-8f4b-4d6c-a89e-d4ac6fe14a91"],
Cell[115592, 3196, 638, 19, 30, "Input",ExpressionUUID->"2305ad30-5894-4e1c-a541-5e09f0a52db3"],
Cell[CellGroupData[{
Cell[116255, 3219, 529, 15, 30, "Input",ExpressionUUID->"d87cb1c3-adf7-451d-ab3a-5e3bb882f2f7"],
Cell[116787, 3236, 582, 12, 34, "Output",ExpressionUUID->"19472f54-52a5-4813-b5ce-8f127bbb5c53"]
}, Open  ]],
Cell[117384, 3251, 1025, 27, 73, "Input",ExpressionUUID->"48ceda01-7be7-4017-bb20-714e0190afe5"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[118458, 3284, 262, 4, 53, "Section",ExpressionUUID->"f5e4c734-0ae0-482c-bc41-15ba975d06e8"],
Cell[CellGroupData[{
Cell[118745, 3292, 164, 3, 54, "Subsection",ExpressionUUID->"368a7ea7-3e00-4077-bea2-3b5f29832627"],
Cell[118912, 3297, 960, 27, 73, "Input",ExpressionUUID->"f08e873e-10a3-4c3f-a9cd-978a6fb11970"],
Cell[119875, 3326, 1629, 46, 115, "Input",ExpressionUUID->"f5fdeb68-2426-4033-8be3-1b140f269d5d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121541, 3377, 171, 3, 54, "Subsection",ExpressionUUID->"62ed04da-fe6f-4147-a058-6b6efef6d7ee"],
Cell[121715, 3382, 217, 6, 30, "Input",ExpressionUUID->"6ed64fc1-c52a-49e9-be17-64c7549b67d7"],
Cell[CellGroupData[{
Cell[121957, 3392, 440, 10, 30, "Input",ExpressionUUID->"5c0c2f54-116d-47d4-ad7a-738c5de0f782"],
Cell[122400, 3404, 948, 17, 70, "Output",ExpressionUUID->"33c1773c-1a80-4431-94a4-06d2ae39dd3e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123385, 3426, 495, 13, 30, "Input",ExpressionUUID->"96966889-66c6-4323-8a10-aa493dbe3780"],
Cell[123883, 3441, 2819, 60, 70, "Output",ExpressionUUID->"b54d9d3d-0c05-4dc0-ab7c-da67e147fee4"]
}, Open  ]],
Cell[126717, 3504, 962, 27, 73, "Input",ExpressionUUID->"57188d89-da16-40c6-8eac-feb575fc4a79"],
Cell[127682, 3533, 1722, 54, 136, "Input",ExpressionUUID->"58717cb0-2ac9-4d04-8eb1-8a40f4bd088d"],
Cell[129407, 3589, 1156, 26, 52, "Input",ExpressionUUID->"29de2cd7-75d0-4dd0-a7d6-5cfb661f81d9"],
Cell[130566, 3617, 2282, 55, 136, "Input",ExpressionUUID->"3761c8b8-dfe1-4870-8901-6b318cf58746"],
Cell[CellGroupData[{
Cell[132873, 3676, 209, 4, 30, "Input",ExpressionUUID->"00132ea2-084a-4f93-b7d5-5494e18b8e34"],
Cell[133085, 3682, 823, 14, 70, "Output",ExpressionUUID->"4db3943b-4fd8-43cc-a51c-f041618de848"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133945, 3701, 965, 25, 52, "Input",ExpressionUUID->"5eba1d0b-e5b4-4805-87c7-eb74b1b9f3be"],
Cell[134913, 3728, 1071, 24, 70, "Output",ExpressionUUID->"f5e9c057-a8fa-4795-9a29-ca438c290d7e"],
Cell[135987, 3754, 903, 16, 70, "Output",ExpressionUUID->"ad2f3d5f-7bb1-48bb-834e-95ce8dd4568b"]
}, Open  ]],
Cell[136905, 3773, 1302, 26, 52, "Input",ExpressionUUID->"d270c1bc-0932-4862-82ac-3b68ae56ec39"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[138256, 3805, 211, 4, 53, "Section",ExpressionUUID->"a33a3c75-e857-41dc-995e-f8633519efb9"],
Cell[138470, 3811, 650, 14, 52, "Input",ExpressionUUID->"78d906c7-5e82-4126-be09-db1e261974c5"],
Cell[CellGroupData[{
Cell[139145, 3829, 210, 4, 45, "Subsubsection",ExpressionUUID->"c5969c56-10a9-4459-ad8d-1cc20e7c64db"],
Cell[139358, 3835, 285, 6, 30, "Input",ExpressionUUID->"c1e80cfe-6ad2-40b2-a27b-13d71b541d53"],
Cell[139646, 3843, 428, 10, 30, "Input",ExpressionUUID->"9bb52a62-4b28-4ac5-859c-fdab17ec2451"],
Cell[140077, 3855, 2527, 58, 94, "Input",ExpressionUUID->"f8cf8107-f99e-48c0-9825-e4fda48cc3cc"],
Cell[142607, 3915, 2324, 51, 304, "Input",ExpressionUUID->"723ec223-be32-44dc-8346-7744d828a315"],
Cell[144934, 3968, 1180, 25, 73, "Input",ExpressionUUID->"1956f195-1747-42b7-8ab5-229d3e7403d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146151, 3998, 208, 4, 45, "Subsubsection",ExpressionUUID->"cb575a94-6898-4779-a163-5f1b208c45ae"],
Cell[146362, 4004, 336, 7, 30, "Input",ExpressionUUID->"52f95640-6904-4562-bbdf-504004f4b84d"],
Cell[CellGroupData[{
Cell[146723, 4015, 383, 9, 30, "Input",ExpressionUUID->"dd1d5e1d-e87c-49a1-ace1-02b9ffb16118"],
Cell[147109, 4026, 411, 6, 34, "Output",ExpressionUUID->"23ef1b05-2b96-4d63-9949-362af3e58905"]
}, Open  ]],
Cell[147535, 4035, 217, 5, 30, "Input",ExpressionUUID->"60850495-54e8-4ca2-8f4e-499bba256abb"],
Cell[147755, 4042, 2682, 60, 115, "Input",ExpressionUUID->"25ea2286-f604-43e5-a6ce-89637ca87872"],
Cell[150440, 4104, 2993, 60, 304, "Input",ExpressionUUID->"8722e4a1-8356-48d4-bec2-b7829b9ec3e7"],
Cell[153436, 4166, 1180, 25, 73, "Input",ExpressionUUID->"5293dde7-7bb7-4df3-98b6-48f4437c1532"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154653, 4196, 252, 4, 45, "Subsubsection",ExpressionUUID->"9e5cddff-8b3e-4ea3-a423-3b3fc045a8a0"],
Cell[154908, 4202, 333, 7, 30, "Input",ExpressionUUID->"777cc921-8b2b-433d-a1d0-2131dbcc684e"],
Cell[CellGroupData[{
Cell[155266, 4213, 383, 9, 30, "Input",ExpressionUUID->"ab94bdf6-6865-4177-9cad-b4d46cb24ca6"],
Cell[155652, 4224, 406, 6, 34, "Output",ExpressionUUID->"6ece6171-4eb0-4acf-9ef9-745fc395b5bb"]
}, Open  ]],
Cell[156073, 4233, 2524, 57, 94, "Input",ExpressionUUID->"c895f3e7-55fb-4d3c-a4df-4370892c1c2c"],
Cell[158600, 4292, 2350, 51, 304, "Input",ExpressionUUID->"1f12101d-d386-4a60-a4e5-7d28f783cd3d"],
Cell[160953, 4345, 1180, 25, 73, "Input",ExpressionUUID->"3d638036-7de5-410f-8c66-22a9d7b3d1d3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[162182, 4376, 164, 3, 53, "Section",ExpressionUUID->"59e49ede-d00b-4fb4-b5bb-49eea8a88db1"],
Cell[CellGroupData[{
Cell[162371, 4383, 173, 3, 45, "Subsubsection",ExpressionUUID->"2b06d36c-1795-4408-87c5-1d398cc03d05"],
Cell[162547, 4388, 4251, 128, 262, "Input",ExpressionUUID->"22ff1329-67f8-4c8d-9578-0af051324b58"],
Cell[166801, 4518, 224, 5, 30, "Input",ExpressionUUID->"bc9c9aa5-d3eb-4730-9a69-702cc8130d32"],
Cell[167028, 4525, 648, 14, 52, "Input",ExpressionUUID->"c5330029-39b0-4727-b179-40e685c1cc2f"],
Cell[CellGroupData[{
Cell[167701, 4543, 206, 4, 30, "Input",ExpressionUUID->"f68ee291-b8f8-43ea-bf52-a6f91a911e2d"],
Cell[167910, 4549, 307, 5, 34, "Output",ExpressionUUID->"604bdba7-a167-4153-a740-19be1772ae8c"]
}, Open  ]],
Cell[168232, 4557, 349, 9, 30, "Input",ExpressionUUID->"099a918f-8d69-4abf-ab7a-98edbb335f06"],
Cell[168584, 4568, 399, 10, 30, "Input",ExpressionUUID->"6ed4ba41-2e5d-4580-a474-cf16563925ca"],
Cell[168986, 4580, 787, 16, 30, "Input",ExpressionUUID->"83b52716-0bea-4f5f-b6e4-4b91fdc326be"],
Cell[CellGroupData[{
Cell[169798, 4600, 7841, 188, 682, "Input",ExpressionUUID->"fc402663-f862-487d-bc97-8e9dca49ce1f"],
Cell[177642, 4790, 159, 3, 34, "Output",ExpressionUUID->"dc05b954-3d2e-4e59-9663-2aa0cc106985"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177838, 4798, 214, 4, 30, "Input",ExpressionUUID->"fc736635-96e8-49b6-a9f7-0fc971165c65"],
Cell[178055, 4804, 342, 7, 34, "Output",ExpressionUUID->"b4ad6ea0-021b-4336-8cb9-178cdf5dd6be"]
}, Open  ]],
Cell[178412, 4814, 371, 8, 30, "Input",ExpressionUUID->"05ae488e-07eb-4a34-a5cc-956744ad0a34"],
Cell[178786, 4824, 385, 7, 30, "Input",ExpressionUUID->"6fc9d9bc-392e-4b67-8d9b-8af21fd0ae57"],
Cell[179174, 4833, 477, 12, 30, "Input",ExpressionUUID->"f8590a71-3297-4f22-b029-49eda370e4b1"]
}, Open  ]]
}, Open  ]],
Cell[179678, 4849, 149, 3, 67, "Section",ExpressionUUID->"45ec6db6-6942-4525-99f2-78da22eb89dd"],
Cell[179830, 4854, 153, 3, 53, "Section",ExpressionUUID->"ad9e5b66-d5da-4997-9386-967fb85b1bb7"]
}
]
*)

