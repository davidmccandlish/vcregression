(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    292894,       7504]
NotebookOptionsPosition[    275867,       7247]
NotebookOutlinePosition[    276285,       7264]
CellTagsIndexPosition[    276242,       7261]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"hd", "=", "\"\</Users/keitokiddo/VC_revision/Simulations/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wd", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"hd", ",", "\"\<2_16_DEN_var_ldas\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "wd", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.865370847877858*^9, 3.86537084840387*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"65e6797d-a1d1-45db-9357-e2c3684ec1eb"],

Cell[CellGroupData[{

Cell["Set up", "Section",
 CellChangeTimes->{{3.8587611622123327`*^9, 
  3.8587611631546793`*^9}},ExpressionUUID->"ad62342b-c7d6-4a26-97bb-\
2c41d4bf0427"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"alpha", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"l", "=", "16"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"figpath", "=", "\"\</Users/keitokiddo/VC/figures\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hd", "=", "\"\</Users/keitokiddo/VC_revision/Simulations/\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"wd", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"hd", ",", "\"\<2_16_DEN_var_ldas\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "wd", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.860875605343582*^9, 3.8608756137532263`*^9}, 
   3.861886504407048*^9, {3.864591634727996*^9, 3.864591661060377*^9}, {
   3.865369357923615*^9, 3.8653693582285147`*^9}},
 CellLabel->
  "In[687]:=",ExpressionUUID->"29b24c93-058c-4a24-8f72-6c1c767ddcde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fl", "=", "\"\<2_16_DEN\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.865371152055004*^9, 3.8653711555468397`*^9}},
 CellLabel->
  "In[693]:=",ExpressionUUID->"adbc12e5-08aa-4f0e-9e30-161f6ce219d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrep", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nprop", "=", "13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"schemes", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<random\>\"", ",", "\"\<noised\>\"", ",", "\"\<mut\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nschemes", "=", 
   RowBox[{"Length", "@", "schemes"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8596383416012373`*^9, 3.8596383431295357`*^9}, {
   3.860872000883339*^9, 3.860872001769627*^9}, 3.861882666167819*^9, {
   3.861954994024149*^9, 3.861954997642892*^9}},
 CellLabel->
  "In[694]:=",ExpressionUUID->"797bf748-2c1a-4c16-af0c-dec6f1e9243e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"alpha", "-", "1"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"the", " ", "alphabet", " ", "in", " ", "numbers", " ", "0"}], 
    "-", "19"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sequences", "=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"A", ",", "l"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"list", " ", "of", " ", "all", " ", "sequences"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"seq2pos", "[", "seq_", "]"}], ":=", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{"seq", ",", "alpha"}], "]"}], "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"multiplicities", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{"l", ",", "k"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"alpha", "-", "1"}], ")"}], "^", "k"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"wt", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "l"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<A\>\"", ",", "\"\<C\>\"", ",", "\"\<G\>\"", ",", "\"\<T\>\""}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AAtoDigitRules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<A\>\"", "->", "0"}], ",", 
     RowBox[{"\"\<C\>\"", "->", "1"}], ",", 
     RowBox[{"\"\<G\>\"", "->", "2"}], ",", 
     RowBox[{"\"\<T\>\"", "->", "3"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DigitToAARules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "->", "\"\<A\>\""}], ",", 
     RowBox[{"1", "->", "\"\<C\>\""}], ",", 
     RowBox[{"2", "->", "\"\<G\>\""}], ",", 
     RowBox[{"3", "->", "\"\<T\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sequencesAA", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"#", "/.", "DigitToAARules"}], "]"}], "&"}], "/@", 
    "sequences"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"wtAA", " ", "=", " ", 
   RowBox[{"sequencesAA", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Binomial", "[", 
       RowBox[{"l", ",", "k"}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"alpha", "-", "1"}], ")"}], "^", "k"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.765809188632872*^9, 3.765809230513093*^9, {3.765818554425509*^9, 
   3.7658185803234243`*^9}, 3.766229531853812*^9, 3.766229579196743*^9, {
   3.766229619564746*^9, 3.766229838748877*^9}, {3.766229919109879*^9, 
   3.7662301636376123`*^9}, {3.7662301945029373`*^9, 
   3.7662302338331842`*^9}, {3.783274186128935*^9, 3.783274231984097*^9}, {
   3.783274330146632*^9, 3.783274333883054*^9}, {3.783275180656855*^9, 
   3.783275195589322*^9}, 3.783275352797121*^9, {3.785018447155464*^9, 
   3.785018451227006*^9}, {3.8586726205152683`*^9, 3.858672621253992*^9}, 
   3.8586729723301907`*^9, {3.858765737585622*^9, 3.8587657377362957`*^9}, 
   3.859024992185452*^9, {3.8592882938463078`*^9, 3.85928829451423*^9}, {
   3.860614807245092*^9, 3.860614808145941*^9}, {3.860874232977372*^9, 
   3.860874235506974*^9}, 3.8608755799879217`*^9, {3.861882671117221*^9, 
   3.861882680609467*^9}},
 CellLabel->
  "In[698]:=",ExpressionUUID->"10d7466e-68a0-47ac-a8dd-32582f48fe1b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MakeLapRec", "[", 
   RowBox[{"alpha_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L1", ",", "L", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"L1", " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"alpha", "*", 
         RowBox[{"IdentityMatrix", "[", "alpha", "]"}]}], " ", "-", " ", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"alpha", "^", "2"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"alpha", ",", "alpha"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", "L1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"m", "<", "l"}], ",", " ", 
       RowBox[{
        RowBox[{"L", " ", "=", " ", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"L", ",", " ", 
            RowBox[{"IdentityMatrix", "[", "alpha", "]"}]}], "]"}], " ", "+", 
          " ", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"alpha", "^", "m"}], "]"}], ",", "L1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", "L"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["L",
     FontSize->14], "=", 
    RowBox[{"MakeLapRec", "[", 
     RowBox[{"alpha", ",", "l"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{3.860614940006853*^9},
 CellLabel->
  "In[709]:=",ExpressionUUID->"9609ba0b-5065-43b9-b93b-9f027b4a5675"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.773014`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.861045820432228*^9, 3.861093593102775*^9, 
  3.861093623671279*^9, 3.861096096984899*^9, 3.861720277864979*^9, 
  3.861804815732686*^9, 3.8618826493449907`*^9, 3.861882692508133*^9, 
  3.863694110238123*^9, 3.8637254663869543`*^9, 3.864591051008157*^9, 
  3.865371172653594*^9, 3.865611551407607*^9, 3.865624492932929*^9},
 CellLabel->
  "Out[710]=",ExpressionUUID->"4c3e5f59-e0b0-4208-8169-4a306c32cb9c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samplesizes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"i", " ", 
       RowBox[{"Length", "[", "sequences", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".01", ",", ".05"}], "}"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{".1", ",", ".9", ",", ".1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{".95", ",", ".99"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"proportions", "=", 
   RowBox[{"samplesizes", "/", 
    RowBox[{"(", 
     RowBox[{"alpha", "^", "l"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783344917635714*^9, 3.783344957829818*^9}, {
   3.785242990982191*^9, 3.785242998510944*^9}, 3.8610973995209913`*^9},
 CellLabel->
  "In[711]:=",ExpressionUUID->"63702d8c-e7f6-4dde-ae01-eaadef5d2aa5"],

Cell[CellGroupData[{

Cell["Export design matrix for glmnet", "Subsubsection",
 CellChangeTimes->{{3.8606174063126907`*^9, 
  3.8606174107511797`*^9}},ExpressionUUID->"c497734e-1990-4e31-a2d5-\
e19708cb2153"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"varall", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"alpha", "^", "l"}]}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.858683469175782*^9, 3.858683478361032*^9}},
 CellLabel->
  "In[713]:=",ExpressionUUID->"d1ed462f-c6b4-4c08-858f-e6ef3f365843"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"designAllonehot", "=", 
     RowBox[{"s2donehot", "[", 
      RowBox[{"sequences", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "l"}], "]"}]}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7838770543431377`*^9, 3.783877058392404*^9}, {
  3.785257343865099*^9, 3.785257350230983*^9}, {3.785257780115623*^9, 
  3.7852577840989428`*^9}, {3.787334756906878*^9, 3.787334780354789*^9}, {
  3.787335186703807*^9, 3.787335187276825*^9}, {3.8608737667839737`*^9, 
  3.86087376898272*^9}},
 CellLabel->
  "In[714]:=",ExpressionUUID->"0c4ce9f4-8281-4575-a038-d1646b9892ea"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"rules", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"designrules", "[", 
             RowBox[{
              RowBox[{"sequences", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", "k", ",", "wt", ",", 
              "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "sequences", "]"}]}], "}"}]}], "]"}], ",", 
       "2"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"null3", "=", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"rules", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sequences", "]"}], ",", 
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{"l", ",", " ", "k"}], "]"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "k"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<data/rules.tsv\>\"", ",", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Most", "[", 
            RowBox[{"ArrayRules", "[", "null3", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Most", "[", 
            RowBox[{"ArrayRules", "[", "null3", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], ",", 
      "\"\<TSV\>\""}], "]"}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.787336150219553*^9, 3.787336156771068*^9}, {
  3.860615713236985*^9, 3.860615713773657*^9}},
 CellLabel->
  "In[715]:=",ExpressionUUID->"bc5ac5cc-5c3f-4287-8626-1120ef3c8cc3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["*Functions", "Section",
 CellChangeTimes->{{3.7335158887380867`*^9, 3.733515889676353*^9}, 
   3.786385528376131*^9},ExpressionUUID->"04cb7407-0d30-4d65-a0ba-\
01f6a2900c5d"],

Cell[CellGroupData[{

Cell["Basic functions", "Subsection",
 CellChangeTimes->{{3.783446856410367*^9, 3.7834468579394484`*^9}, {
  3.7836868814985313`*^9, 
  3.783686883507257*^9}},ExpressionUUID->"c9f9dee3-8ccd-48a2-800a-\
a52cc44df806"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dp", "[", "v_", "]"}], ":=", 
  RowBox[{"v", "//", "DeleteDuplicates"}]}], "\n", 
 RowBox[{
  RowBox[{"uqc", "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{"v", "//", "DeleteDuplicates"}], "//", "Length"}]}], "\n", 
 RowBox[{
  RowBox[{"lg", "[", "v_", "]"}], ":=", 
  RowBox[{"v", "//", "Length"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", "[", "m_", "]"}], ":=", 
  RowBox[{"m", "//", "Dimensions"}]}]}], "Input",
 CellChangeTimes->{{3.7818888604652367`*^9, 3.781888869322523*^9}, {
   3.781906467636136*^9, 3.781906484693853*^9}, 3.785018461724689*^9, 
   3.7850185069229517`*^9},
 CellLabel->
  "In[304]:=",ExpressionUUID->"4fb73e55-73a4-4671-9e44-d6364650b46d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"seq2posAA", "[", "seqAA_", "]"}], ":=", 
  RowBox[{"seq2pos", "[", 
   RowBox[{
    RowBox[{"Characters", "[", "seqAA", "]"}], "/.", "AAtoDigitRules"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[308]:=",ExpressionUUID->"25482e5e-0350-4e7f-871e-7f8ba1dc2d4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"associate0", "[", 
   RowBox[{"list_", ",", "obj_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"list", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "->", "obj"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7832653184669533`*^9, 3.783265348782815*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"c4223de9-de58-4a25-8d8e-c2da8746390c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeDiagonal", "[", "vect_", "]"}], ":=", " ", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "i"}], "}"}], "->", 
      RowBox[{"vect", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "vect", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[310]:=",ExpressionUUID->"24d4d6e9-7690-447b-b026-13e9ac72c9ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nbysum", "[", "y_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"Total", "[", "y", "]"}]}], ")"}], "*", "y"}]}], "\n", 
 RowBox[{
  RowBox[{"Nbyfirst", "[", "y_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"First", "@", "y"}]}], ")"}], "*", "y"}]}]}], "Input",
 CellChangeTimes->{{3.739979078807541*^9, 3.739979101020073*^9}, 
   3.7832913778620567`*^9},
 CellLabel->
  "In[311]:=",ExpressionUUID->"4c2fe180-a868-4282-ab7e-e06f35fb989c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ginv", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "[", "x", "]"}], "==", "0."}], ",", "0", ",", 
    RowBox[{"1", "/", "x"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.783344035981493*^9, 3.783344065586173*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"83eeb6ff-0bfb-4dcb-992f-56e8e1e2dfc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"r2", "[", 
     RowBox[{"x_", ",", " ", "y_"}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "x"}], "<", "2"}], ",", " ", 
      RowBox[{"{", "}"}], ",", " ", 
      RowBox[{
       RowBox[{"Correlation", "[", 
        RowBox[{"x", ",", " ", "y"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mse", "[", 
    RowBox[{"x_", ",", " ", "y_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Mean", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", " ", "-", " ", "y"}], ")"}], "^", "2"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"maxorder", "[", "list_", "]"}], " ", ":=", " ", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", " ", "\n", "   ", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", " ", ";;"}], "]"}], "]"}], " ", "!=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"Length", "[", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"i", " ", ";;"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         " ", "\n", "    ", 
         RowBox[{"i", "++"}]}], "]"}], ";", " ", 
       RowBox[{"i", " ", "-", " ", "1"}]}]}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "From", " ", "sequence", " ", "to", " ", "lexicographical", " ", 
    "position"}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"seq2pos", "[", "seq_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{"seq", ",", " ", "alpha"}], "]"}], " ", "+", " ", "1"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Map", " ", "a", " ", "vector", " ", "of", " ", "length", " ", "m", " ", 
    "to", " ", "a", " ", "vector", " ", "of", " ", "length", " ", 
    RowBox[{
     RowBox[{"alpha", "^", "l"}], ".", " ", "\"\<list\>\""}], " ", "contains",
     " ", "the", " ", "lexicographical", " ", "positions", " ", "for", " ", 
    "all", " ", "sequences", " ", "in", " ", "\"\<data\>\""}], "*)"}], 
  RowBox[{
   RowBox[{"MapPartialVal", "[", 
    RowBox[{"list_", ",", "data_", ",", "height_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Ab", "}"}], ",", 
     RowBox[{
      RowBox[{"Ab", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"list", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", 
               RowBox[{"Length", "[", "list", "]"}]}], "]"}]}], "}"}], "]"}], 
          "->", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"height", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      RowBox[{"Ab", ".", "data"}]}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.766313986573913*^9, 3.7663139865999117`*^9}, 
   3.766314018570455*^9, 3.766314054454777*^9, {3.766918374798053*^9, 
   3.766918375323598*^9}, {3.766933287510947*^9, 3.766933303779005*^9}, {
   3.76693447774188*^9, 3.766934479190014*^9}, {3.783275084640926*^9, 
   3.7832751364618587`*^9}, {3.783292092099407*^9, 3.783292092576839*^9}, {
   3.783686214211725*^9, 3.783686219245088*^9}, {3.78368660982717*^9, 
   3.783686647156082*^9}, {3.7850184617356033`*^9, 3.785018461748094*^9}, {
   3.859280425446402*^9, 3.859280439984137*^9}, {3.8592804937568073`*^9, 
   3.859280499607479*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"07ea8555-eaf9-477f-9b06-87136b618e03"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projection operators", "Subsection",
 CellChangeTimes->{{3.783686545560483*^9, 
  3.78368655178538*^9}},ExpressionUUID->"8c8c54fc-f083-4870-8df0-\
be86fd1e7911"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pby", "[", 
    RowBox[{"x_", ",", "Pcoeffs_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Pcoeffs", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", 
       RowBox[{"maxorder", "[", "Pcoeffs", "]"}]}], "]"}], "]"}], ".", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
      RowBox[{
       RowBox[{"maxorder", "[", "Pcoeffs", "]"}], "-", "1"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.7392763243559313`*^9},
 CellLabel->
  "In[319]:=",ExpressionUUID->"8b20b395-c9f1-4828-9664-cdde048827a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pkby", "[", 
    RowBox[{"x_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Pcoeffs", "}"}], ",", 
     RowBox[{
      RowBox[{"Pcoeffs", "=", 
       RowBox[{
        RowBox[{"Inverse", "[", "LPs", "]"}], ".", 
        RowBox[{"wkd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"Pcoeffs", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"maxorder", "[", "Pcoeffs", "]"}]}], "]"}], "]"}], ".", 
       RowBox[{"NestList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
         RowBox[{
          RowBox[{"maxorder", "[", "Pcoeffs", "]"}], "-", "1"}]}], 
        "]"}]}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7832761735711946`*^9, 3.7832761931318903`*^9}, {
  3.7832762386144876`*^9, 3.7832762534338827`*^9}, {3.783276354301653*^9, 
  3.783276354546401*^9}, {3.785018461756366*^9, 3.7850184617592688`*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"100f8f09-9a0c-4129-a597-a77be23b0a8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regression functions", "Subsection",
 CellChangeTimes->{{3.783686555977028*^9, 3.783686562291398*^9}, {
  3.7836869188645353`*^9, 
  3.7836869199685*^9}},ExpressionUUID->"53172956-902f-4d24-afcb-3ea8dafacd7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Ridge", " ", "regression", " ", "with", " ", "regularization", " ", 
    "parameter", " ", "\"\<\[CapitalIHat]\[RightGuillemet]\>\"", " ", "and", 
    " ", "design", " ", "matrix", " ", "\"\<design\>\""}], "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"RidgeRegression", "[", 
     RowBox[{
     "design_", ",", " ", "response_", ",", " ", 
      "\[CapitalIHat]\[RightGuillemet]_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cross", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"cross", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "design", "]"}], ".", "design"}]}], ";", 
       "\n", "  ", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cross", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "+=", " ", 
          RowBox[{"\[CapitalIHat]\[RightGuillemet]", "^", "2"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "cross", "]"}]}], "}"}]}], "]"}], ";", "\n",
        "  ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"cross", ",", "\n", "   ", 
         RowBox[{
          RowBox[{"Transpose", "[", "design", "]"}], ".", "response"}], ",", 
         "\n", "   ", 
         RowBox[{"Method", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"\"\<Krylov\>\"", ",", " ", 
            RowBox[{
            "\"\<Method\>\"", " ", "->", " ", "\"\<ConjugateGradient\>\""}], 
            ",", " ", "\n", "     ", 
            RowBox[{
            "\"\<Preconditioner\>\"", " ", "->", " ", "\"\<ILU0\>\""}]}], 
           "}"}]}]}], "]"}]}]}], "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Ordinary", " ", "least", " ", "square", " ", "regression"}], 
    "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"OrdinaryRegression", "[", 
     RowBox[{"design_", ",", " ", "response_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cross", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"cross", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "[", "design", "]"}], ".", "design"}]}], ";", 
       "\n", "  ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"cross", ",", " ", 
         RowBox[{
          RowBox[{"Transpose", "[", "design", "]"}], ".", "response"}], ",", 
         " ", 
         RowBox[{"Method", " ", "->", " ", "\"\<Krylov\>\""}]}], "]"}]}]}], 
     "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Build", " ", "design", " ", "vector", " ", "for", " ", "a", " ", 
     "sequence", " ", "using", " ", "the", " ", "Taylor", " ", "encoding"}], 
    "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"s2dTaylor", "[", 
     RowBox[{"seq_", ",", " ", "order_", ",", " ", "wt_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "seqprime", ",", " ", "sub1", ",", " ", "sub2", ",", " ", "pos"}], 
       "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"seqprime", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"seq", " ", "-", " ", "wt"}], ",", " ", "alpha"}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"sub1", " ", "=", " ", 
        RowBox[{"Subsets", "[", 
         RowBox[{"seqprime", ",", " ", 
          RowBox[{"{", "order", "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"sub2", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", " ", 
            RowBox[{"sub1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "sub1", "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", "\n", "  ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rest", "[", "#", "]"}], " ", "-", " ", "1"}], ",", " ", 
             RowBox[{"alpha", " ", "-", " ", "1"}]}], "]"}], " ", "+", " ", 
           "\n", "      ", "1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "order"}], 
             ")"}]}]}], " ", "&"}], " ", "/@", " ", "\n", "    ", 
         RowBox[{"Select", "[", 
          RowBox[{"sub2", ",", " ", 
           RowBox[{
            RowBox[{"!", " ", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", " ", "0"}], "]"}]}], " ", "&"}]}], "]"}]}]}], 
       ";", "\n", "  ", 
       RowBox[{"SparseArray", "[", "\n", "   ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "->", " ", "1"}], ",", " ", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "\n", "     ", 
             RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ",", " ", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{"l", ",", " ", "order"}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "order"}]}], 
          "}"}]}], "]"}]}]}], "\n", "  ", "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Build", " ", "design", " ", "vector", " ", "for", " ", "sequence", " ", 
      "using", " ", "the", " ", "one"}], "-", 
     RowBox[{"hot", " ", "encoding"}]}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"s2d", "[", 
     RowBox[{"seq_", ",", " ", "order_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sub1", ",", " ", "sub2", ",", " ", "pos"}], "}"}], ",", "\n", 
      "  ", 
      RowBox[{
       RowBox[{"sub1", " ", "=", " ", 
        RowBox[{"Subsets", "[", 
         RowBox[{"seq", ",", " ", 
          RowBox[{"{", "order", "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"sub2", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", " ", 
            RowBox[{"sub1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "sub1", "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", "\n", "  ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{"Rest", "[", "#", "]"}], ",", " ", "alpha"}], "]"}], " ",
            "+", " ", "\n", "      ", "1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{"alpha", "^", "order"}], ")"}]}]}], " ", "&"}], " ", "/@",
          " ", "sub2"}]}], ";", "\n", "  ", 
       RowBox[{"SparseArray", "[", "\n", "   ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "->", " ", "1"}], ",", " ", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "\n", "     ", 
             RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], ",", " ", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{"l", ",", " ", "order"}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", "alpha", ")"}], "^", "order"}]}], "}"}]}], "]"}]}]}],
      "\n", "  ", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"designrules", "[", 
     RowBox[{"seq_", ",", " ", "order_", ",", " ", "wt_", ",", "j_"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "seqprime", ",", " ", "sub1", ",", " ", "sub2", ",", " ", "pos"}], 
       "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"seqprime", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"seq", " ", "-", " ", "wt"}], ",", " ", "alpha"}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"sub1", " ", "=", " ", 
        RowBox[{"Subsets", "[", 
         RowBox[{"seqprime", ",", " ", 
          RowBox[{"{", "order", "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"sub2", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", " ", 
            RowBox[{"sub1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "sub1", "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", "\n", "  ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rest", "[", "#", "]"}], " ", "-", " ", "1"}], ",", " ", 
             RowBox[{"alpha", " ", "-", " ", "1"}]}], "]"}], " ", "+", " ", 
           "\n", "      ", "1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], ")"}], 
            "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "order"}], 
             ")"}]}], "+", " ", 
           RowBox[{"Total", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Binomial", "[", 
                RowBox[{"l", ",", "k"}], "]"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], "^", 
                RowBox[{"(", "k", ")"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "0", ",", 
                RowBox[{"order", "-", "1"}]}], "}"}]}], "]"}]}]}], "&"}], " ",
          "/@", " ", "\n", "    ", 
         RowBox[{"Select", "[", 
          RowBox[{"sub2", ",", " ", 
           RowBox[{
            RowBox[{"!", " ", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", " ", "0"}], "]"}]}], " ", "&"}]}], "]"}]}]}], 
       ";", "\n", "  ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"pos", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], " ", "->", " ", "1"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "\n", "     ", 
           RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}]}]}], "\n", 
     "  ", "]"}]}], "\n", 
   RowBox[{
    RowBox[{"s2dTaylor2", "[", 
     RowBox[{"seqs_", ",", "order_", ",", "wt_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"designrules", "[", 
                RowBox[{
                 RowBox[{"seqs", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "k", ",", "wt", ",", 
                 "j"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "order"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "seqs", "]"}]}], "}"}]}], "]"}], ",", 
          "2"}], "]"}]}], ";", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"rules", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "seqs", "]"}], ",", 
           RowBox[{"Total", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Binomial", "[", 
                RowBox[{"l", ",", " ", "k"}], "]"}], "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"alpha", " ", "-", " ", "1"}], ")"}], "^", "k"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "order"}], "}"}]}], "]"}]}]}], "}"}]}], 
        "]"}]}]}], "]"}]}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.785018461771922*^9, 3.78501846177962*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"5cc24969-21b3-4336-a3ec-d5caf85c5fe0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kernelized regressions", "Subsection",
 CellChangeTimes->{{3.7836869114185877`*^9, 
  3.783686914475037*^9}},ExpressionUUID->"23ae7f70-c839-4d45-8d28-\
a8b790d3a79e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CIby", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"-", "alpha"}], "/", "2"}], ",", 
      RowBox[{"1", "/", "2"}]}], "}"}], ".", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", "2"}], "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Similar", " ", "to", " ", 
     RowBox[{"C", ".", "f"}]}], ",", " ", 
    RowBox[{
    "we", " ", "implement", " ", "multiplication", " ", "by", " ", "a", " ", 
     "matrix", " ", "that", " ", "can", " ", "be", " ", "expressed", " ", 
     "as", " ", "a", " ", "polynomial", " ", "in", " ", "L", " ", "using", 
     " ", 
     RowBox[{"NestList", "."}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"coeffsinLn", ":", " ", 
    RowBox[{"vector", " ", "of", " ", "coefficients", " ", "for", " ", 
     RowBox[{"L", "^", "n"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SprsinLnBy", "[", 
    RowBox[{"x_", ",", "coeffsinLn_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"coeffsinLn", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", 
       RowBox[{"maxorder", "[", "coeffsinLn", "]"}]}], "]"}], "]"}], ".", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
      RowBox[{
       RowBox[{"maxorder", "[", "coeffsinLn", "]"}], "-", "1"}]}], "]"}]}]}], 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Apply", " ", "the", " ", "locally", " ", "non"}], "-", 
    RowBox[{
    "epistatic", " ", "smoother", " ", "M", " ", "to", " ", "a", " ", 
     "vector"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Smooth", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{"l", ",", "2"}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"alpha", "-", "1"}], ")"}], "^", "2"}]}], ")"}]}], 
       ")"}]}], 
     RowBox[{"CIby", "[", "x", "]"}]}], "+", "x"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "the", " ", "average", " ", "squared", " ", "epistasic", 
    " ", "coefficient", " ", "for", " ", "a", " ", "vector", " ", "x"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cnorm", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"(", "nfaces", ")"}]}], ")"}], 
   RowBox[{"x", ".", 
    RowBox[{"CIby", "[", "x", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.785018538945465*^9, 3.785018550834106*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"0fb3cd10-da75-4073-aa3f-bcd0c03af95f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Multiplication", " ", "by", " ", "the", " ", "C", " ", "matrix", " ", 
     "defined", " ", "in", " ", "the", " ", "main", " ", 
     RowBox[{"text", ".", " ", "For"}], " ", "the", " ", "matrix", " ", "by", 
     " ", "vector", " ", "multiplication", " ", 
     RowBox[{"C", ".", "f"}]}], ",", " ", 
    RowBox[{"we", " ", "evaluate", " ", "it", " ", "as", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "alpha"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], ".", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"L", ".", "f"}], ",", 
        RowBox[{"L", ".", "L", ".", "f"}]}], "}"}]}], " ", "using", " ", 
     "the", " ", "function", " ", 
     RowBox[{"NestList", ".", " ", "Note"}], " ", "that", " ", "we", " ", 
     "have", " ", "omitted", " ", "the", " ", "constant", " ", 
     RowBox[{"1", "/", "s"}]}], ",", " ", 
    RowBox[{
    "since", " ", "it", " ", "does", " ", "not", " ", "affect", " ", "the", 
     " ", "solution", " ", "to", " ", "the", " ", "linear", " ", 
     "equation"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Minimum", " ", "epistasis", " ", "interpolation", " ", "solver"}],
    "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Cinterp", "[", 
     RowBox[{"training_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ai", ",", "Ab"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Ai", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"alpha", "^", "l"}]}], "]"}], ",", "training"}], 
               "]"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{
                 RowBox[{"alpha", "^", "l"}], "-", 
                 RowBox[{"Length", "[", "training", "]"}]}]}], "]"}]}], "}"}],
             "]"}], "->", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"alpha", "^", "l"}], ",", 
            RowBox[{
             RowBox[{"alpha", "^", "l"}], "-", 
             RowBox[{"Length", "[", "training", "]"}]}]}], "}"}]}], "]"}]}], 
       ";", 
       RowBox[{"Ab", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"training", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "training", "]"}]}], "]"}]}], "}"}], 
            "]"}], "->", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"alpha", "^", "l"}], ",", 
            RowBox[{"Length", "[", "training", "]"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ai", ".", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "Ai", "]"}], ".", 
              RowBox[{"CIby", "[", 
               RowBox[{"Ai", ".", "#"}], "]"}]}], "&"}], ",", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"Transpose", "[", "Ai", "]"}], ".", 
              RowBox[{"CIby", "[", 
               RowBox[{"Ab", ".", "y"}], "]"}]}]}], ",", 
            RowBox[{"Method", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<Krylov\>\"", ",", 
               RowBox[{"Method", "->", "\"\<ConjugateGradient\>\""}], ",", 
               RowBox[{"Tolerance", "->", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "15"}]}]}]}], "}"}]}]}], "]"}]}], ")"}], "+", 
        RowBox[{"Ab", ".", "y"}]}]}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "Regularized", " ", "regression", " ", "with", " ", "regularization", " ",
      "parameter", " ", "given", " ", "by", " ", 
     RowBox[{"\"\<rp\>\"", ".", " ", "\"\<Ccoeffs\>\""}], " ", "and", " ", 
     "\"\<Pcoeffs\>\"", " ", "contain", " ", "entries", " ", "for", " ", "a", 
     " ", "general", " ", "cost", " ", "matrix", " ", "C", " ", 
     RowBox[{"(", 
      RowBox[{
      "not", " ", "necessarily", " ", "the", " ", "C", " ", "used", " ", "in",
        " ", "the", " ", "minimum", " ", "epistasis", " ", "interpolation", 
       " ", "problem"}], ")"}], " ", "and", " ", "projection", " ", "matrix", 
     " ", "P", " ", "each", " ", "of", " ", "which", " ", "is", " ", 
     "represented", " ", "as", " ", "the", " ", "coefficients", " ", "of", 
     " ", "a", " ", "polynomial", " ", "in", " ", 
     RowBox[{"L", ".", " ", "\"\<Ccoeffs\>\""}], " ", "and", " ", 
     "\"\<Pcoeffs\>\"", " ", "for", " ", "fitting", " ", "models", " ", "of", 
     " ", "different", " ", "orders", " ", "are", " ", "defined", " ", 
     "below"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Creg", "[", 
     RowBox[{
     "Ccoeffs_", ",", "Pcoeffs_", ",", "training_", ",", "data_", ",", "rp_", 
      ",", "var_", ",", "startingvector_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ab", ",", "W", ",", "Cby", ",", "Pby"}], "}"}], ",", 
      RowBox[{
       RowBox[{"W", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Length", "[", "data", "]"}]}], ")"}], " ", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"training", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"training", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "->", 
              RowBox[{"(", 
               RowBox[{"1", "/", 
                RowBox[{"var", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "training", "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"alpha", "^", "l"}], ",", 
             RowBox[{"alpha", "^", "l"}]}], "}"}]}], "]"}]}]}], ";", 
       RowBox[{"Ab", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"training", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "training", "]"}]}], "]"}]}], "}"}], 
            "]"}], "->", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"alpha", "^", "l"}], ",", 
            RowBox[{"Length", "[", "training", "]"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"Cby", "[", "x_", "]"}], ":=", 
        RowBox[{"rp", "*", 
         RowBox[{
          RowBox[{"Ccoeffs", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"maxorder", "[", "Ccoeffs", "]"}]}], "]"}], "]"}], ".", 
          RowBox[{"NestList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
            RowBox[{
             RowBox[{"maxorder", "[", "Ccoeffs", "]"}], "-", "1"}]}], 
           "]"}]}]}]}], ";", 
       RowBox[{
        RowBox[{"Pby", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"Pcoeffs", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"maxorder", "[", "Pcoeffs", "]"}]}], "]"}], "]"}], ".", 
         RowBox[{"NestList", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"L", ".", "#"}], "&"}], ",", "x", ",", 
           RowBox[{
            RowBox[{"maxorder", "[", "Pcoeffs", "]"}], "-", "1"}]}], 
          "]"}]}]}], ";", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cby", "[", "#", "]"}], "+", 
            RowBox[{"Pby", "[", 
             RowBox[{"W", ".", 
              RowBox[{"Pby", "[", "#", "]"}]}], "]"}]}], ")"}], "&"}], ",", 
         RowBox[{"Pby", "[", 
          RowBox[{"W", ".", "Ab", ".", "data"}], "]"}], ",", 
         RowBox[{"Method", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<Krylov\>\"", ",", 
            RowBox[{"Method", "->", "\"\<ConjugateGradient\>\""}], ",", 
            RowBox[{"\"\<StartingVector\>\"", "->", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "startingvector", "]"}], "==", "0"}], 
               ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"alpha", "^", "l"}]}], "]"}], ",", 
               "startingvector"}], "]"}]}]}], "}"}]}]}], "]"}]}]}], "]"}]}], 
   "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"10", "-", 
     RowBox[{
     "fold", " ", "crossvalidation", " ", "using", " ", "the", " ", 
      "function", " ", "Creg"}]}], "*)"}], 
   RowBox[{
    RowBox[{"CrossvalidationC", "[", 
     RowBox[{
     "Ccoeffs_", ",", "Pcoeffs_", ",", "list_", ",", "response_", ",", "rps_",
       ",", "variance_", ",", "fold_", ",", "rep_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"size", ",", "subsets", ",", "r", ",", "rpsr"}], "}"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{"size", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{
          RowBox[{"Length", "[", "response", "]"}], "/", "fold"}], "]"}]}], 
       ";", " ", "\n", 
       RowBox[{"subsets", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"RandomSample", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "response", "]"}]}], "]"}], "]"}], ",", 
          "size", ",", "size", ",", "1", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", 
       RowBox[{"r", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "rps", "]"}], "+", "1"}]}], "]"}], ",", 
          "rep"}], "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Creg", "[", 
             RowBox[{"Ccoeffs", ",", "Pcoeffs", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"subsets", ",", 
                   RowBox[{"{", "k", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"response", "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"subsets", ",", 
                   RowBox[{"{", "k", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"rps", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"variance", "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"subsets", ",", 
                   RowBox[{"{", "k", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "rps", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "rep"}], "}"}]}], "]"}], ";", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"mse", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"subsets", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], "]"}], 
           ",", 
           RowBox[{"response", "[", 
            RowBox[{"[", 
             RowBox[{"subsets", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], "]"}], "\n", 
         ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "rep"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "rps", "]"}]}], "}"}]}], "]"}]}]}], "\n", 
     "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Extract", " ", "best", " ", "regularization", " ", "parameter", " ", 
     "from", " ", "the", " ", "crossvalidation", " ", "outputs"}], "*)"}], 
   RowBox[{
    RowBox[{"CV", "[", 
     RowBox[{"mse_", ",", "rps_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"means", ",", "ses", ",", "min", ",", "bestlambda"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"means", "=", 
        RowBox[{"Mean", "[", "mse", "]"}]}], ";", 
       RowBox[{"ses", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "mse", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "1"}], ",", 
          RowBox[{
           RowBox[{"StandardDeviation", "[", "mse", "]"}], "/", 
           SqrtBox[
            RowBox[{
             RowBox[{"Dimensions", "[", "mse", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]]}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "mse", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       RowBox[{"min", "=", 
        RowBox[{"First", "[", 
         RowBox[{"Ordering", "[", "means", "]"}], "]"}]}], ";", 
       RowBox[{"bestlambda", "=", 
        RowBox[{"rps", "[", 
         RowBox[{"[", "min", " ", "]"}], "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"bestlambda", ",", "means", ",", "ses"}], "}"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7837004472487507`*^9, 3.783700448186143*^9}, {
   3.78501846185739*^9, 3.785018462051797*^9}, 3.785018497034924*^9},
 CellLabel->
  "In[331]:=",ExpressionUUID->"f3ada5ae-4744-44aa-9a60-73cc15cb17fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix coefficients", "Subsection",
 CellChangeTimes->{{3.7836865046179857`*^9, 
  3.783686514734417*^9}},ExpressionUUID->"fccc6f40-a702-4436-8a48-\
7c22e5bdfe7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Krawtchouk", " ", "polynomial"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"alpha_", ",", " ", "k_", ",", " ", "d_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{"alpha", "^", 
      RowBox[{"(", 
       RowBox[{"-", "l"}], ")"}]}], " ", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"q", "=", "0"}], 
       RowBox[{"Min", "[", 
        RowBox[{"k", ",", "d"}], "]"}]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "q"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"alpha", "-", "1"}], ")"}], 
        RowBox[{"k", "-", "q"}]], 
       RowBox[{"Binomial", "[", 
        RowBox[{"d", ",", "q"}], "]"}], 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"l", "-", "d"}], ",", 
         RowBox[{"k", "-", "q"}]}], "]"}]}]}]}]}], "\n", 
   RowBox[{
    RowBox[{"wkd", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"alpha", ",", "k", ",", "d"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7836869289740562`*^9, 3.783686929363192*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"d2ba0fac-69ec-42c4-b045-7bd83b7ad0d0"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"LPs", " ", "contains", " ", "entries", " ", "of", " ", 
      RowBox[{"L", "^", "n"}], " ", "defined", " ", "at", " ", "d"}], "=", 
     "0"}], ",", "1", ",", 
    RowBox[{
     RowBox[{"...", 
      RowBox[{"l", ".", " ", "For"}], " ", "any", " ", "matrix", " ", "whose",
       " ", 
      RowBox[{"(", 
       RowBox[{"i", ",", "j"}], ")"}]}], "-", 
     RowBox[{
     "th", " ", "entry", " ", "only", " ", "depends", " ", "on", " ", "d", 
      RowBox[{"(", 
       RowBox[{"i", ",", "j"}], ")"}]}]}], ",", " ", 
    RowBox[{
    "we", " ", "can", " ", "then", " ", "solve", " ", "a", " ", "linear", " ",
      "equation", " ", "for", " ", "the", " ", "coefficients"}]}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"B", "=", 
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", "-", "1"}], ")"}], "*", "l"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"l", "+", "1"}], ",", 
          RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], "-", 
      RowBox[{"1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
             RowBox[{"i", "\[Equal]", "j"}]}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"alpha", "-", "2"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", 
             RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], "+", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
             RowBox[{
              RowBox[{"i", "-", "j"}], "\[Equal]", "1"}]}], "\[RuleDelayed]", 
            
            RowBox[{"i", "-", "1"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", 
             RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], "+", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
             RowBox[{
              RowBox[{"i", "-", "j"}], "\[Equal]", 
              RowBox[{"-", "1"}]}]}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "-", "j", "+", "2"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"alpha", "-", "1"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", 
             RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LPs", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"l", "+", "1"}]}], "]"}], ",", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"alpha", "-", "1"}], ")"}], "*", "l"}], ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"l", "+", "1"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixPower", "[", 
              RowBox[{"B", ",", "i"}], "]"}], ".", 
             RowBox[{"PadRight", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"alpha", "-", "1"}], ")"}], "*", "l"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"l", "+", "1"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"l", "+", "1"}], ",", 
          RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], "//", "Transpose"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Entries", " ", "of", " ", "the", " ", "pseudo"}], "-", 
     RowBox[{
     "inverse", " ", "of", " ", "the", " ", "interpolation", " ", "matrix", 
      " ", "C"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KIentries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "2"}], "length"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], "  ", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"a", " ", "k"}], ")"}], "2"], "-", 
                 RowBox[{"a", 
                  RowBox[{"(", 
                   RowBox[{"a", " ", "k"}], ")"}]}]}], ")"}], 
               SuperscriptBox["a", "length"]}]], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for", 
     " ", "pairwise", " ", "regression"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"C2entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "2"}], "2"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], "  ", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for",
       " ", "three"}], "-", 
     RowBox[{"way", " ", "regression"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C3entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "2"}], "3"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], "  ", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for", 
     " ", "the", " ", "Additive", " ", "model"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P1entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "0"}], "1"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for", 
     " ", "the", " ", "Pairwise", " ", "model"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P2entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "0"}], "2"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Entries", " ", "of", " ", "the", " ", "cost", " ", "matrix", " ", "for",
       " ", "the", " ", "Three"}], "-", 
     RowBox[{"way", " ", "model"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P3entries", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"k", "=", "0"}], "3"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["alpha", 
              RowBox[{"(", 
               RowBox[{"-", "l"}], ")"}]], 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "0"}], 
               RowBox[{"Min", "[", 
                RowBox[{"k", ",", "d"}], "]"}]], 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "q"], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"alpha", "-", "1"}], ")"}], 
                RowBox[{"k", "-", "q"}]], 
               RowBox[{"Binomial", "[", 
                RowBox[{"d", ",", "q"}], "]"}], 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"l", "-", "d"}], ",", 
                 RowBox[{"k", "-", "q"}]}], "]"}]}]}]}], ")"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"length", "\[Rule]", "l"}], ",", 
           RowBox[{"a", "\[Rule]", "alpha"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "interpolation", " ", 
     "matrix", " ", "C", " ", "in", " ", "L"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CIinLn", "=", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "alpha"}], "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}]}], "}"}], ",", 
       RowBox[{"l", "+", "1"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "interpolation", " ", 
     "kernel", " ", "matrix", " ", "K", " ", "in", " ", "L"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KIinLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "KIentries"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "cost", " ", "matrix", " ", 
     "for", " ", "the", " ", "Pairwise", " ", "model", " ", "in", " ", "L"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C2inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "C2entries"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Coefficients", " ", "for", " ", "the", " ", "cost", " ", "matrix", " ", 
      "for", " ", "the", " ", "Three"}], "-", 
     RowBox[{"way", " ", "model", " ", "in", " ", "L"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C3inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "C3entries"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Coefficients", " ", "for", " ", "the", " ", "projection", " ", "matrix",
       " ", "for", " ", "the", " ", "Three"}], "-", 
     RowBox[{"way", " ", "model", " ", "in", " ", "L"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P3inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "P3entries"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "projection", " ", "matrix", 
     " ", "for", " ", "the", " ", "Pairwise", " ", "model", " ", "in", " ", 
     "L"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P2inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "P2entries"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coefficients", " ", "for", " ", "the", " ", "projection", " ", "matrix", 
     " ", "for", " ", "the", " ", "Additive", " ", "model", " ", "in", " ", 
     "L"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"P1inLn", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "LPs", "]"}], ".", "P1entries"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellLabel->
  "In[337]:=",ExpressionUUID->"ceb50137-4fbd-4778-b89e-82abccde9726"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Build matrices", "Subsection",
 CellChangeTimes->{{3.7836861789098473`*^9, 
  3.7836861805844584`*^9}},ExpressionUUID->"ee0ebf8d-865a-40a2-85c5-\
9f1907195673"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Build", " ", "graph", " ", "Laplacian", " ", "of", " ", "the", " ", 
     "sequence", " ", 
     RowBox[{"space", ".", " ", "L"}], " ", "is", " ", "a", " ", "sparse", 
     " ", "matrix", " ", "with", " ", "sparsity"}], " ", "=", " ", 
    RowBox[{"1", " ", "-", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", "-", "1"}], ")"}], "l"}], "+", "1"}], ")"}], "/", 
       
       RowBox[{
        RowBox[{"(", 
         RowBox[{"alpha", "^", "l"}], ")"}], ".", " ", "Therefore"}]}], " ", 
      RowBox[{"we", "'"}], "ll", " ", "use", " ", "it", " ", "to", " ", 
      "facilitate", " ", "fast", " ", "solution", " ", "of", " ", "most", " ",
       "linear", " ", "equations", " ", "in", " ", "this", " ", 
      "notebook"}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"MakeLaplacian", "[", 
    RowBox[{"A_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "i"}], "}"}], "->", 
         RowBox[{"l", 
          RowBox[{"(", 
           RowBox[{"A", "-", "1"}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"A", "^", "l"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"FromDigits", "[", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "A", ",", "l"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"-", "k"}], "->", "alt"}]}], "]"}], ",", "A"}], 
               "]"}], "+", "1"}]}], "}"}], "->", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"A", "^", "l"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "l"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"alt", ",", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"A", "-", "1"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "A", ",", "l"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "k"}], "]"}], "]"}], "}"}]}], "]"}]}], "}"}]}], 
         "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.785018462180134*^9, 3.785018462190578*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"cfb3bb97-0353-4da4-a1d8-1e0ca7fdc894"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"L", "=", 
     RowBox[{"MakeLaplacian", "[", 
      RowBox[{"alpha", ",", "l"}], "]"}]}], ";"}], "]"}], "*)"}]], "Input",
 CellLabel->
  "In[353]:=",ExpressionUUID->"c7203ad3-ba53-4a97-80a6-61db050a8c70"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"MakeAdj", "[", 
    RowBox[{"A_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "A", ",", "l"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"-", "k"}], "->", "alt"}]}], "]"}], ",", "A"}], 
             "]"}], "+", "1"}]}], "}"}], "->", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"A", "^", "l"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "l"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"alt", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"A", "-", "1"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "A", ",", "l"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "k"}], "]"}], "]"}], "}"}]}], "]"}]}], "}"}]}], 
       "]"}], ",", "2"}], "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.73888181943016*^9, 3.738881847259314*^9}, {
   3.738881904602605*^9, 3.7388819047778797`*^9}, 3.738881967991172*^9, {
   3.785018462199798*^9, 3.7850184622063217`*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"68f32206-4076-4648-9ac5-194e47c3a5f8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Adj", "=", 
     RowBox[{"MakeAdj", "[", 
      RowBox[{"alpha", ",", "l"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.738881972238666*^9, 3.738882007258684*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"4a78dfcf-d9e0-4dc9-8a80-70c425aed3c5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Adj", " ", "=", " ", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"L", " ", "-", " ", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", "-", "1"}], ")"}], "*", "l"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"alpha", "^", "l"}]}], "}"}]}], "]"}], ",", "2"}], 
         "]"}], "]"}]}], ")"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.858673114922086*^9, 3.8586732039972153`*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"6ccfe432-d605-4b5a-a030-6d4f0968a37b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"null", " ", "=", " ", 
     RowBox[{"Table", "[", "\n", "   ", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"s2dTaylor", "[", 
          RowBox[{
           RowBox[{"sequences", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "0", ",", " ", "wt"}], 
          "]"}], ",", " ", "\n", "    ", 
         RowBox[{"s2dTaylor", "[", 
          RowBox[{
           RowBox[{"sequences", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "1", ",", " ", "wt"}], 
          "]"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"Length", "[", "sequences", "]"}]}], "}"}]}], "]"}]}], ";"}],
    "//", "AbsoluteTiming"}], "*)"}]], "Input",
 CellChangeTimes->{{3.783291500319695*^9, 3.783291505408485*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"9bdd879d-733a-4ceb-baf1-1efa074392f0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"null2", "=", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"s2dTaylor", "[", 
           RowBox[{"seq", ",", "0", ",", "wt"}], "]"}], ",", 
          RowBox[{"s2dTaylor", "[", 
           RowBox[{"seq", ",", "1", ",", "wt"}], "]"}], ",", 
          RowBox[{"s2dTaylor", "[", 
           RowBox[{"seq", ",", "2", ",", "wt"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"seq", ",", "sequences"}], "}"}]}], "]"}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.783267830897606*^9, {3.7832914179990473`*^9, 3.783291431980976*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"c2530ef8-12d8-454d-b5c1-c156bbba6fd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"designrulesonehot", "[", 
   RowBox[{"seq_", ",", " ", "order_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{"sub1", ",", " ", "sub2", ",", " ", "pos"}], "}"}], ",", "\n", 
    "\n", "  ", 
    RowBox[{
     RowBox[{"sub1", " ", "=", " ", 
      RowBox[{"Subsets", "[", 
       RowBox[{"seq", ",", " ", 
        RowBox[{"{", "order", "}"}]}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"sub2", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "i", "}"}], ",", " ", 
          RowBox[{"sub1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", "sub1", "]"}]}], "}"}]}], "]"}]}], ";", " ", 
     "\n", "  ", 
     RowBox[{"pos", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FromDigits", "[", 
          RowBox[{
           RowBox[{"Rest", "[", "#", "]"}], " ", ",", " ", "alpha"}], " ", 
          "]"}], " ", "+", " ", "\n", "      ", "1", " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], " ", ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", "alpha", " ", ")"}], "^", "order"}], ")"}]}], "+", 
         " ", 
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{"l", ",", "k"}], "]"}], 
             RowBox[{
              RowBox[{"(", "alpha", ")"}], "^", 
              RowBox[{"(", "k", ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"order", "-", "1"}]}], "}"}]}], "]"}]}]}], "&"}], " ", "/@",
        " ", "\n", "    ", "sub2"}]}], ";", "\n", "  ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"pos", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], " ", "->", " ", "1"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "\n", "     ", 
         RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}]}]}], "\n", 
   "  ", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"s2donehot", "[", 
   RowBox[{"seqs_", ",", "order_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "rules", "}"}], ",", 
    RowBox[{
     RowBox[{"rules", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"designrulesonehot", "[", 
              RowBox[{
               RowBox[{"seqs", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "k", ",", "j"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "order"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "seqs", "]"}]}], "}"}]}], "]"}], ",", 
        "2"}], "]"}]}], ";", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"rules", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "seqs", "]"}], ",", 
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{"l", ",", " ", "k"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"alpha", " ", "^", "k"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "order"}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.785257164975732*^9, 3.785257165156413*^9}, {
   3.7852572616506367`*^9, 3.785257262300872*^9}, {3.7852573022902603`*^9, 
   3.7852573814812927`*^9}, {3.7852574598940077`*^9, 3.78525746923743*^9}, {
   3.785257644843088*^9, 3.785257646286978*^9}, {3.785257739293095*^9, 
   3.7852577410231333`*^9}, 3.7873347600022287`*^9},
 CellLabel->
  "In[359]:=",ExpressionUUID->"a5ecd0ff-4b39-49f3-90dc-529cb37be6b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"designrulesonehot", "[", 
            RowBox[{
             RowBox[{"sequences", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", "k", ",", "j"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", " ", "1"}], "}"}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "sequences", "]"}]}], "}"}]}], "]"}], ",", 
      "2"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{3.860056917425178*^9},
 CellLabel->
  "In[361]:=",ExpressionUUID->"2fe95719-6a7c-4395-ab71-ec6eedc032b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.302934`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.860057080232312*^9, 3.860615008363172*^9, 
  3.860616301891281*^9, 3.8608720828170958`*^9, 3.860874587594965*^9, 
  3.860875811721603*^9, 3.8610460569096727`*^9, 3.861720288214199*^9, 
  3.8618048272243567`*^9, 3.861882724247613*^9, 3.863694119352211*^9, 
  3.863725477688137*^9, 3.864591124812258*^9, 3.865370970828382*^9, 
  3.8656115613022346`*^9},
 CellLabel->
  "Out[361]=",ExpressionUUID->"3b1b5b42-d5ec-49fa-98e7-53bbf8f7b0ca"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nullonehot", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"rules", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "sequences", "]"}], ",", 
       RowBox[{"Total", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{"l", ",", " ", "k"}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", "alpha", ")"}], "^", "k"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.8600569687662287`*^9},
 CellLabel->
  "In[362]:=",ExpressionUUID->"be3ca3ef-a590-4002-b8ac-e3d44fcb9f4b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Simulate", "Section",
 CellChangeTimes->{{3.858672469023692*^9, 3.858672477042664*^9}, {
   3.859631604998*^9, 3.859631607964817*^9}, {3.8607699723099003`*^9, 
   3.86076997563197*^9}, 
   3.863525264629551*^9},ExpressionUUID->"4ef02cac-1e69-4e1d-9e36-\
d1be7cd31bdb"],

Cell[CellGroupData[{

Cell["Well defined random field with exponential lambdas", "Subsection",
 CellChangeTimes->{{3.860872999147511*^9, 
  3.860873011980501*^9}},ExpressionUUID->"d383af68-d841-4e8e-bc72-\
c2e57e194a20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nrep", "=", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.864682735027627*^9, 3.864682736863531*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"c1e9e82b-2193-4613-8e4d-2d6cceb29213"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lambdas", "=", 
   RowBox[{"Nbyfirst", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"l", "-", "i"}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"alpha", "-", "1"}], ")"}], "*", ".5"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"l", "-", "i"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{3.865371037492432*^9},
 CellLabel->
  "In[364]:=",ExpressionUUID->"4156d6c4-2c5a-4bc5-bf26-d744562c286f"],

Cell[CellGroupData[{

Cell[BoxData["lambdas"], "Input",
 CellChangeTimes->{{3.86561145522799*^9, 3.865611455886537*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"e7fa40ff-baa2-4545-9477-3cc4efc93a7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "0.3333333333333333`", ",", "0.1111111111111111`", ",", 
   "0.037037037037037035`", ",", "0.012345679012345678`", ",", 
   "0.00411522633744856`", ",", "0.0013717421124828531`", ",", 
   "0.0004572473708276177`", ",", "0.00015241579027587258`", ",", 
   "0.00005080526342529086`", ",", "0.000016935087808430286`", ",", 
   "5.645029269476762`*^-6", ",", "1.8816764231589208`*^-6", ",", 
   "6.272254743863069`*^-7", ",", "2.0907515812876897`*^-7", ",", 
   "6.969171937625632`*^-8"}], "}"}]], "Output",
 CellChangeTimes->{3.865611456212027*^9, 3.865611572108679*^9},
 CellLabel->
  "Out[365]=",ExpressionUUID->"96e22f32-4bcb-4175-b233-d6ed7f446568"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"b1h", "=", 
  RowBox[{"-", 
   RowBox[{"Log", "[", 
    RowBox[{"lambdas", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8656114481737747`*^9, 3.865611479203603*^9}, {
   3.8656115775143642`*^9, 3.865611579299938*^9}, 3.865611844288794*^9},
 CellLabel->
  "In[390]:=",ExpressionUUID->"003983c7-6b96-4b09-a74a-44c8f2280161"],

Cell[BoxData["1.0986122886681098`"], "Output",
 CellChangeTimes->{3.8656114794530983`*^9, 3.86561157954424*^9, 
  3.8656118446179543`*^9},
 CellLabel->
  "Out[390]=",ExpressionUUID->"a5c7e72b-654d-45b7-9139-b35dca180148"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"blist", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"3", "*", " ", "b1h"}], ",", " ", 
     RowBox[{"2", "*", "b1h"}], ",", " ", "b1h"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.865611585618416*^9, 3.865611609959208*^9}, {
  3.8656116742264233`*^9, 3.865611678188396*^9}, {3.865611722774981*^9, 
  3.86561172598125*^9}, {3.8656117692300253`*^9, 3.8656117698566093`*^9}, {
  3.865611835853795*^9, 3.8656118360032043`*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"400543bc-706e-4866-87ec-f3b1f866bd21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lambdaslist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Nbyfirst", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"b", "*", 
          RowBox[{"-", "k"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "blist"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.864591366486638*^9, 3.864591414886711*^9}, {
   3.864591523636272*^9, 3.864591526899741*^9}, 3.865611749326956*^9, 
   3.865611830491642*^9},
 CellLabel->
  "In[392]:=",ExpressionUUID->"191d32e5-3c55-4a80-8741-7146296f4d95"],

Cell[CellGroupData[{

Cell[BoxData["lambdaslist"], "Input",
 CellLabel->
  "In[393]:=",ExpressionUUID->"02fb049e-bb93-4e52-b7bc-9591de114fc4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "10"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "20"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "30"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "40"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "50"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "60"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "70"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "80"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "90"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "100"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "110"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "120"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "130"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "140"]], ",", 
     FractionBox["1", 
      SuperscriptBox["\[ExponentialE]", "150"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.037037037037037035`", ",", "0.001371742112482853`", ",", 
     "0.00005080526342529085`", ",", "1.8816764231589204`*^-6", ",", 
     "6.96917193762563`*^-8", ",", "2.5811747917131962`*^-9", ",", 
     "9.559906635974801`*^-11", ",", "3.5407061614721485`*^-12", ",", 
     "1.311372652397092`*^-13", ",", "4.856935749618858`*^-15", ",", 
     "1.798865092451429`*^-16", ",", "6.6624633053756624`*^-18", ",", 
     "2.4675790019909857`*^-19", ",", "9.139181488855503`*^-21", ",", 
     "3.3848820329094454`*^-22"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.11111111111111109`", ",", "0.01234567901234568`", ",", 
     "0.0013717421124828525`", ",", "0.00015241579027587242`", ",", 
     "0.000016935087808430286`", ",", "1.8816764231589197`*^-6", ",", 
     "2.090751581287687`*^-7", ",", "2.323057312541877`*^-8", ",", 
     "2.581174791713191`*^-9", ",", "2.867971990792437`*^-10", ",", 
     "3.1866355453249343`*^-11", ",", "3.5407061614721404`*^-12", ",", 
     "3.934117957191272`*^-13", ",", "4.371242174656974`*^-14", ",", 
     "4.856935749618848`*^-15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.33333333333333326`", ",", "0.1111111111111111`", ",", 
     "0.03703703703703702`", ",", "0.01234567901234567`", ",", 
     "0.004115226337448559`", ",", "0.0013717421124828527`", ",", 
     "0.00045724737082761745`", ",", "0.00015241579027587256`", ",", 
     "0.000050805263425290796`", ",", "0.000016935087808430272`", ",", 
     "5.645029269476761`*^-6", ",", "1.8816764231589183`*^-6", ",", 
     "6.272254743863064`*^-7", ",", "2.0907515812876894`*^-7", ",", 
     "6.969171937625622`*^-8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.865611727626005*^9, 3.865611772429845*^9}, {
  3.865611831648765*^9, 3.865611846734633*^9}},
 CellLabel->
  "Out[393]=",ExpressionUUID->"1922cdca-4c02-4de8-aedf-3816d0eca057"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"lambdaslist", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"lambdas", ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Thick"}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8645915321475897`*^9, 3.8645915762724257`*^9}, {
  3.864591998181877*^9, 3.8645920019776163`*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"449ef872-5214-434e-890c-6928c8723012"],

Cell[BoxData[
 GraphicsBox[{{{}, {{{}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
       LineBox[{{1., 1.}, {2., 0.000045399929762484854`}, {3., 
        2.061153622438558*^-9}, {4., 9.357622968840175*^-14}, {5., 
        4.248354255291589*^-18}, {6., 1.9287498479639178`*^-22}, {7., 
        8.75651076269652*^-27}, {8., 3.975449735908647*^-31}, {9., 
        1.8048513878454153`*^-35}, {10., 8.194012623990515*^-40}, {11., 
        3.720075976020836*^-44}, {12., 1.6889118802245324`*^-48}, {13., 
        7.667648073722*^-53}, {14., 3.4811068399043105`*^-57}, {15., 
        1.580420060273613*^-61}, {16., 7.175095973164411*^-66}}]}, 
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
       LineBox[{{1., 1.}, {2., 0.037037037037037035`}, {3., 
        0.001371742112482853}, {4., 0.00005080526342529085}, {5., 
        1.8816764231589204`*^-6}, {6., 6.96917193762563*^-8}, {7., 
        2.5811747917131962`*^-9}, {8., 9.559906635974801*^-11}, {9., 
        3.5407061614721485`*^-12}, {10., 1.311372652397092*^-13}, {11., 
        4.856935749618858*^-15}, {12., 1.798865092451429*^-16}, {13., 
        6.6624633053756624`*^-18}, {14., 2.4675790019909857`*^-19}, {15., 
        9.139181488855503*^-21}, {16., 3.3848820329094454`*^-22}}]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
       LineBox[{{1., 1.}, {2., 0.11111111111111109`}, {3., 
        0.01234567901234568}, {4., 0.0013717421124828525`}, {5., 
        0.00015241579027587242`}, {6., 0.000016935087808430286`}, {7., 
        1.8816764231589197`*^-6}, {8., 2.090751581287687*^-7}, {9., 
        2.323057312541877*^-8}, {10., 2.581174791713191*^-9}, {11., 
        2.867971990792437*^-10}, {12., 3.1866355453249343`*^-11}, {13., 
        3.5407061614721404`*^-12}, {14., 3.934117957191272*^-13}, {15., 
        4.371242174656974*^-14}, {16., 4.856935749618848*^-15}}]}, 
      {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
       LineBox[{{1., 1.}, {2., 0.33333333333333326`}, {3., 
        0.1111111111111111}, {4., 0.03703703703703702}, {5., 
        0.01234567901234567}, {6., 0.004115226337448559}, {7., 
        0.0013717421124828527`}, {8., 0.00045724737082761745`}, {9., 
        0.00015241579027587256`}, {10., 0.000050805263425290796`}, {11., 
        0.000016935087808430272`}, {12., 5.645029269476761*^-6}, {13., 
        1.8816764231589183`*^-6}, {14., 6.272254743863064*^-7}, {15., 
        2.0907515812876894`*^-7}, {16., 6.969171937625622*^-8}}]}}, {
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[
       1.6]}}, {
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[
       1.6]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}, {
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
      {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
        NCache[
         Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[
       1.6]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}}, {{}, \
{}}}, {{}, {{{}, {}, 
      {RGBColor[1, 0, 0], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
       LineBox[{{1., 1.}, {2., 0.3333333333333333}, {3., 
        0.1111111111111111}, {4., 0.037037037037037035`}, {5., 
        0.012345679012345678`}, {6., 0.00411522633744856}, {7., 
        0.0013717421124828531`}, {8., 0.0004572473708276177}, {9., 
        0.00015241579027587258`}, {10., 0.00005080526342529086}, {11., 
        0.000016935087808430286`}, {12., 5.645029269476762*^-6}, {13., 
        1.8816764231589208`*^-6}, {14., 6.272254743863069*^-7}, {15., 
        2.0907515812876897`*^-7}, {16., 6.969171937625632*^-8}}]}}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], Thickness[Large]}, {
      {RGBColor[1, 0, 0], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], Thickness[Large]}, {}}, {
      {RGBColor[1, 0, 0], PointSize[
        NCache[
         Rational[7, 360], 0.019444444444444445`]], Thickness[
       Large]}, {}}}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.6875, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0.6875, 16.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.864591537097473*^9, 3.8645915765734587`*^9}, 
   3.864591614521942*^9, {3.8645919918486967`*^9, 3.8645920023230047`*^9}, 
   3.864682696687498*^9, 3.8653710702719793`*^9, 3.865611682488369*^9, 
   3.865611728631082*^9, 3.865611777797133*^9, 3.8656118488087187`*^9},
 CellLabel->
  "Out[394]=",ExpressionUUID->"4e48e08c-dc2b-410a-b0e4-cbb060a96cd7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<data/tru_lda_\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"blist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<.tsv\>\""}], "]"}],
       ",", 
      RowBox[{
       RowBox[{"lambdaslist", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "//", "N"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "@", "blist"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8645916768536787`*^9, 3.864591756485127*^9}, {
  3.86459236602311*^9, 3.8645923665436583`*^9}, {3.864655773948613*^9, 
  3.864655774309367*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"b5cc81ce-95ea-4dfc-9236-ea523d3d3bd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VClist", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Nbysum", "[", 
       RowBox[{
        RowBox[{"Rest", "@", "mks"}], "*", 
        RowBox[{"lambdaslist", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "blist"}]}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8611001827608137`*^9, 3.861100243606514*^9}, 
   3.8618829267044687`*^9, {3.864591783229335*^9, 3.864591797098733*^9}, {
   3.864591852830655*^9, 3.86459185345984*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"5166016b-0a05-415f-b634-ab8b435c08a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{"VClist", ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "blist"}]}], "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.864591854406136*^9, 3.864591919365687*^9}, {
  3.864682714085177*^9, 3.864682715075652*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"463cfcc5-bf1a-4f23-b637-359554cdc94c"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[{{1., 0.9996595443253012}, {2., 0.0003403835482407472}, {3., 
         7.211581618469804*^-8}, {4., 1.064067221603607*^-11}, {5., 
         1.1594058509607876`*^-15}, {6., 9.650106436636187*^-20}, {7., 
         6.258773634625512*^-24}, {8., 3.1966636883770155`*^-28}, {9., 
         1.2900293949031313`*^-32}, {10., 4.099707074410009*^-37}, {11., 
         1.0152349812271455`*^-41}, {12., 1.9204832016720847`*^-46}, {13., 
         2.6827631527982977`*^-51}, {14., 2.6099412579948243`*^-56}, {15., 
         1.579881997295685*^-61}, {16., 4.4829082318898994`*^-67}}]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[{{1., 0.7506840492975346}, {2., 0.20852334702709296`}, {3., 
         0.03604107232567038}, {4., 0.00433827722438625}, {5., 
         0.00038562464216766664`}, {6., 0.000026184389282989702`}, {7., 
         1.3854174223804076`*^-6}, {8., 5.7725725932516987`*^-8}, {9., 
         1.90043542164665*^-9}, {10., 4.9270547968616846`*^-11}, {11., 
         9.953646054266026*^-13}, {12., 1.5360564898558684`*^-14}, {13., 
         1.750491726331474*^-16}, {14., 1.3892791478821216`*^-18}, {15., 
         6.86063776731912*^-21}, {16., 1.5881105942868335`*^-23}}]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[{{1., 0.40435329286155713`}, {2., 0.3369610773846309}, {3., 
         0.17472055864388272`}, {4., 0.0630935350658465}, {5., 
         0.016824942684225724`}, {6., 0.0034273031393793176`}, {7., 
         0.0005440163713300502}, {8., 0.00006800204641625622}, {9., 
         6.716251497901856*^-6}, {10., 5.223751165034765*^-7}, {11., 
         3.16590979699077*^-8}, {12., 1.4656989800883214`*^-9}, {13., 
         5.010936684062625*^-11}, {14., 1.193080162872055*^-12}, {15., 
         1.7675261672178613`*^-14}, {16., 1.227448727234623*^-16}}]}, {
        Hue[0.37820393249936934`, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6]], 
        LineBox[{{1., 0.05399501424129966}, {2., 0.13498753560324914`}, {3., 
         0.20998061093838757`}, {4., 0.2274789951832531}, {5., 
         0.18198319614660244`}, {6., 0.11121195320070155`}, {7., 
         0.05295807295271501}, {8., 0.019859277357268126`}, {9., 
         0.005884230328079447}, {10., 0.0013729870765518694`}, {11., 
         0.0002496340139185218}, {12., 0.00003467139082201694}, {13., 
         3.5560400843094263`*^-6}, {14., 2.540028631649591*^-7}, {15., 
         1.1289016140664859`*^-8}, {16., 2.351878362638509*^-10}}]}}, {{
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6]]}}, {{
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[
         1.6]]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}, {{
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 60], 0.016666666666666666`]], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[
         1.6]]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}}, {{}, \
{}}}, {DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0.6875, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0.6875, 16.}, {0, 0.9996595443253012}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "10", "3.295836866004329`", "2.1972245773362196`", 
       "1.0986122886681098`"}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "60"], "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "60"], "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "60"], "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.560181`", ",", "0.691569`", ",", "0.194885`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "60"], "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.6150173333333333, 0.25708400000000003`, 
                    0.13945266666666667`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.922526`", ",", "0.385626`", ",", "0.209179`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.922526, 0.385626, 0.209179]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.922526, 0.385626, 0.209179], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "True", ",", "True"}], 
               "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.8645918572543488`*^9, 3.8645918730611677`*^9}, {
   3.8645919062263603`*^9, 3.8645919199753857`*^9}, 3.864592018904483*^9, 
   3.864682715622076*^9, 3.865371081002098*^9, 3.865611704420442*^9, 
   3.865611855320445*^9},
 CellLabel->
  "Out[397]=",ExpressionUUID->"2a942dac-157b-43c9-85d4-55932bf4ce2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rholist", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Nbyfirst", "[", 
       RowBox[{
        RowBox[{"wkd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"2", ";;"}]}], "]"}], "]"}], ".", "lda"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"lda", ",", "lambdaslist"}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}], "\n", 
 RowBox[{"ListLinePlot", "[", "rholist", "]"}]}], "Input",
 CellChangeTimes->{{3.864592098181099*^9, 3.864592148062001*^9}, 
   3.86561186606822*^9},ExpressionUUID->"d5703464-7f90-491c-81e4-\
bde2074c0ad7"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
      LineBox[{{1., 1.}, {2., 0.874957434023525}, {3., 0.749926221379035}, {
       4., 0.6249063610356954}, {5., 0.4998978519627661}, {6., 
       0.37490069312959995`}, {7., 0.24991488350564353`}, {8., 
       0.12494042206043707`}, {9., -0.000022692236385680496`}, {
       10., -0.12497446041509747`}, {11., -0.2499148835058774}, {
       12., -0.37484396253881114`}, {13., -0.4997616985438908}, {
       14., -0.6246680925510149}, {15., -0.7495631455899885}, {
       16., -0.8744468586905233}, {17., -0.9993192328822372}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
      LineBox[{{1., 1.}, {2., 0.8380871904864579}, {3., 0.6877395816524544}, {
       4., 0.5481310877351655}, {5., 0.41849462909768304`}, {6., 
       0.298117917505735}, {7., 0.186339542456069}, {8., 
       0.0825453370528077}, {9., -0.013834996535934983`}, {
       10., -0.10333102058262462`}, {11., -0.1864344714831221}, {
       12., -0.2636019616050126}, {13., -0.3352574881467681}, {
       14., -0.4017947627926839}, {15., -0.46357937496389146`}, {
       16., -0.5209508005514413}, {17., -0.574224267168452}}]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
      LineBox[{{1., 1.}, {2., 0.7545102545530751}, {3., 0.5581184581955349}, {
       4., 0.4010050211095027}, {5., 0.27531427144067705`}, {6., 
       0.1747616717056164}, {7., 0.09431959191756796}, {8., 
       0.02996592808712919}, {9., -0.021517002977221825`}, {
       10., -0.06270334782870264}, {11., -0.09565242370988727}, {
       12., -0.12201168441483501`}, {13., -0.1430990929787932}, {
       14., -0.15996901982995976`}, {15., -0.173464961310893}, {
       16., -0.18426171449563963`}, {17., -0.19289911704343685`}}]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6], 
      LineBox[{{1., 1.}, {2., 0.49493796741487817`}, {3., 
       0.24240695112231733`}, {4., 0.1161414429760368}, {5., 
       0.05300868890289657}, {6., 0.021442311866326443`}, {7., 
       0.0056591233480413755`}, {8., -0.0022324709111011575`}, {
       9., -0.006178268040672423}, {10., -0.008151166605458055}, {
       11., -0.00913761588785087}, {12., -0.009630840529047282}, {
       13., -0.009877452849645495}, {14., -0.010000759009944602`}, {
       15., -0.010062412090094161`}, {16., -0.010093238630168951`}, {
       17., -0.010108651900206284`}}]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[
      1.6]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
       NCache[
        Rational[1, 60], 0.016666666666666666`]], AbsoluteThickness[
      1.6]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 17.}, {-0.9993192328822372, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.864592057830655*^9, 3.864592084370681*^9}, 
   3.864592151568488*^9, 3.864682725235282*^9, 3.865371082589375*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"bc056a95-5f65-4a32-8459-a1293e5d9bd7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "\"\<data/\>\"", ",", "fl", ",", "\"\<_lambdas\>\"", ",", 
      "\"\<.tsv\>\""}], "]"}], ",", " ", "lambdas"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.861093870679784*^9, 3.861093913675929*^9}, {
  3.861093998914566*^9, 3.861094001107321*^9}},
 CellLabel->
  "In[728]:=",ExpressionUUID->"f9703f34-3aec-4dde-a344-315bfe2131a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fslist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Length", "@", "blist"}], ",", "nrep"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.860872801035391*^9, 3.860872805101367*^9}, {
  3.864592396797516*^9, 3.864592417452589*^9}},
 CellLabel->
  "In[730]:=",ExpressionUUID->"a64f50b3-5570-402e-8c3c-ff5b421a3fed"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", "]"}], ",", 
       RowBox[{"alpha", "^", "l"}]}], "]"}]}], ";", 
    RowBox[{"f", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"lambdaslist", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], 
            RowBox[{
             RowBox[{"mks", "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "1"}], "]"}], "]"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"Pkby", "[", 
                RowBox[{"f", ",", "k"}], "]"}], "]"}], "^", "2"}]}]}], ")"}], 
          "]"}], 
         RowBox[{"Pkby", "[", 
          RowBox[{"f", ",", "k"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "l"}], "}"}]}], "]"}], "//", "Total"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fslist", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", "f"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"Length", "@", "blist"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "nrep"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8608728058192167`*^9, 3.860872845734805*^9}, {
  3.861882972091668*^9, 3.8618830110972424`*^9}, {3.8645924253903017`*^9, 
  3.864592451880906*^9}},
 CellLabel->
  "In[731]:=",ExpressionUUID->"af15e473-64c6-41d5-90b3-e2ce2991ebba"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fslist", "[", 
     RowBox[{"[", 
      RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fslist", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "i"}], "]"}], "]"}], "/", 
     RowBox[{"StandardDeviation", "[", 
      RowBox[{"fslist", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "nrep"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8618832052452*^9, 3.861883235609281*^9}, {
  3.8645924836732607`*^9, 3.864592494941676*^9}},
 CellLabel->
  "In[732]:=",ExpressionUUID->"295fb008-b8e3-48a9-abf6-c67a6f299a31"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Pkby", "[", 
            RowBox[{
             RowBox[{"fslist", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", "k"}], "]"}], 
           "]"}], "^", "2"}], "/", 
         RowBox[{"mks", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "l"}], "}"}]}], "]"}], "-", 
      RowBox[{"lambdaslist", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ",", 
     RowBox[{"10", "^", "7"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.860872630112206*^9, 3.860872654306201*^9}, {
  3.860872858717414*^9, 3.860872860411532*^9}, {3.861883019401614*^9, 
  3.861883019788949*^9}, {3.863694184995242*^9, 3.8636941891067343`*^9}, {
  3.864592508930765*^9, 3.864592533815427*^9}},
 CellLabel->
  "In[733]:=",ExpressionUUID->"1091844f-403d-4cad-b2e4-1d24a4962b0e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.860872627238315*^9, 3.860872658829054*^9}, 
   3.860872706086074*^9, 3.8608728610172462`*^9, 3.860874595096334*^9, 
   3.860875818210309*^9, 3.861883021518105*^9, 3.861883104722698*^9, 
   3.861883252531287*^9, {3.8636941829294243`*^9, 3.863694189878429*^9}, {
   3.864592516800115*^9, 3.86459254320053*^9}, 3.864682800801899*^9},
 CellLabel->
  "Out[733]=",ExpressionUUID->"d296716f-83f8-4ae0-931a-7ca394c27de9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<data/\>\"", ",", 
       RowBox[{"StringRiffle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fl", ",", "\"\<f\>\"", ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"blist", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
           RowBox[{"ToString", "[", "i", "]"}]}], "}"}], ",", "\"\<_\>\""}], 
        "]"}], ",", "\"\<.tsv\>\""}], "]"}], ",", 
     RowBox[{"fslist", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "nrep"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8645925680844173`*^9, 3.864592579190585*^9}, {
  3.864592624414949*^9, 3.864592650945616*^9}},
 CellLabel->
  "In[734]:=",ExpressionUUID->"309b553d-8240-4178-b51a-f8ad1d51810c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate training samples", "Section",
 CellChangeTimes->{{3.858674902923584*^9, 3.858674905441621*^9}, {
  3.85938143473862*^9, 3.85938143703601*^9}, {3.86061649906289*^9, 
  3.860616513696723*^9}},ExpressionUUID->"9204e9ed-c7f3-43b6-8912-\
53fee529bbed"],

Cell[CellGroupData[{

Cell["Random sampling", "Subsection",
 CellChangeTimes->{{3.8606165175793552`*^9, 
  3.86061654481107*^9}},ExpressionUUID->"e009240c-b191-4f3c-910d-\
a1115b606475"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samplesizes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"i", " ", 
       RowBox[{"Length", "[", "sequences", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".01", ",", ".05"}], "}"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{".1", ",", ".9", ",", ".1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{".95", ",", ".99"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"proportions", "=", 
   RowBox[{"samplesizes", "/", 
    RowBox[{"(", 
     RowBox[{"alpha", "^", "l"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783344917635714*^9, 3.783344957829818*^9}, {
   3.785242990982191*^9, 3.785242998510944*^9}, 3.859630930925025*^9},
 CellLabel->
  "In[104]:=",ExpressionUUID->"878e5f0e-6601-4f4c-be9a-54c4fd4495e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomSample", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "sequences", "]"}], "]"}], ",", 
       RowBox[{"samplesizes", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "samplesizes", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tts", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"alpha", "^", "l"}], "]"}], ",", 
       RowBox[{"trs", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "trs", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", " ", 
       RowBox[{"\"\<data/\>\"", ",", " ", "\"\<tr_\>\"", ",", 
        RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
      ",", 
      RowBox[{"trs", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"lg", "@", "trs"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7833448976781483`*^9, 3.7833448984662333`*^9}, {
   3.783344963121048*^9, 3.783344979261902*^9}, 3.8594545593130713`*^9, {
   3.8606170904665813`*^9, 3.8606170919280987`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"638a3760-bf9c-4ef4-b9be-6f0784ff8cd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulated mutagenesis", "Subsection",
 CellChangeTimes->{{3.860616548361465*^9, 
  3.8606165531717577`*^9}},ExpressionUUID->"ca3fe7ea-5b2a-4560-91c0-\
2828dff260a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wt", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "l"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[286]:=",ExpressionUUID->"9d1def16-b635-4a65-bb83-f8f1bb376b4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wg", "=", 
  RowBox[{
   RowBox[{"mks", "^", 
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}]}], "//", "N"}]}]], "Input",
 CellChangeTimes->{{3.785718747868567*^9, 3.785718813012555*^9}, {
  3.785718891970484*^9, 3.785718894007209*^9}, {3.785718961509604*^9, 
  3.785718980696171*^9}, {3.7857845469499063`*^9, 3.78578454707887*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"cd64a19a-99d8-447c-b3f5-035cef7a36ab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "0.0625`", ",", "0.008333333333333333`", ",", 
   "0.0017857142857142857`", ",", "0.0005494505494505495`", ",", 
   "0.00022893772893772894`", ",", "0.00012487512487512488`", ",", 
   "0.00008741258741258741`", ",", "0.0000777000777000777`", ",", 
   "0.00008741258741258741`", ",", "0.00012487512487512488`", ",", 
   "0.00022893772893772894`", ",", "0.0005494505494505495`", ",", 
   "0.0017857142857142857`", ",", "0.008333333333333333`", ",", "0.0625`", 
   ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.785718748464738*^9, 3.785718813787648*^9}, 
   3.785718894656073*^9, 3.7857189314326487`*^9, {3.7857189618048763`*^9, 
   3.785718981028264*^9}, 3.785725341786572*^9, 3.785784274961919*^9, 
   3.7857845474615097`*^9, 3.785785313522851*^9, 3.78584789577177*^9, 
   3.785853277790097*^9, 3.785860668094639*^9, 3.786458899901606*^9, 
   3.786458973644125*^9, 3.786557763327383*^9, 3.78671682584937*^9, 
   3.859028555483366*^9, 3.8606171406918077`*^9, {3.860874607007057*^9, 
   3.860874618786274*^9}, 3.860875829711288*^9, 3.861883442660632*^9, 
   3.8636942425074577`*^9, 3.863787133035328*^9, 3.863788348056302*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"7ea8fee5-37e3-4a15-a979-417e168ae7ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nbysum", "[", 
      RowBox[{"mks", "^", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"Nbysum", "[", "wg", "]"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.785718793821918*^9, 3.785718817128313*^9}, {
  3.78571889779423*^9, 3.785718911368473*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"f2c3ae30-6626-43e1-8031-e096fb9813cc"],

Cell[BoxData[
 GraphicsBox[{{}, {{
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{1., 0.4657017317136211}, {2., 0.02910635823210132}, {3., 
       0.003880847764280176}, {4., 0.0008316102352028948}, {5., 
       0.0002558800723701215}, {6., 0.00010661669682088395`}, {7., 
       0.000058154561902300336`}, {8., 0.00004070819333161023}, {9., 
       0.0000361850607392091}, {10., 0.00004070819333161023}, {11., 
       0.000058154561902300336`}, {12., 0.00010661669682088395`}, {13., 
       0.0002558800723701215}, {14., 0.0008316102352028948}, {15., 
       0.003880847764280176}, {16., 0.02910635823210132}, {17., 
       0.4657017317136211}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{1., 0.46570173171362117`}, {2., 0.029106358232101323`}, {3., 
       0.0038808477642801762`}, {4., 0.0008316102352028949}, {5., 
       0.0002558800723701215}, {6., 0.00010661669682088396`}, {7., 
       0.00005815456190230034}, {8., 0.00004070819333161024}, {9., 
       0.000036185060739209106`}, {10., 0.00004070819333161024}, {11., 
       0.00005815456190230034}, {12., 0.00010661669682088396`}, {13., 
       0.0002558800723701215}, {14., 0.0008316102352028949}, {15., 
       0.0038808477642801762`}, {16., 0.029106358232101323`}, {17., 
       0.46570173171362117`}}]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}, {}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}, {}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.6666666666666666, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0.6666666666666666, 17.}, {0, 0.46570173171362117`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.785718794617687*^9, 3.78571881751191*^9}, {
   3.785718899078416*^9, 3.785718932239875*^9}, {3.785718962850931*^9, 
   3.785718981934436*^9}, 3.7857253419434*^9, 3.7857842765542107`*^9, 
   3.7857845489974337`*^9, 3.785785316035932*^9, 3.785847895911126*^9, 
   3.7858532794053097`*^9, 3.78586066821959*^9, 3.78645897513547*^9, 
   3.786557763395751*^9, 3.7867168267018223`*^9, 3.8590285562007227`*^9, 
   3.86061714204972*^9, {3.8608746070584793`*^9, 3.860874618853669*^9}, 
   3.860875829779896*^9, 3.861883442776462*^9, 3.863694242666174*^9, 
   3.8637871331415854`*^9, 3.8637883481212482`*^9},
 CellLabel->
  "Out[288]=",ExpressionUUID->"c1e25f55-5715-459e-a5ac-470e792b0e32"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samplesizes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"i", " ", 
       RowBox[{"Length", "[", "sequences", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".01", ",", ".05"}], "}"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{".1", ",", ".9", ",", ".1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{".95", ",", ".99"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"proportions", "=", 
   RowBox[{"samplesizes", "/", 
    RowBox[{"(", 
     RowBox[{"alpha", "^", "l"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783344917635714*^9, 3.783344957829818*^9}, {
   3.785242990982191*^9, 3.785242998510944*^9}, 3.8610973995209913`*^9},
 CellLabel->
  "In[289]:=",ExpressionUUID->"91d30e6c-4d15-4757-973a-92dce55c68c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hd", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"HammingDistance", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "l"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
    "sequences"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"seqbyhd", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"hd", ",", "d"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"seqsbyD", "=", 
   RowBox[{
    RowBox[{"GatherBy", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"HammingDistance", "[", 
            RowBox[{"#", ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", "l"}], "]"}]}], "]"}], "&"}], "/@", 
          "sequences"}], ",", "sequences"}], "}"}]}], ",", "First"}], "]"}], 
    "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"hdsub", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomSample", "[", 
       RowBox[{
        RowBox[{"seq2pos", "/@", 
         RowBox[{"seqsbyD", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"lg", "@", "seqsbyD"}]}], "}"}]}], "]"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.7808437630307817`*^9, 3.780843794011559*^9}, 
   3.7864529625379143`*^9},
 CellLabel->
  "In[291]:=",ExpressionUUID->"fedb3487-7740-4a34-a080-fd51c128c0b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", ".1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"weights", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], 
       RowBox[{
        RowBox[{"-", "#"}], "+", "l"}]], " ", 
      SuperscriptBox["p", "#"]}], " ", "&"}], "/@", "hd"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.780843757554625*^9, 3.780843760258093*^9}, {
   3.780844073425549*^9, 3.7808441131864862`*^9}, 3.780844717772211*^9, {
   3.78084493748734*^9, 3.7808449414672823`*^9}, {3.780845794902852*^9, 
   3.780845828736547*^9}, {3.780845872963282*^9, 3.7808458733050528`*^9}, {
   3.78084591037824*^9, 3.780845910912065*^9}, 3.780852074320318*^9, {
   3.780852131113812*^9, 3.780852132112256*^9}, 3.7808521701664658`*^9, 
   3.859278277360279*^9, {3.859299230184499*^9, 3.859299259883484*^9}, {
   3.8592993396444607`*^9, 3.859299339986712*^9}, 3.859299421392777*^9, {
   3.860617267326071*^9, 3.860617269762301*^9}, {3.860617322592774*^9, 
   3.860617328512431*^9}, 3.860617364590962*^9},
 CellLabel->
  "In[295]:=",ExpressionUUID->"8f2f5990-6135-4793-8192-55ebf109734c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "give", " ", "minimum", " ", "epistasis", " ", "interpolation",
      " ", "1", "%"}], ",", " ", 
    RowBox[{"10", "%"}], ",", " ", 
    RowBox[{
    "50", "%", " ", "and", " ", "90", "%", " ", "of", " ", "all", " ", "data",
      " ", "as", " ", "training", " ", "and", " ", "use", " ", "the", " ", 
     "rest", " ", "of", " ", "the", " ", "data", " ", "as", " ", "test"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"trsmut", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomSample", "[", 
        RowBox[{
         RowBox[{"weights", "\[Rule]", 
          RowBox[{"Range", "[", 
           RowBox[{"alpha", "^", "l"}], "]"}]}], ",", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"i", " ", 
           RowBox[{"alpha", "^", "l"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "proportions"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tstmut", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"alpha", "^", "l"}], "]"}], ",", 
          RowBox[{"trsmut", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "//", "Flatten"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "proportions", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.762085512756638*^9, 3.7620855807492867`*^9}, {
   3.762094727170327*^9, 3.762094741497457*^9}, 3.765806908555455*^9, {
   3.766228416379088*^9, 3.766228479898402*^9}, 3.780844793196917*^9, {
   3.780852316904729*^9, 3.780852321121105*^9}, {3.7808526959889383`*^9, 
   3.780852705451377*^9}, {3.780853156192951*^9, 3.780853160610716*^9}, {
   3.780854667019451*^9, 3.7808546698144608`*^9}, {3.784978967643351*^9, 
   3.784978969711825*^9}, {3.784979302892748*^9, 3.7849793032094307`*^9}, 
   3.786110783203618*^9, {3.7861112660029383`*^9, 3.7861112672788553`*^9}, 
   3.786365218447443*^9, {3.8592785254495487`*^9, 3.859278528694048*^9}, 
   3.860617211420224*^9},
 CellLabel->
  "In[297]:=",ExpressionUUID->"23c5b21e-8aa7-4b4f-8305-a2426b051a30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"proportions", "//", "N"}]], "Input",
 CellChangeTimes->{{3.859278474099537*^9, 3.859278476954382*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"1dba38d1-6c07-4887-911e-a3282564cfd9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0099945068359375`", ",", "0.0500030517578125`", ",", 
   "0.100006103515625`", ",", "0.1999969482421875`", ",", 
   "0.3000030517578125`", ",", "0.399993896484375`", ",", "0.5`", ",", 
   "0.600006103515625`", ",", "0.6999969482421875`", ",", 
   "0.8000030517578125`", ",", "0.899993896484375`", ",", 
   "0.9499969482421875`", ",", "0.9900054931640625`"}], "}"}]], "Output",
 CellChangeTimes->{{3.859278475067452*^9, 3.859278477190246*^9}, 
   3.8592990664350777`*^9, 3.859299238283675*^9, 3.859299307952413*^9, 
   3.8592993472577877`*^9, 3.8592994283870564`*^9, 3.860617214787805*^9, 
   3.860617299491477*^9, 3.860617331502055*^9, {3.860617362052259*^9, 
   3.860617366085486*^9}, {3.8608746080423603`*^9, 3.860874619728917*^9}, 
   3.86087583065709*^9, 3.8618834434580927`*^9, 3.8636942433525057`*^9, 
   3.863787133948936*^9, 3.863788348923065*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"142c645d-aa3d-4144-aee9-d69cfb258137"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SortBy", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"hd", "[", 
     RowBox[{"[", 
      RowBox[{"trsmut", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "//", "Tally"}], ",", 
   "First"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", 
   RowBox[{"mks", "[", 
    RowBox[{"[", 
     RowBox[{";;", 
      RowBox[{"Length", "[", "%", "]"}]}], "]"}], "]"}]}], "//", 
  "N"}]}], "Input",
 CellChangeTimes->{{3.859278219094694*^9, 3.8592782217289877`*^9}, {
   3.859278283445943*^9, 3.859278308048358*^9}, {3.859278382328753*^9, 
   3.8592784055816727`*^9}, 3.8592992152579517`*^9, 3.859299320838296*^9, {
   3.85929939220018*^9, 3.859299392364882*^9}, {3.859299435567957*^9, 
   3.8592994421277637`*^9}, {3.8606172314108887`*^9, 3.860617231563191*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"65b2d10e-1a93-4001-bb9e-37e077112afa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "120"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "308"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "153"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "48"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.859278221969943*^9, {3.859278270778862*^9, 3.8592784059691057`*^9}, 
   3.8592990708186493`*^9, {3.8592992157334003`*^9, 3.859299240493765*^9}, {
   3.859299309493019*^9, 3.859299347321466*^9}, 3.859299392720882*^9, {
   3.859299428438273*^9, 3.859299445545127*^9}, {3.860617218065856*^9, 
   3.860617231888188*^9}, 3.8606173001039124`*^9, 3.8606173325042152`*^9, {
   3.860617362713732*^9, 3.8606173666346407`*^9}, {3.860874608046736*^9, 
   3.860874619766877*^9}, 3.860875830696907*^9, 3.861883443501194*^9, 
   3.863694243394788*^9, 3.863787133994563*^9, 3.863788348969099*^9},
 CellLabel->
  "Out[300]=",ExpressionUUID->"a84955b0-433e-42f9-a420-2f39b45662ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "1.`", ",", "1.`", ",", "0.55`", ",", "0.08406593406593407`", 
   ",", "0.01098901098901099`", ",", "0.0007492507492507493`", ",", 
   "0.00008741258741258741`", ",", "0.0001554001554001554`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.859278221969943*^9, {3.859278270778862*^9, 3.8592784059691057`*^9}, 
   3.8592990708186493`*^9, {3.8592992157334003`*^9, 3.859299240493765*^9}, {
   3.859299309493019*^9, 3.859299347321466*^9}, 3.859299392720882*^9, {
   3.859299428438273*^9, 3.859299445545127*^9}, {3.860617218065856*^9, 
   3.860617231888188*^9}, 3.8606173001039124`*^9, 3.8606173325042152`*^9, {
   3.860617362713732*^9, 3.8606173666346407`*^9}, {3.860874608046736*^9, 
   3.860874619766877*^9}, 3.860875830696907*^9, 3.861883443501194*^9, 
   3.863694243394788*^9, 3.863787133994563*^9, 3.863788348973205*^9},
 CellLabel->
  "Out[301]=",ExpressionUUID->"89ecaf3c-3c0d-4465-b56c-818c75447aa4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<data/\>\"", ",", " ", "\"\<tr_mut_\>\"", ",", 
        RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
      ",", 
      RowBox[{"trsmut", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"lg", "@", "trsmut"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.784935958802273*^9, 3.784936002407185*^9}, {
   3.7849360607381687`*^9, 3.784936076668084*^9}, {3.784936808900751*^9, 
   3.784936817740769*^9}, {3.784937096793487*^9, 3.784937097170569*^9}, {
   3.7849371382792683`*^9, 3.784937138675311*^9}, {3.784937249731298*^9, 
   3.784937251024476*^9}, {3.785190847292749*^9, 3.7851908781409807`*^9}, {
   3.785243045706354*^9, 3.785243046848991*^9}, {3.7873350526526613`*^9, 
   3.787335064330497*^9}, 3.78733515996841*^9, 3.787335385431644*^9, 
   3.787336249203082*^9, {3.8586754227234297`*^9, 3.858675424720295*^9}, {
   3.8586755499512777`*^9, 3.8586755564660587`*^9}, {3.8592785168741283`*^9, 
   3.8592785428649406`*^9}, 3.860617306034151*^9},
 CellLabel->
  "In[302]:=",ExpressionUUID->"8819da25-31b9-415f-959c-808d0f4058cc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Export data to GE", "Section",
 CellChangeTimes->{{3.860616580170353*^9, 3.860616580266287*^9}, {
  3.860875845676409*^9, 
  3.860875848385839*^9}},ExpressionUUID->"885bb96d-33f6-4dba-b198-\
3251c0af37b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"geWD", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "\"\</Users/keitokiddo/Dropbox (UFL)/VC_revision/GE/\>\"", ",", " ", 
     "fl"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "geWD", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.858685415753504*^9, 3.858685417146699*^9}, {
   3.8596316559381247`*^9, 3.85963165802564*^9}, {3.860054897099617*^9, 
   3.860054901392017*^9}, {3.8600559355596533`*^9, 3.8600559366773376`*^9}, {
   3.860671770772121*^9, 3.860671793639415*^9}, 3.8608730886981783`*^9},
 CellLabel->
  "In[2204]:=",ExpressionUUID->"47edaed4-e6f9-484f-a0d2-ecbeebea0901"],

Cell[CellGroupData[{

Cell["Mut", "Subsubsection",
 CellChangeTimes->{{3.8183271886295557`*^9, 3.818327195356439*^9}, {
  3.860672365752698*^9, 3.8606723663117456`*^9}, {3.860672518996893*^9, 
  3.86067252220437*^9}},ExpressionUUID->"a170bb4e-bb60-4f43-9379-\
48a4251b5414"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scheme", "=", "\"\<mut\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.858683954393511*^9, 3.858683956148291*^9}, {
  3.8606719738525953`*^9, 3.860671978222046*^9}, {3.8606725249093103`*^9, 
  3.860672525298085*^9}},
 CellLabel->
  "In[2245]:=",ExpressionUUID->"54ef3f6b-cdd0-42da-861b-20c8c98b4fde"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"name", " ", "=", " ", 
      RowBox[{"StringRiffle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fl", ",", "  ", "scheme", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"blist", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "}"}], ",", 
        "\"\<_\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sequencesAA", "[", 
          RowBox[{"[", 
           RowBox[{"trsmut", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"fslist", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"subreps", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"trsmut", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"trsmut", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"fl", ",", " ", 
           RowBox[{"Length", "@", 
            RowBox[{"trsmut", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}]}], "}"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"name", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"subreps", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"ToString", "[", "j", "]"}]}], "}"}], ",", "\"\<_\>\""}],
           "]"}], ",", "\"\<.txt\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Prepend", "[", 
        RowBox[{"data", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<mut\>\"", ",", "\"\<f\>\"", ",", "\"\<v\>\"", ",", 
           "\"\<condition\>\""}], "}"}]}], "]"}], ",", "\"\<CSV\>\""}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "2", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764341765398015*^9, 3.764341827947495*^9}, {
   3.76434190977564*^9, 3.7643419100786867`*^9}, {3.789629952147429*^9, 
   3.789629962231992*^9}, {3.789630104236558*^9, 3.789630129081153*^9}, 
   3.7896302731122723`*^9, 3.789633186174459*^9, 3.7896334121212053`*^9, {
   3.789970349924099*^9, 3.789970349925536*^9}, {3.8586836270935097`*^9, 
   3.8586836365906343`*^9}, {3.85868387561753*^9, 3.8586838896630583`*^9}, {
   3.858683950204829*^9, 3.858683952540492*^9}, {3.86067198327949*^9, 
   3.8606719856744137`*^9}, {3.860672018355348*^9, 3.860672020059945*^9}, {
   3.860672079408794*^9, 3.8606720937643833`*^9}, {3.8606721487928133`*^9, 
   3.860672149031541*^9}, {3.860672448525195*^9, 3.860672450859165*^9}, {
   3.860672535244835*^9, 3.8606725484438143`*^9}, {3.861883726695231*^9, 
   3.861883731968416*^9}, {3.86507773494657*^9, 3.865077742617586*^9}, {
   3.865077874045713*^9, 3.865077969993972*^9}, {3.8650780202088223`*^9, 
   3.8650780706396437`*^9}, 3.865078147647558*^9, 3.8650781866903353`*^9, {
   3.865078256709364*^9, 3.865078272397688*^9}, {3.8650783769749126`*^9, 
   3.86507843869974*^9}, 3.865078520700824*^9, {3.865078580293281*^9, 
   3.865078669945388*^9}, 3.865078928826229*^9},
 CellLabel->
  "In[2294]:=",ExpressionUUID->"d87d867f-5dca-484f-a22e-adb748b2d2cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"StringRiffle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fl", ",", "  ", "scheme", ",", 
       RowBox[{"ToString", "[", 
        RowBox[{"blist", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
       RowBox[{"ToString", "[", "i", "]"}], ",", 
       RowBox[{"ToString", "[", "j", "]"}]}], "}"}], ",", "\"\<_\>\""}], 
    "]"}], ",", "\"\<.txt\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.865079007676037*^9, 3.8650790576262493`*^9}},
 CellLabel->
  "In[2301]:=",ExpressionUUID->"18ca31d5-3f06-4e22-855a-10ba36755576"],

Cell[BoxData["\<\"2_16_DEN_mut_1.09861_3_3.txt\"\>"], "Output",
 CellChangeTimes->{3.8650789756934557`*^9, 3.865079058055743*^9},
 CellLabel->
  "Out[2301]=",ExpressionUUID->"517747c2-d506-4d75-9559-e4b519d499cb"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<dataf = CSV.read(\\\"file\\\")\>\"", ",", 
         RowBox[{"\"\<file\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringRiffle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"fl", ",", "  ", "scheme", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"blist", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", "i", "]"}], ",", 
                RowBox[{"ToString", "[", "j", "]"}]}], "}"}], ",", 
              "\"\<_\>\""}], "]"}], ",", "\"\<.txt\>\""}], "]"}]}]}], "]"}], 
       ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
        "\"\<d = prepdata(dataf, :mut, :sequence, \\\"WT\\\", :f, cname = \
:condition, vname = :v)\>\"", ",", " ", 
         RowBox[{"\"\<WT\>\"", "\[Rule]", "wtAA"}]}], "]"}], ",", 
       "\"\<@time mlin = nonepistatic_model(d)\>\"", ",", 
       "\"\<@time m = fit(mlin, nk = 4, tol = 1e-14)\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"b_#.tsv\\\",m[:b])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringRiffle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"fl", ",", "  ", "scheme", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"blist", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", "i", "]"}], ",", 
                RowBox[{"ToString", "[", "j", "]"}]}], "}"}], ",", 
              "\"\<_\>\""}], "]"}], ",", "\"\<.txt\>\""}], "]"}]}]}], "]"}], 
       ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"a_#.tsv\\\",m[:a])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringRiffle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"fl", ",", "  ", "scheme", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"blist", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", "i", "]"}], ",", 
                RowBox[{"ToString", "[", "j", "]"}]}], "}"}], ",", 
              "\"\<_\>\""}], "]"}], ",", "\"\<.txt\>\""}], "]"}]}]}], "]"}], 
       ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"\"\<writedlm(\\\"yhat_#.tsv\\\",m[:yhat])\>\"", ",", 
         RowBox[{"\"\<#\>\"", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringRiffle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"fl", ",", "  ", "scheme", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"blist", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", "i", "]"}], ",", 
                RowBox[{"ToString", "[", "j", "]"}]}], "}"}], ",", 
              "\"\<_\>\""}], "]"}], ",", "\"\<.txt\>\""}], "]"}]}]}], "]"}], 
       ",", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"fl", ",", " ", "\"\<terminal.txt\>\""}], "]"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"\"\<cd(\\\"#\\\")\>\"", ",", 
          RowBox[{"\"\<#\>\"", "\[Rule]", "geWD"}]}], "]"}], ",", 
        "\"\<using CSV\>\"", ",", "\"\<using DataFrames\>\"", ",", 
        "\"\<using GlobalEpistasis\>\""}], "}"}], ",", "%"}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8608759699139843`*^9, 3.860875971028613*^9}, {
   3.865078704926708*^9, 3.86507874984077*^9}, {3.8650788105631638`*^9, 
   3.865078813405986*^9}, {3.865078878873123*^9, 3.8650788800886106`*^9}, {
   3.865078937211179*^9, 3.86507894438295*^9}, {3.865079069072393*^9, 
   3.865079075974667*^9}, {3.865079141251815*^9, 3.86507914374829*^9}, 
   3.8650791770044394`*^9, {3.865079208367231*^9, 3.8650792313837547`*^9}, {
   3.865079281289489*^9, 3.865079281439848*^9}},
 CellLabel->
  "In[2322]:=",ExpressionUUID->"e835956c-ffe3-4235-92ec-201fe19335d8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make figures", "Section",
 CellChangeTimes->{{3.864656226491284*^9, 
  3.8646562279092407`*^9}},ExpressionUUID->"0812490a-1f0f-4b01-aa1e-\
d9ffe58289f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nrep", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nschemes", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"schemes", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<random\>\"", ",", "\"\<noised\>\"", ",", "\"\<mut\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nschemes", "=", 
   RowBox[{"Length", "@", "schemes"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8613062145663977`*^9, 3.861306215600606*^9}, 
   3.8613120852269087`*^9, {3.864762254209436*^9, 3.8647622555933113`*^9}},
 CellLabel->
  "In[719]:=",ExpressionUUID->"c26c9ca7-2c37-41c8-9bc3-4dacbc51a2c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"alpha", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"l", "=", "16"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"hd", "=", "\"\</Users/keitokiddo/VC_revision/Simulations/\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"wd", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"hd", ",", "\"\<2_16_DEN_var_ldas\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "wd", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.860875605343582*^9, 3.8608756137532263`*^9}, 
   3.861886504407048*^9, {3.864591634727996*^9, 3.864591661060377*^9}},
 CellLabel->
  "In[723]:=",ExpressionUUID->"38592a16-9b17-4f32-823f-9deb3a4c71e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"alpha", "-", "1"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"the", " ", "alphabet", " ", "in", " ", "numbers", " ", "0"}], 
    "-", "19"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sequences", "=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"A", ",", "l"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"list", " ", "of", " ", "all", " ", "sequences"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"seq2pos", "[", "seq_", "]"}], ":=", 
   RowBox[{
    RowBox[{"FromDigits", "[", 
     RowBox[{"seq", ",", "alpha"}], "]"}], "+", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"multiplicities", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{"l", ",", "k"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"alpha", "-", "1"}], ")"}], "^", "k"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Binomial", "[", 
       RowBox[{"l", ",", "k"}], "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"alpha", "-", "1"}], ")"}], "^", "k"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.765809188632872*^9, 3.765809230513093*^9, {3.765818554425509*^9, 
   3.7658185803234243`*^9}, 3.766229531853812*^9, 3.766229579196743*^9, {
   3.766229619564746*^9, 3.766229838748877*^9}, {3.766229919109879*^9, 
   3.7662301636376123`*^9}, {3.7662301945029373`*^9, 
   3.7662302338331842`*^9}, {3.783274186128935*^9, 3.783274231984097*^9}, {
   3.783274330146632*^9, 3.783274333883054*^9}, {3.783275180656855*^9, 
   3.783275195589322*^9}, 3.783275352797121*^9, {3.785018447155464*^9, 
   3.785018451227006*^9}, {3.8586726205152683`*^9, 3.858672621253992*^9}, 
   3.8586729723301907`*^9, {3.858765737585622*^9, 3.8587657377362957`*^9}, 
   3.859024992185452*^9, {3.8592882938463078`*^9, 3.85928829451423*^9}, {
   3.860614807245092*^9, 3.860614808145941*^9}, {3.861306444706209*^9, 
   3.861306444900069*^9}, {3.861308310905451*^9, 3.8613083260482817`*^9}},
 CellLabel->
  "In[728]:=",ExpressionUUID->"8e67a323-e9eb-4064-be03-ba315a6c7184"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"samplesizes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"i", " ", 
       RowBox[{"Length", "[", "sequences", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{".01", ",", ".05"}], "}"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{".1", ",", ".9", ",", ".1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{".95", ",", ".99"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"proportions", "=", 
   RowBox[{"samplesizes", "/", 
    RowBox[{"(", 
     RowBox[{"alpha", "^", "l"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.783344917635714*^9, 3.783344957829818*^9}, {
   3.785242990982191*^9, 3.785242998510944*^9}, 3.8611004950673723`*^9},
 CellLabel->
  "In[733]:=",ExpressionUUID->"de0c2898-ea54-429c-98b3-f8369618a57a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trsmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Length", "@", "proportions"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"trsmut", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<data/\>\"", ",", " ", "\"\<tr_mut_\>\"", ",", 
        RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<.tsv\>\""}], "]"}], 
      "]"}], "//", "Flatten"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "@", "trsmut"}]}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"ttsmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"alpha", "^", "l"}], "]"}], ",", 
       RowBox[{"trsmut", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "trsmut", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hd", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"HammingDistance", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "l"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
    "sequences"}]}], ";", 
  RowBox[{"seqbyhd", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"hd", ",", "d"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"seqsbyD", "=", 
   RowBox[{
    RowBox[{"GatherBy", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"HammingDistance", "[", 
            RowBox[{"#", ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", "l"}], "]"}]}], "]"}], "&"}], "/@", 
          "sequences"}], ",", "sequences"}], "}"}]}], ",", "First"}], "]"}], 
    "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], ";", 
  RowBox[{"j", "=", "2"}], ";", 
  RowBox[{"tstbyD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Intersection", "[", 
      RowBox[{
       RowBox[{"ttsmut", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"seqbyhd", "[", 
        RowBox[{"[", "d", "]"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"d", ",", " ", 
       RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Length", "/@", "tstbyD"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "/", "mks"}], "//", "N"}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trsdensity", " ", "=", " ", 
   RowBox[{"1", "-", "%"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Equal]", 
         RowBox[{"{", "}"}]}], "&"}], "/@", "tstbyD"}], ",", "False"}], "]"}],
     "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//", "First"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dmin", "=", 
   RowBox[{"%", "-", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8653709197982397`*^9, 3.865370923095997*^9}},
 CellLabel->
  "In[735]:=",ExpressionUUID->"03aff0c9-ba5b-47f2-b7bc-bf5ad516b512"],

Cell[CellGroupData[{

Cell["Import FL", "Subsection",
 CellChangeTimes->{{3.860770032999793*^9, 
  3.8607700463272753`*^9}},ExpressionUUID->"8cdb67ae-2f36-46ff-9b00-\
7b44fb648baa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fslist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Length", "@", "blist"}], ",", "nrep"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.86077009602034*^9, 3.860770102229315*^9}, 
   3.860770306181979*^9, {3.860770819541499*^9, 3.860770831158914*^9}, {
   3.862317713148353*^9, 3.862317761207322*^9}, {3.8623866172410583`*^9, 
   3.8623866174380713`*^9}, {3.863725301632058*^9, 3.863725317632436*^9}, {
   3.8646540861139174`*^9, 3.864654104878766*^9}, {3.864654147400997*^9, 
   3.8646541546506653`*^9}},
 CellLabel->
  "In[754]:=",ExpressionUUID->"7afbfb0e-6a97-4161-8e78-28d30c782490"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fslist", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<data/\>\"", ",", 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"fl", ",", "\"\<f\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"blist", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
             RowBox[{"ToString", "[", "i", "]"}]}], "}"}], ",", "\"\<_\>\""}],
           "]"}], ",", "\"\<.tsv\>\""}], "]"}], "]"}], "//", "Flatten"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "nrep"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"Length", "@", "blist"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "nrep"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.864654139536682*^9, 3.864654170529048*^9}, {
  3.864654229530671*^9, 3.864654278422512*^9}},
 CellLabel->
  "In[755]:=",ExpressionUUID->"9bbce28d-6fa8-4fbb-824e-ccc05c61409a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import VC results", "Subsection",
 CellChangeTimes->{{3.860770057841794*^9, 
  3.860770067480866*^9}},ExpressionUUID->"eaa0ef18-65ca-4977-b5d8-\
65223b925d9d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelname", "=", "\"\<vc\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scheme", "=", "\"\<mut\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.860770993490302*^9, 3.8607710171325903`*^9}, {
  3.860789051996131*^9, 3.860789057444907*^9}, {3.864654390724783*^9, 
  3.864654391227618*^9}},
 CellLabel->
  "In[446]:=",ExpressionUUID->"9e93a03c-0e2e-48d1-9905-740de96a33fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pdsVCmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", 
     RowBox[{"Length", "@", "blist"}], ",", " ", "nrep"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"name", "=", 
     RowBox[{"StringRiffle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fl", ",", "scheme", ",", "\"\<vc\>\"", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"blist", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", "i", "]"}], ",", 
         RowBox[{"ToString", "[", "2", "]"}]}], "}"}], ",", "\"\<_\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pdsVCmut", "[", 
      RowBox[{"[", 
       RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<out/\>\"", ",", " ", "name", ",", "\"\<.tsv\>\""}], 
        "]"}], "]"}], "//", "Flatten"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", 
     RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "10"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.864654203283945*^9, 3.864654215377349*^9}, 
   3.864654313202529*^9, {3.864654497539813*^9, 3.864654524067874*^9}, {
   3.864654563299313*^9, 3.864654566213684*^9}, 3.8646545971517267`*^9, {
   3.8646550104218407`*^9, 3.8646550116203823`*^9}, {3.864655342926333*^9, 
   3.864655344878256*^9}, {3.865080640675386*^9, 3.865080640804234*^9}},
 CellLabel->
  "In[448]:=",ExpressionUUID->"17a00aed-244e-49a2-a7b1-0d3e09e6d750"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import 3way results", "Subsection",
 CellChangeTimes->{{3.860770057841794*^9, 3.860770067480866*^9}, {
  3.8650771261734343`*^9, 
  3.865077126625882*^9}},ExpressionUUID->"fb06c115-d60e-487c-b094-\
708438e6b702"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelname", "=", "\"\<3way\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scheme", "=", "\"\<mut\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.860770993490302*^9, 3.8607710171325903`*^9}, {
  3.860789051996131*^9, 3.860789057444907*^9}, {3.864654390724783*^9, 
  3.864654391227618*^9}, {3.865077121665924*^9, 3.865077122981985*^9}},
 CellLabel->
  "In[450]:=",ExpressionUUID->"edbd18fb-da9c-4cbf-a77b-f19b06985579"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subreps", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "8"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.865077493679213*^9, 3.865077496632496*^9}},
 CellLabel->
  "In[452]:=",ExpressionUUID->"f2bcbfcd-5ade-4468-8687-6b0faa64bb25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pds3waymut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", 
     RowBox[{"Length", "@", "blist"}], ",", " ", "nrep"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"name", "=", 
     RowBox[{"StringRiffle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fl", ",", "scheme", ",", "modelname", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"blist", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"subreps", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", "2", "]"}]}], "}"}], ",", "\"\<_\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pds3waymut", "[", 
      RowBox[{"[", 
       RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<out/\>\"", ",", " ", "name", ",", "\"\<.tsv\>\""}], 
        "]"}], "]"}], "//", "Flatten"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", 
     RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.864654203283945*^9, 3.864654215377349*^9}, 
   3.864654313202529*^9, {3.864654497539813*^9, 3.864654524067874*^9}, {
   3.864654563299313*^9, 3.864654566213684*^9}, 3.8646545971517267`*^9, {
   3.8646550104218407`*^9, 3.8646550116203823`*^9}, {3.864655342926333*^9, 
   3.864655344878256*^9}, {3.865077167161439*^9, 3.865077187769621*^9}, 
   3.865077441434671*^9, {3.865077499469118*^9, 3.865077510272389*^9}, {
   3.865080084050058*^9, 3.86508008661042*^9}, 3.865080355836425*^9, {
   3.8650807080802307`*^9, 3.865080731758906*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"150f9e8a-57e5-4f05-80fe-085e13a305cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import 2way results", "Subsection",
 CellChangeTimes->{{3.860770057841794*^9, 3.860770067480866*^9}, {
  3.8650771261734343`*^9, 3.865077126625882*^9}, {3.8650775205938377`*^9, 
  3.865077520768016*^9}},ExpressionUUID->"52ae85a7-cca9-4af1-a441-\
b9ae98912676"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelname", "=", "\"\<2way\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scheme", "=", "\"\<mut\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.860770993490302*^9, 3.8607710171325903`*^9}, {
  3.860789051996131*^9, 3.860789057444907*^9}, {3.864654390724783*^9, 
  3.864654391227618*^9}, {3.865077121665924*^9, 3.865077122981985*^9}, {
  3.8650775229581547`*^9, 3.8650775231082993`*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"a6eb4b90-c972-4173-83ee-21d46726ec7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subreps", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "8"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.865077493679213*^9, 3.865077496632496*^9}, {
  3.865625777195614*^9, 3.865625778284113*^9}},
 CellLabel->
  "In[818]:=",ExpressionUUID->"69c257e6-c9e5-4d0c-94b7-91a568f32880"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pds2waymut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", 
     RowBox[{"Length", "@", "blist"}], ",", " ", "nrep"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"name", "=", 
     RowBox[{"StringRiffle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fl", ",", "scheme", ",", "modelname", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"blist", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"subreps", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", "2", "]"}]}], "}"}], ",", "\"\<_\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pds2waymut", "[", 
      RowBox[{"[", 
       RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<out/\>\"", ",", " ", "name", ",", "\"\<.tsv\>\""}], 
        "]"}], "]"}], "//", "Flatten"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", 
     RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.864654203283945*^9, 3.864654215377349*^9}, 
   3.864654313202529*^9, {3.864654497539813*^9, 3.864654524067874*^9}, {
   3.864654563299313*^9, 3.864654566213684*^9}, 3.8646545971517267`*^9, {
   3.8646550104218407`*^9, 3.8646550116203823`*^9}, {3.864655342926333*^9, 
   3.864655344878256*^9}, {3.865077167161439*^9, 3.865077187769621*^9}, 
   3.865077441434671*^9, {3.865077499469118*^9, 3.865077510272389*^9}, {
   3.8650800783929663`*^9, 3.865080078957356*^9}, 3.865080359446858*^9, 
   3.8650807358086367`*^9},
 CellLabel->
  "In[819]:=",ExpressionUUID->"a7fe5e3a-3e8f-4bac-9e4a-a490c1852d99"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import GE results", "Subsection",
 CellChangeTimes->{{3.8607700696112432`*^9, 
  3.860770071749626*^9}},ExpressionUUID->"11d4575f-5edc-4b9e-a952-\
49cb8b3970d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", "-", 
     RowBox[{"spline", " ", "basis", " ", "degree"}]}], ",", " ", 
    RowBox[{"I", "-", 
     RowBox[{"spline", " ", "degree", " ", "is", " ", "deg"}], "+", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"elem", "=", "5"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "splines", " ", "in", " ", "finished", " ", 
    "basis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"knots", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "1", ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"elem", "-", "deg"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"knots", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"knots", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "deg"}], "]"}], ",", "knots", 
     ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"knots", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", "deg"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"BSplineBasis", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"deg", ",", "knots"}], "}"}], ",", "i", ",", "x"}], "]"}], 
      ",", "x"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{
       RowBox[{"Length", "[", "knots", "]"}], "-", "deg", "-", "2"}]}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReplacePart", "[", 
   RowBox[{"%", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{
        RowBox[{"BSplineBasis", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"deg", ",", "knots"}], "}"}], ",", "0", ",", "0"}], "]"}], 
        "x"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"%", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"%", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
               RowBox[{"x", "\[Rule]", "1"}]}], ")"}], "+", 
             RowBox[{
              RowBox[{"BSplineBasis", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"deg", ",", "knots"}], "}"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "knots", "]"}], "-", "deg", "-", 
                 "2"}], ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"x", "-", "1"}], ")"}]}]}], ",", 
            RowBox[{"x", ">", "1"}]}], "}"}], "}"}]}], "]"}]}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"basis", "=", 
    RowBox[{
     RowBox[{"%", "/", 
      RowBox[{"%", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}]}], 
   ")"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transform", "[", 
   RowBox[{"phi_", ",", "a_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"First", "[", "a", "]"}], "+", 
    RowBox[{"basis", ".", 
     RowBox[{"Rest", "[", "a", "]"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", "phi"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{
  3.731878182758545*^9, {3.733689392142507*^9, 3.733689403900383*^9}, {
   3.733689698950227*^9, 3.7336897221628857`*^9}, {3.733689786339237*^9, 
   3.7336897997475977`*^9}, 3.733690006683188*^9, 3.7340983797861156`*^9, {
   3.861100828193893*^9, 3.861100837735516*^9}, {3.8620615594600687`*^9, 
   3.862061559601403*^9}},
 CellLabel->
  "In[460]:=",ExpressionUUID->"5fdbeee3-3b87-438e-9e61-c3715766a2a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"geprefix", "=", "fl"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"geWD", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "\"\</Users/keitokiddo/Dropbox (UFL)/VC_revision/GE/\>\"", ",", " ", 
     "fl"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "geWD", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"schemes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<random\>\"", ",", " ", "\"\<noised\>\"", ",", " ", "\"\<mut\>\""}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.861100770748372*^9, 3.861100773480473*^9}, 
   3.865369121100561*^9},
 CellLabel->
  "In[480]:=",ExpressionUUID->"5899209d-a1d0-4587-aa85-4a53e928ffbf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pdsGEmut", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", " ", 
      RowBox[{"Length", "@", "blist"}], ",", " ", "10"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pdsGEmut", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outname", " ", "=", " ", 
        RowBox[{"StringRiffle", "[", 
         RowBox[{
          RowBox[{"ToString", "/@", 
           RowBox[{"{", 
            RowBox[{"\"\<2_16_DEN_mut\>\"", ",", 
             RowBox[{"blist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "j", ",", "2"}], "}"}]}], 
          ",", "\"\<_\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Import", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"\"\<b_#.tsv\>\"", ",", 
             RowBox[{"\"\<#\>\"", "\[Rule]", "outname"}]}], "]"}], "]"}], 
          "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Import", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"\"\<a_#.tsv\>\"", ",", 
             RowBox[{"\"\<#\>\"", "\[Rule]", "outname"}]}], "]"}], "]"}], 
          "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yhat", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Import", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"\"\<yhat_#.tsv\>\"", ",", 
             RowBox[{"\"\<#\>\"", "\[Rule]", "outname"}]}], "]"}], "]"}], 
          "]"}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"spline", "[", "x_", "]"}], ":=", 
        RowBox[{"transform", "[", 
         RowBox[{"x", ",", "a"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PossibleEffects", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", "l", "]"}], ",", "AA"}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"{", "geprefix", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", "l", "]"}], ",", 
             RowBox[{"Characters", "[", "wtAA", "]"}]}], "}"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"FactorMatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "geprefix", "}"}], ",", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", "l", "]"}], ",", 
               RowBox[{"Characters", "[", 
                RowBox[{"sequencesAA", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"trsmut", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"SortedEffects", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"PossibleEffects", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"FactorMatrix", ",", "1"}], "]"}], ",", 
                  RowBox[{"PossibleEffects", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "PossibleEffects", "]"}]}], "}"}]}], 
              "]"}]}], "}"}], "]"}], ",", "Last"}], "]"}]}], ";", 
       RowBox[{"Effects", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"SortedEffects", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"NumberQ", "/@", 
           RowBox[{"SortedEffects", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
       RowBox[{"Effects", "=", 
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"SortedEffects", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"NumberQ", "/@", 
           RowBox[{"SortedEffects", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ";", 
       RowBox[{"coeffsAll", "=", 
        RowBox[{"MapPartialVal", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"FromDigits", "[", 
               RowBox[{"#", ",", "alpha"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Effects", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;"}], "]"}], "]"}], "/.", "AAtoDigitRules"}], 
              ")"}]}], ")"}], " ", "-", "alpha", "+", "1"}], ",", 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
          RowBox[{"alpha", "*", "l"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"phige", " ", "=", " ", 
        RowBox[{"nullonehot", ".", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "coeffsAll"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"spline", "/@", "phige"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.764343899461419*^9, 3.764343910930581*^9}, 
   3.764348185798257*^9, {3.789630300570569*^9, 3.789630300761389*^9}, {
   3.789634138910524*^9, 3.789634139846402*^9}, {3.789683996589052*^9, 
   3.789683997848209*^9}, 3.789970349944776*^9, {3.8183272059557943`*^9, 
   3.818327221796135*^9}, {3.858684479129773*^9, 3.858684481552397*^9}, {
   3.860789924953223*^9, 3.860789925555484*^9}, {3.860791061585951*^9, 
   3.860791065468185*^9}, {3.865350566275476*^9, 3.865350566929714*^9}, 
   3.865351092033308*^9, {3.865367992072466*^9, 3.865367993562252*^9}, {
   3.865369083587556*^9, 3.86536910840277*^9}, {3.865612437872789*^9, 
   3.86561247356113*^9}, {3.865612547732657*^9, 3.86561254806271*^9}},
 CellLabel->
  "In[484]:=",ExpressionUUID->"2f48ffd1-a29b-44e9-9a24-a40cad90ac13"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"pdsGEmut", ">>", " ", "\"\<pdsGEmut_var_ldas_mut.m\>\""}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.789692045737999*^9, 3.78969204826326*^9}, {
   3.804504530460113*^9, 3.804504530816092*^9}, 3.860061218009576*^9, 
   3.860673274457623*^9, {3.8610975041846046`*^9, 3.861097505223379*^9}, {
   3.86536832360133*^9, 3.865368338187903*^9}, {3.865369083597315*^9, 
   3.865369083599824*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"25723b38-ff18-4218-a813-c49af2ae2372"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdsGEmut", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"wd", ",", "\"\</pdsGEmut_var_ldas_mut.m\>\""}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8604957339112787`*^9, 3.860495757111504*^9}, {
   3.860673335084087*^9, 3.860673351141374*^9}, {3.861097506938271*^9, 
   3.861097507960932*^9}, {3.865368348029627*^9, 3.86536835827011*^9}, {
   3.8653690836013813`*^9, 3.865369083603174*^9}, 3.8656119389966373`*^9, 
   3.8656123411323137`*^9},
 CellLabel->
  "In[443]:=",ExpressionUUID->"961c687f-3c7b-41c0-b2a6-7a38b59ddb58"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Combine and export", "Subsection",
 CellChangeTimes->{{3.8653691541567593`*^9, 
  3.865369157164898*^9}},ExpressionUUID->"88cc7c65-730b-4cc0-bc0f-\
a586c45e531c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pdsAll", "=", 
   RowBox[{"{", 
    RowBox[{
    "pdsVCmut", ",", "pds3waymut", ",", " ", "pds2waymut", ",", "pdsGEmut"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pdsAll", ">>", " ", "\"\<out/pdsAll_var_ldas_mut.m\>\""}], ";"}],
    "*)"}]}]}], "Input",
 CellChangeTimes->{{3.865369161098443*^9, 3.86536918318685*^9}, 
   3.865369214525597*^9, {3.8653704595225487`*^9, 3.8653704598528*^9}, 
   3.8656123296232977`*^9, 3.865613008593857*^9},
 CellLabel->
  "In[747]:=",ExpressionUUID->"a66c76a3-f969-4278-8f37-7b6b3b91873d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdsAll", "=", 
   RowBox[{"Import", "[", " ", "\"\<out/pdsAll_var_ldas_mut.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.865611969390049*^9, 3.865611976455421*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"e7284f3d-2cf7-4b84-b1ea-b54112721b7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calc MSEs", "Subsection",
 CellChangeTimes->{{3.8653690382951813`*^9, 3.8653690420546703`*^9}, 
   3.865371414410034*^9},ExpressionUUID->"fd4a7923-2c87-493a-b9bc-\
3b833b690779"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mseVCmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fslist", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"pdsAll", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"l", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "8"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"mse2waymut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fslist", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"pdsAll", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"l", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mse3waymut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fslist", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"pdsAll", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"l", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mseGEmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fslist", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"pdsAll", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"l", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "8"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.865368756565433*^9, 3.86536875835497*^9}, 
   3.865368997445075*^9, {3.865370947717185*^9, 3.8653709565696087`*^9}},
 CellLabel->
  "In[827]:=",ExpressionUUID->"77eabd28-4a8a-415b-bf16-4ecc15394a76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mseAll", "=", 
   RowBox[{"{", 
    RowBox[{
    "mseVCmut", ",", "mse3waymut", ",", "mse2waymut", ",", "mseGEmut"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.86536897469913*^9, 3.865368993507749*^9}},
 CellLabel->
  "In[831]:=",ExpressionUUID->"93fad6d2-7f2a-4c1a-b078-6a173b3188c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mseAll", "//", "Dimensions"}]], "Input",
 CellLabel->
  "In[832]:=",ExpressionUUID->"f27c0136-8341-4349-8d7c-59b36d843218"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4", ",", "17", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.8653690055559263`*^9, 3.8653708666666*^9, 
  3.8653710991832037`*^9, 3.8656130175927563`*^9, 3.865625905914978*^9},
 CellLabel->
  "Out[832]=",ExpressionUUID->"b49fc87d-cddb-47d2-84c0-a9e7928e0d90"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calc MSEs", "Subsection",
 CellChangeTimes->{{3.8653690382951813`*^9, 3.8653690420546703`*^9}, 
   3.865371414410034*^9},ExpressionUUID->"c2525d8e-9722-482c-bb71-\
0c691b44381b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mseVCmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fslist", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"pdsAll", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"l", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "8"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"mse2waymut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fslist", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"pdsAll", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"l", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mse3waymut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fslist", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"pdsAll", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"l", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mseGEmut", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"mse", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fslist", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"pdsAll", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"tstbyD", "[", 
          RowBox[{"[", "d", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"l", "+", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.865368756565433*^9, 3.86536875835497*^9}, 
   3.865368997445075*^9, {3.865370947717185*^9, 3.8653709565696087`*^9}, {
   3.865626171992696*^9, 3.865626196024248*^9}, {3.86562678674256*^9, 
   3.865626793436265*^9}, 3.86562714280923*^9, {3.865627185391954*^9, 
   3.865627199954339*^9}},
 CellLabel->
  "In[1104]:=",ExpressionUUID->"96ae7372-72b2-4b67-8425-ae2b10519c6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stds", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StandardDeviation", "/@", 
      RowBox[{"mse2waymut", "[", 
       RowBox[{"[", 
        RowBox[{"k", ",", 
         RowBox[{"1", ";;"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.865627335399742*^9, 3.865627337826852*^9}},
 CellLabel->
  "In[1110]:=",ExpressionUUID->"0119177b-170e-4dea-97b1-8dea43fa73ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stds", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"StandardDeviation", "/@", 
      RowBox[{"mse2waymut", "[", 
       RowBox[{"[", 
        RowBox[{"k", ",", 
         RowBox[{"1", ";;"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.865627359376479*^9},
 CellLabel->
  "In[1111]:=",ExpressionUUID->"c39e32cb-db79-48e8-8939-9331d20cb8b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stds", "=", 
   RowBox[{".5", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StandardDeviation", "/@", 
         RowBox[{"mse2waymut", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", 
            RowBox[{"1", ";;"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "4"}], "}"}]}], "]"}], "+", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StandardDeviation", "/@", 
         RowBox[{"mse3waymut", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", 
            RowBox[{"1", ";;"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stds", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", 
      RowBox[{"11", ";;"}]}], "]"}], "]"}], "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8656266700081997`*^9, 3.8656267048833437`*^9}, {
   3.8656267578253202`*^9, 3.8656267776194897`*^9}, {3.865626929296612*^9, 
   3.865626929984622*^9}, {3.865627097075962*^9, 3.8656271016806393`*^9}, {
   3.865627222132433*^9, 3.865627223490089*^9}, 3.865627376625813*^9},
 CellLabel->
  "In[1112]:=",ExpressionUUID->"0654aa40-23e6-4ce6-a4f8-a53a8d3cf4f9"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mseGEmut", "[", 
     RowBox[{"[", 
      RowBox[{"k", ",", "d", ",", "2"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"mseGEmut", "[", 
      RowBox[{"[", 
       RowBox[{"k", ",", "d", ",", "2"}], "]"}], "]"}], "+", " ", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", 
        RowBox[{"stds", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "d"}], "]"}], "]"}]}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "5", ",", "l"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.865626816457979*^9, 3.865626842300748*^9}, {
  3.865626886365253*^9, 3.8656269674965763`*^9}},
 CellLabel->
  "In[1114]:=",ExpressionUUID->"2953fb90-d997-4fa0-bead-6b8e3819de5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mseAll", "=", 
   RowBox[{"{", 
    RowBox[{
    "mseVCmut", ",", "mse3waymut", ",", "mse2waymut", ",", "mseGEmut"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.86536897469913*^9, 3.865368993507749*^9}},
 CellLabel->
  "In[1254]:=",ExpressionUUID->"167879e3-4499-40db-8ff2-c55f6fbd9f67"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mseAll", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "4"}], "]"}], "]"}], " ", "=", 
   RowBox[{
    RowBox[{"results", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "2", ",", "3"}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "}"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8656278816865396`*^9, 3.865627900541832*^9}, {
  3.865627938633025*^9, 3.865627994464806*^9}, {3.865628072838133*^9, 
  3.865628110394153*^9}},
 CellLabel->
  "In[1256]:=",ExpressionUUID->"c9f84799-34c5-4b15-9c36-0d6fd4d5f4ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting functions", "Subsection",
 CellChangeTimes->{{3.8646739228499813`*^9, 
  3.864673925131969*^9}},ExpressionUUID->"69172085-aef1-4261-95ec-\
69ace37ff409"],

Cell[BoxData[
 RowBox[{
  RowBox[{"errorplotdat", "[", "data_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "means", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"means", "=", 
      RowBox[{"Mean", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Around", "[", 
        RowBox[{
         RowBox[{"means", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Quantile", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", ".025"}], "]"}],
             "-", 
            RowBox[{"means", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Quantile", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", ".975"}], "]"}],
             "-", 
            RowBox[{"means", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "data", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8638653341239157`*^9, 3.863865387503077*^9}},
 CellLabel->
  "In[504]:=",ExpressionUUID->"18c1c4f8-0a45-4b6d-8f7b-0073d3d79ba4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"summaryfig3", "[", 
   RowBox[{
   "lambdas_", ",", "lambdaspos_", ",", "  ", "alpha_", ",", " ", "l_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"wkd", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"alpha", ",", "l", ",", " ", "k", ",", "d"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "0", ",", "l"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"multiplicities", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Binomial", "[", 
          RowBox[{"l", ",", "k"}], "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", "-", "1"}], ")"}], "^", "k"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"rho", " ", "prior"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rho", " ", "=", " ", 
      RowBox[{
       RowBox[{"wkd", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"2", ";;"}]}], "]"}], "]"}], ".", 
       RowBox[{"Rest", "[", "lambdas", "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"plotdat", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "l"}], "]"}], ",", 
         RowBox[{"Nbyfirst", "[", "rho", "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"figrho", "=", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{"plotdat", ",", "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameStyle", "\[Rule]", "fstyle"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Hamming Distance\>\"", ",", 
             RowBox[{"ToString", "[", "\[Rho]", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"-", ".5"}], ",", "1", ",", ".2"}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1.", "\[Rule]", "1"}], ",", 
                  RowBox[{"0.", "\[Rule]", "0"}]}], "}"}]}], ",", "None"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"0", ",", "l", ",", "1"}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"0.", "\[Rule]", "0"}], "}"}]}], ",", "None"}], 
              "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AxesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", "Dashed"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"GrayLevel", "[", ".5", "]"}], ",", " ", "thicksum"}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"FontSize", "\[Rule]", "fontsize"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", ".75"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"l", "+", ".2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", ".7"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{"plotdat", ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", "Gray", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"rho", " ", "posterior"}], "*)"}], "\n", 
     RowBox[{"rhopos", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Nbyfirst", "[", 
         RowBox[{
          RowBox[{"wkd", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"2", ";;"}]}], "]"}], "]"}], ".", 
          RowBox[{"Rest", "[", 
           RowBox[{"lambdaspos", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "lambdaspos", "]"}]}], "}"}]}], "]"}]}], ";",
      "\n", 
     RowBox[{"plotdat", "=", 
      RowBox[{"errorplotdat", "[", "rhopos", "]"}]}], ";", "\n", 
     RowBox[{"figrhopos", " ", "=", " ", 
      RowBox[{"Show", "[", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"plotdat", ",", 
         RowBox[{"DataRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "l"}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", "Transparent", "}"}]}], ",", 
         RowBox[{"IntervalMarkersStyle", "\[Rule]", "barstyle"}], ",", 
         RowBox[{"Joined", "\[Rule]", "False"}]}], "]"}], "]"}]}], ";", "\n", 
     
     RowBox[{"(*", 
      RowBox[{"vc", " ", "prior"}], "*)"}], "\n", 
     RowBox[{"vc", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "l"}], "]"}], ",", 
         RowBox[{"Nbysum", "[", 
          RowBox[{
           RowBox[{"Rest", "@", "lambdas"}], "*", 
           RowBox[{"Rest", "@", "multiplicities"}]}], "]"}]}], "}"}]}]}], ";",
      "\n", 
     RowBox[{"figvcBar", "=", 
      RowBox[{"BarChart", "[", 
       RowBox[{
        RowBox[{"vc", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"ChartLabels", "\[Rule]", 
         RowBox[{"vc", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Interaction order\>\"", ",", "\"\<Variance explained\>\""}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "1", ",", ".1"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"0.", "\[Rule]", "0"}], "}"}]}], ",", "None"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "l", ",", "1"}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"FrameStyle", "\[Rule]", "fstyle"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"FontSize", "\[Rule]", "fontsize"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChartStyle", "\[Rule]", 
         RowBox[{"GrayLevel", "[", ".7", "]"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{".5", ",", 
             RowBox[{"l", "+", ".5"}]}], "}"}], ",", "All"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", ".75"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"vc", " ", "posterior"}], "*)"}], "\n", 
     RowBox[{"vcpos", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Nbysum", "[", 
         RowBox[{
          RowBox[{"Rest", "@", 
           RowBox[{"lambdaspos", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "*", 
          RowBox[{"Rest", "@", "multiplicities"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "lambdaspos", "]"}]}], "}"}]}], "]"}]}], ";",
      "\n", 
     RowBox[{"plotdat", " ", "=", " ", 
      RowBox[{"errorplotdat", "[", "vcpos", "]"}]}], ";", "\n", 
     RowBox[{"figvcpos", " ", "=", " ", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"plotdat", ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "l"}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", "Transparent", "}"}]}], ",", 
          RowBox[{"IntervalMarkersStyle", "\[Rule]", "barstyle"}], ",", 
          RowBox[{"Joined", "\[Rule]", "False"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"plotdat", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "l"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Transparent", ",", "thicksum"}], "}"}]}]}], "]"}]}], 
       "]"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"Gamma", " ", "Prior"}], "*)"}], "\n", 
     RowBox[{"ck", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "^", "k"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", "q"}], " ", 
           RowBox[{"Binomial", "[", 
            RowBox[{"k", ",", "q"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "0", ",", "l"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"mk", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PadLeft", "[", 
            RowBox[{
             RowBox[{"ck", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"l", "+", "d"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"l", "+", "1"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "1", ",", 
            RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"l", "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"gammak", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mk", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ".", "wkd", ".", "lambdas"}], 
         ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "mk", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"gammak", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gammak", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"l", "+", "1", "-", "k"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"gammak", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mk", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ".", "rho"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "mk", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"gammak", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gammak", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"l", "+", "1", "-", "k"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"k", "=", "1"}], ";", "\n", 
     RowBox[{"figgamma", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "plotdat", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plotdat", "=", 
            RowBox[{"Transpose", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"gammak", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "]"}], "-", 
                  "1"}]}], "]"}], ",", 
               RowBox[{"Nbyfirst", "[", 
                RowBox[{"gammak", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
              RowBox[{"plotdat", ",", "\[IndentingNewLine]", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FrameLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Hamming Distance\>\"", ",", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{
                    RowBox[{"greekletter", "[", "Gamma", "]"}], ",", 
                    RowBox[{"ToString", "[", "k", "]"}]}], "]"}]}], "}"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"FrameTicks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "2", ",", ".2"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.", "\[Rule]", "0"}], ",", 
                    RowBox[{"1.", "\[Rule]", "1"}]}], "}"}]}], ",", "None"}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "l", ",", "1"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"0.", "\[Rule]", "0"}], "}"}]}], ",", "None"}], 
                   "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Axes", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AxesStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Gray", ",", "Dashed"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"BaseStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"FontSize", "\[Rule]", "fontsize"}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"GrayLevel", "[", ".5", "]"}], ",", " ", 
                  "thicksum"}], "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AspectRatio", "\[Rule]", ".75"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FrameStyle", "\[Rule]", "fstyle"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"l", "+", ".2"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", ".12"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
              RowBox[{"plotdat", ",", "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", "Gray", "}"}]}]}], "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"Gamma", " ", "posterior"}], "*)"}], "\n", 
     RowBox[{"gamma1pos", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Most", "[", 
         RowBox[{
          RowBox[{"mk", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ".", 
          RowBox[{"rhopos", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "rhopos", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\n", 
     RowBox[{"gamma1pos", " ", "=", " ", 
      RowBox[{"Nbyfirst", "/@", "gamma1pos"}]}], ";", "\n", 
     RowBox[{"plotdat", " ", "=", " ", 
      RowBox[{"errorplotdat", "[", "gamma1pos", "]"}]}], ";", "\n", 
     RowBox[{"figgamma1pos", " ", "=", " ", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"plotdat", ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"l", "-", "1"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"GrayLevel", "[", ".25", "]"}], "}"}]}], ",", 
          RowBox[{"IntervalMarkersStyle", "\[Rule]", "barstyle"}], ",", 
          RowBox[{"Joined", "\[Rule]", "False"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"plotdat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", ";;"}], ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"l", "-", "1"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"GrayLevel", "[", ".25", "]"}], ",", " ", "thicksum"}], 
            "}"}]}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{"figrho", ",", "figrhopos"}], "]"}], ",", 
       RowBox[{"Show", "[", 
        RowBox[{"figvcBar", ",", "figvcpos"}], "]"}], ",", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"figgamma", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "figgamma1pos"}], "]"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8646702623357563`*^9, 3.864670265002715*^9}, {
   3.864670401119231*^9, 3.864670407591425*^9}, {3.864670502142104*^9, 
   3.864670504154998*^9}, {3.8646712478754*^9, 3.864671251614146*^9}, {
   3.864672410209917*^9, 3.864672411675102*^9}, {3.864672481476121*^9, 
   3.864672484025909*^9}, 3.864672553470872*^9, {3.864672585727613*^9, 
   3.864672592299716*^9}, {3.864762775098572*^9, 3.864762789973587*^9}, {
   3.8647628391287413`*^9, 3.864762852431864*^9}},
 CellLabel->
  "In[505]:=",ExpressionUUID->"15e958aa-1912-43d3-8946-db5de560a7e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MSEbyD", "[", "input_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotdat", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Around", "[", 
           RowBox[{"d", ",", "0"}], "]"}], ",", 
          RowBox[{"Around", "[", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{
              RowBox[{"input", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"d", "+", "1"}], "]"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{".5", 
             RowBox[{"StandardDeviation", "[", 
              RowBox[{
               RowBox[{"input", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"d", "+", "1"}], "]"}], "]"}], "]"}]}]}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "dmin", ",", "l"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
       RowBox[{"plotdat", ",", "\[IndentingNewLine]", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"FontSize", "\[Rule]", "fontsize"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Adjust", " ", "Plot", " ", "Range"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"l", "+", ".2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{".001", ",", " ", "20"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", "style"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FrameStyle", "\[Rule]", "fstyle"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "False"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "l"}], "]"}], ",", "False"}], "}"}]}], 
          "}"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Hamming Distance to WT\>\"", ",", 
           "\"\<Scaled out-of-sample MSE\>\""}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"LineLegend", "[", 
            RowBox[{"Automatic", ",", "modellabs", ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
                RowBox[{"GrayLevel", "[", ".4", "]"}]}], "}"}]}], ",", 
             RowBox[{"Spacings", "\[Rule]", ".2"}], ",", 
             RowBox[{"LegendMargins", "\[Rule]", "0"}]}], "]"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{".77", ",", ".3"}], "}"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Gray", ",", "Dashed"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8646560844175053`*^9, 3.8646561249518833`*^9}, 
   3.864673891512858*^9, {3.8646750761346292`*^9, 3.864675076605534*^9}, {
   3.864722544059005*^9, 3.864722545150584*^9}, {3.864731993595418*^9, 
   3.86473201642272*^9}, {3.864732085520281*^9, 3.864732099353478*^9}, 
   3.8647321383388453`*^9, {3.864732267849403*^9, 3.8647322715109987`*^9}, {
   3.864760562760141*^9, 3.864760591696772*^9}, {3.865080967812779*^9, 
   3.8650809803644114`*^9}, {3.865081153294825*^9, 3.865081171361723*^9}, {
   3.865081890499444*^9, 3.865081968333646*^9}, {3.865082101703068*^9, 
   3.865082102316148*^9}, {3.865369512652626*^9, 3.865369532544545*^9}, {
   3.86562886069515*^9, 3.865628861931129*^9}, {3.86562890807742*^9, 
   3.8656289087192793`*^9}},
 CellLabel->
  "In[1292]:=",ExpressionUUID->"4c6bb97d-3dc8-44c5-9bac-8ca55cc91828"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting parameters", "Subsection",
 CellChangeTimes->{{3.8647315170628443`*^9, 
  3.864731519359935*^9}},ExpressionUUID->"dbd1ffc2-a91a-43db-b5ca-\
c3ae0901f0d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"blue", "=", 
   RowBox[{"RGBColor", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "112", ",", "176"}], "}"}], "/", "255"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lightblue", "=", 
   RowBox[{"RGBColor", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"116", ",", "169", ",", "207"}], "}"}], "/", "255"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"GrayLevel", "[", ".7", "]"}], ",", 
      RowBox[{"RGBColor", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"116", ",", "196", ",", "118"}], "}"}], "/", "255"}], 
        ")"}]}], ",", 
      RowBox[{"Lighter", "[", 
       RowBox[{"lightblue", ",", ".2"}], "]"}], ",", 
      RowBox[{"Darker", "[", 
       RowBox[{"blue", ",", ".2"}], "]"}], ",", "Black"}], "}"}], "//", 
    "Reverse"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"style", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"Thickness", "[", ".005", "]"}], ",", 
       RowBox[{"PointSize", "[", "pt", "]"}]}], "}"}], "&"}], "/@", 
    "colors"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8653698907458563`*^9, 3.865369989911497*^9}, 
   3.8653700335115023`*^9, {3.865370074634922*^9, 3.865370077067986*^9}, {
   3.865370193468823*^9, 3.865370193784131*^9}, {3.865370235341741*^9, 
   3.865370291769383*^9}},
 CellLabel->
  "In[507]:=",ExpressionUUID->"f225f713-a710-4418-acac-42f110247960"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontsize", "=", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barstyle", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<FenceStyle\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", ".25", "]"}], ",", " ", 
        RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "}"}]}], ",", 
     RowBox[{"\"\<FenceWidth\>\"", "\[Rule]", 
      RowBox[{"Scaled", "[", ".4", "]"}]}], ",", 
     RowBox[{"\"\<WhiskerStyle\>\"", "\[Rule]", "Black"}]}], "|>"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"fstyle", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"GrayLevel", "[", ".3", "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "}"}], ",", "4"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt", "=", ".2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thicksum", "=", 
   RowBox[{"Thickness", "[", 
    RowBox[{"Scaled", "[", ".007", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2ErrorBarStyle", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"Thickness", "[", 
        RowBox[{"Scaled", "[", ".004", "]"}], "]"}], ",", 
       RowBox[{"PointSize", "[", "pt", "]"}]}], "}"}], "&"}], "/@", 
    "colors"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8638648459267683`*^9, 3.8638648504300127`*^9}, {
   3.863864966529997*^9, 3.863865027078575*^9}, {3.8638651899088717`*^9, 
   3.863865190355195*^9}, {3.8638652449575872`*^9, 3.863865257373385*^9}, {
   3.863865288050932*^9, 3.863865288291458*^9}, 3.863865402823461*^9, {
   3.8638659680223217`*^9, 3.863865971877446*^9}, {3.86386603083392*^9, 
   3.8638660483050222`*^9}, {3.863866131997141*^9, 3.863866133344693*^9}, {
   3.8638661793551683`*^9, 3.863866259500696*^9}, {3.863866587311494*^9, 
   3.863866615788569*^9}, {3.863866690846753*^9, 3.8638668169308767`*^9}, {
   3.863866853345908*^9, 3.863866854090028*^9}, {3.8638670259804287`*^9, 
   3.86386703983851*^9}, {3.863876761571938*^9, 3.86387676204672*^9}, 
   3.8638800130321283`*^9, {3.863885046534562*^9, 3.863885046690586*^9}, {
   3.86388508488948*^9, 3.8638850851694927`*^9}, {3.863885183671919*^9, 
   3.863885184773384*^9}, {3.863887507626361*^9, 3.863887508726385*^9}, 
   3.86389122497291*^9, {3.86390636918985*^9, 3.863906371478818*^9}, {
   3.864330169535236*^9, 3.864330175121416*^9}, {3.8644724631544952`*^9, 
   3.864472479716865*^9}, {3.8647315364640627`*^9, 3.864731537599876*^9}, {
   3.864732171626499*^9, 3.864732174900908*^9}, {3.864762942370368*^9, 
   3.86476296405698*^9}, {3.865628528390278*^9, 3.865628553110924*^9}},
 CellLabel->
  "In[1275]:=",ExpressionUUID->"4a832b22-9ce0-452d-9343-91506bcd8f5c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelnames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<VC regression\>\"", ",", "\"\<Three-way\>\"", ",", 
     "\"\<Pairwise\>\"", ",", "\"\<Global epistasis\>\"", ",", 
     "\"\<Additive\>\""}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modellabs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"#", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], "&"}],
     "/@", "modelnames"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.863867723325692*^9, 3.863867735227269*^9}, 
   3.863867766051382*^9},
 CellLabel->
  "In[517]:=",ExpressionUUID->"003d22c5-c72d-404c-a902-1c087b27b551"],

Cell[BoxData[
 RowBox[{
  RowBox[{"labelfigs", "[", "figs_", "]"}], ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"figs", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"FromCharacterCode", "[", 
            RowBox[{"64", "+", "i"}], "]"}], ",", "Bold", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "fontsize"}]}], "]"}], ",", 
         RowBox[{"ImageScaled", "@", 
          RowBox[{"{", 
           RowBox[{"0.02", ",", ".95"}], "}"}]}]}], "]"}]}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"65", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"60", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "figs", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.863865624725505*^9, 3.863865642686795*^9}, {
  3.863865746432486*^9, 3.863865757435791*^9}, {3.863865918531287*^9, 
  3.863865919882951*^9}, {3.863866342570672*^9, 3.863866343410007*^9}, {
  3.86389151788904*^9, 3.863891573048431*^9}, {3.8643303188001842`*^9, 
  3.864330359453127*^9}, {3.8643303900397987`*^9, 3.864330396512867*^9}, {
  3.8643304271087523`*^9, 3.86433043883956*^9}, {3.8643305728061857`*^9, 
  3.8643305770534163`*^9}, {3.864330804938683*^9, 3.864330805094264*^9}, {
  3.8644211835484858`*^9, 3.864421183710381*^9}},
 CellLabel->
  "In[519]:=",ExpressionUUID->"42579d9a-30bc-448d-8677-72823c1a2d0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"labelfigs", "[", 
   RowBox[{"fig_", ",", "lab_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{"fig", ",", " ", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"lab", ",", "Bold", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}]}], "]"}], ",", 
       RowBox[{"ImageScaled", "@", 
        RowBox[{"{", 
         RowBox[{".04", ",", ".95"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"80", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "20"}], "}"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8638726148998413`*^9, 3.863872660227022*^9}, {
  3.864330250741309*^9, 3.864330250943153*^9}, {3.864330301390695*^9, 
  3.864330316457778*^9}},
 CellLabel->
  "In[520]:=",ExpressionUUID->"a2f1e743-f563-4162-bf1c-cd6a67cbf65d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"labelfigspad", "[", 
   RowBox[{"fig_", ",", "lab_", ",", "pad_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{"fig", ",", " ", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"lab", ",", "Bold", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}]}], "]"}], ",", 
       RowBox[{"ImageScaled", "@", 
        RowBox[{"{", 
         RowBox[{".04", ",", ".95"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", "pad"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.863872583482319*^9, 3.8638726037893457`*^9}, {
  3.8638726659450502`*^9, 3.863872696824041*^9}},
 CellLabel->
  "In[521]:=",ExpressionUUID->"2698bda2-af0e-4246-addc-d1beca36d4fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting", "Subsection",
 CellChangeTimes->{{3.864673914022478*^9, 
  3.86467391500624*^9}},ExpressionUUID->"9c37c51d-c62b-405a-b356-\
ef1ffd98d871"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vcsAll", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", "l", "]"}], ",", 
         RowBox[{"Nbysum", "[", 
          RowBox[{
           RowBox[{"Rest", "@", "mks"}], "*", 
           RowBox[{"lambdaslist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "blist"}]}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8646698745670643`*^9, 3.864669891837206*^9}, {
   3.8646699338054247`*^9, 3.864669935559827*^9}, 3.8646702987720346`*^9, {
   3.864739867179492*^9, 3.864739867580496*^9}, 3.864751139172888*^9},
 CellLabel->
  "In[1293]:=",ExpressionUUID->"574773c7-28ef-40ef-9aa1-f796e70e8d47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"labs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<         \>\"", ",", 
         RowBox[{"FromCharacterCode", "[", 
          RowBox[{"63", "+", "i"}], "]"}]}], "]"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "18"}], ",", "Bold"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8647631801487637`*^9, 3.8647631966677017`*^9}, {
  3.8647632394412003`*^9, 3.8647632662039948`*^9}, {3.864763312692499*^9, 
  3.864763338588665*^9}, {3.8656130793969097`*^9, 3.865613166717187*^9}, {
  3.865613264009946*^9, 3.865613291606056*^9}, {3.865614777397293*^9, 
  3.865614778454723*^9}},
 CellLabel->
  "In[1294]:=",ExpressionUUID->"4460d991-c03f-45f2-bc65-4da69cb01057"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GraphicsColumn", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"summaryfig3", "[", 
           RowBox[{
            RowBox[{"PadLeft", "[", 
             RowBox[{
              RowBox[{"lambdaslist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "17"}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PadLeft", "[", 
                RowBox[{
                 RowBox[{"lambdaslist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "17"}], "]"}], " ", 
               "+", " ", 
               RowBox[{"RandomVariate", "[", 
                RowBox[{
                 RowBox[{"NormalDistribution", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"10", "^", 
                    RowBox[{"-", "7"}]}]}], "]"}], ",", "17"}], "]"}]}], ",", 
              "10"}], "]"}], ",", "  ", "2", ",", " ", "16"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"MSEbyD", "[", 
           RowBox[{"mseAll", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Spacings", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", "0"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"plotslabed", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{"plots", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"labs", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "Top"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"Length", "@", "blist"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"plotsAllPanels", "=", "plotslabed"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"figpath", ",", "\"\</fig_varying_ldas_1h.pdf\>\""}], "]"}], ",",
     " ", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", "plotsAllPanels", "}"}], ",", 
      RowBox[{"Spacings", "\[Rule]", 
       RowBox[{"-", "1"}]}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.864669702648554*^9, 3.864669706485413*^9}, {
   3.8646697660413*^9, 3.864669780635819*^9}, {3.86466983432541*^9, 
   3.864669836704953*^9}, {3.864670595198862*^9, 3.864670661430623*^9}, {
   3.86467120063557*^9, 3.864671201025215*^9}, {3.864672567628706*^9, 
   3.864672567782928*^9}, {3.8646726533160257`*^9, 3.864672714057366*^9}, {
   3.864673285774921*^9, 3.8646733242109528`*^9}, {3.86467367652321*^9, 
   3.864673696795602*^9}, 3.864674366743204*^9, 3.864722553484879*^9, {
   3.8647307850044107`*^9, 3.8647308669598083`*^9}, 3.8647309016954308`*^9, {
   3.86473096960686*^9, 3.864730970986595*^9}, {3.864731032804344*^9, 
   3.8647310461115007`*^9}, 3.8647311298398933`*^9, 3.864732115643752*^9, {
   3.864739903130884*^9, 3.864739904727029*^9}, {3.864739949551832*^9, 
   3.8647399758602333`*^9}, {3.8647400174666023`*^9, 3.864740017800312*^9}, {
   3.8647400754708147`*^9, 3.864740075920497*^9}, 3.864740137020759*^9, {
   3.86474017947427*^9, 3.864740185674089*^9}, {3.8647627212341433`*^9, 
   3.8647627430116034`*^9}, {3.864763030430483*^9, 3.86476307601649*^9}, {
   3.864763274952485*^9, 3.864763296601368*^9}, {3.8650821599991913`*^9, 
   3.865082163705559*^9}, 3.8653684516394663`*^9, {3.865369381352441*^9, 
   3.8653693948334427`*^9}, {3.8653696105026207`*^9, 
   3.8653696758869457`*^9}, {3.865625117850305*^9, 3.865625122911399*^9}, 
   3.865628154257948*^9, 3.8656288693719053`*^9},
 CellLabel->
  "In[1295]:=",ExpressionUUID->"bbba3472-20d4-4a8b-916c-cb3cb20ee51c"]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Kernel 2",
WindowSize->{1207, 1039},
WindowMargins->{{23, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"23e6fb09-a84c-4376-961a-bbea89f34018"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 495, 12, 73, "Input",ExpressionUUID->"65e6797d-a1d1-45db-9357-e2c3684ec1eb"],
Cell[CellGroupData[{
Cell[1078, 36, 155, 3, 67, "Section",ExpressionUUID->"ad62342b-c7d6-4a26-97bb-2c41d4bf0427"],
Cell[1236, 41, 824, 21, 136, "Input",ExpressionUUID->"29b24c93-058c-4a24-8f72-6c1c767ddcde"],
Cell[2063, 64, 234, 5, 30, "Input",ExpressionUUID->"adbc12e5-08aa-4f0e-9e30-161f6ce219d6"],
Cell[2300, 71, 687, 17, 94, "Input",ExpressionUUID->"797bf748-2c1a-4c16-af0c-dec6f1e9243e"],
Cell[2990, 90, 3667, 104, 241, "Input",ExpressionUUID->"10d7466e-68a0-47ac-a8dd-32582f48fe1b"],
Cell[CellGroupData[{
Cell[6682, 198, 1865, 51, 199, "Input",ExpressionUUID->"9609ba0b-5065-43b9-b93b-9f027b4a5675"],
Cell[8550, 251, 511, 9, 34, "Output",ExpressionUUID->"4c3e5f59-e0b0-4208-8169-4a306c32cb9c"]
}, Open  ]],
Cell[9076, 263, 962, 27, 52, "Input",ExpressionUUID->"63702d8c-e7f6-4dde-ae01-eaadef5d2aa5"],
Cell[CellGroupData[{
Cell[10063, 294, 186, 3, 45, "Subsubsection",ExpressionUUID->"c497734e-1990-4e31-a2d5-e19708cb2153"],
Cell[10252, 299, 361, 9, 30, "Input",ExpressionUUID->"d1ed462f-c6b4-4c08-858f-e6ef3f365843"],
Cell[10616, 310, 686, 16, 30, "Input",ExpressionUUID->"0c4ce9f4-8281-4575-a038-d1646b9892ea"],
Cell[11305, 328, 2451, 69, 73, "Input",ExpressionUUID->"bc5ac5cc-5c3f-4287-8626-1120ef3c8cc3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13805, 403, 180, 3, 67, "Section",ExpressionUUID->"04cb7407-0d30-4d65-a0ba-01f6a2900c5d"],
Cell[CellGroupData[{
Cell[14010, 410, 216, 4, 54, "Subsection",ExpressionUUID->"c9f9dee3-8ccd-48a2-800a-a52cc44df806"],
Cell[14229, 416, 714, 18, 94, "Input",ExpressionUUID->"4fb73e55-73a4-4671-9e44-d6364650b46d"],
Cell[14946, 436, 293, 8, 30, "Input",ExpressionUUID->"25482e5e-0350-4e7f-871e-7f8ba1dc2d4a"],
Cell[15242, 446, 505, 14, 30, "Input",ExpressionUUID->"c4223de9-de58-4a25-8d8e-c2da8746390c"],
Cell[15750, 462, 520, 16, 30, "Input",ExpressionUUID->"24d4d6e9-7690-447b-b026-13e9ac72c9ea"],
Cell[16273, 480, 542, 16, 52, "Input",ExpressionUUID->"4c2fe180-a868-4282-ab7e-e06f35fb989c"],
Cell[16818, 498, 377, 10, 30, "Input",ExpressionUUID->"83eeb6ff-0bfb-4dcb-992f-56e8e1e2dfc9"],
Cell[17198, 510, 3819, 100, 346, "Input",ExpressionUUID->"07ea8555-eaf9-477f-9b06-87136b618e03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21054, 615, 167, 3, 54, "Subsection",ExpressionUUID->"8c8c54fc-f083-4870-8df0-be86fd1e7911"],
Cell[21224, 620, 618, 19, 30, "Input",ExpressionUUID->"8b20b395-c9f1-4828-9664-cdde048827a3"],
Cell[21845, 641, 1179, 32, 52, "Input",ExpressionUUID->"100f8f09-9a0c-4129-a597-a77be23b0a8e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23061, 678, 215, 3, 54, "Subsection",ExpressionUUID->"53172956-902f-4d24-afcb-3ea8dafacd7f"],
Cell[23279, 683, 13104, 351, 1171, "Input",ExpressionUUID->"5cc24969-21b3-4336-a3ec-d5caf85c5fe0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36420, 1039, 172, 3, 54, "Subsection",ExpressionUUID->"23ae7f70-c839-4d45-8d28-a8b790d3a79e"],
Cell[36595, 1044, 2753, 82, 157, "Input",ExpressionUUID->"0fb3cd10-da75-4073-aa3f-bcd0c03af95f"],
Cell[39351, 1128, 14742, 381, 912, "Input",ExpressionUUID->"f3ada5ae-4744-44aa-9a60-73cc15cb17fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54130, 1514, 169, 3, 54, "Subsection",ExpressionUUID->"fccc6f40-a702-4436-8a48-7c22e5bdfe7d"],
Cell[54302, 1519, 1452, 45, 109, "Input",ExpressionUUID->"d2ba0fac-69ec-42c4-b045-7bd83b7ad0d0"],
Cell[55757, 1566, 18102, 498, 1402, "Input",ExpressionUUID->"ceb50137-4fbd-4778-b89e-82abccde9726"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73896, 2069, 166, 3, 54, "Subsection",ExpressionUUID->"ee0ebf8d-865a-40a2-85c5-9f1907195673"],
Cell[74065, 2074, 3099, 83, 136, "Input",ExpressionUUID->"cfb3bb97-0353-4da4-a1d8-1e0ca7fdc894"],
Cell[77167, 2159, 293, 8, 30, "Input",ExpressionUUID->"c7203ad3-ba53-4a97-80a6-61db050a8c70"],
Cell[77463, 2169, 1821, 48, 73, "Input",ExpressionUUID->"68f32206-4076-4648-9ac5-194e47c3a5f8"],
Cell[79287, 2219, 354, 10, 30, "Input",ExpressionUUID->"4a78dfcf-d9e0-4dc9-8a80-70c425aed3c5"],
Cell[79644, 2231, 867, 24, 30, "Input",ExpressionUUID->"6ccfe432-d605-4b5a-a030-6d4f0968a37b"],
Cell[80514, 2257, 940, 25, 73, "Input",ExpressionUUID->"9bdd879d-733a-4ceb-baf1-1efa074392f0"],
Cell[81457, 2284, 834, 22, 52, "Input",ExpressionUUID->"c2530ef8-12d8-454d-b5c1-c156bbba6fd0"],
Cell[82294, 2308, 4258, 116, 283, "Input",ExpressionUUID->"a5ecd0ff-4b39-49f3-90dc-529cb37be6b3"],
Cell[CellGroupData[{
Cell[86577, 2428, 861, 25, 52, "Input",ExpressionUUID->"2fe95719-6a7c-4395-ab71-ec6eedc032b1"],
Cell[87441, 2455, 540, 10, 70, "Output",ExpressionUUID->"3b1b5b42-d5ec-49fa-98e7-53bbf8f7b0ca"]
}, Open  ]],
Cell[87996, 2468, 730, 21, 30, "Input",ExpressionUUID->"be3ca3ef-a590-4002-b8ac-e3d44fcb9f4b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[88775, 2495, 274, 5, 53, "Section",ExpressionUUID->"4ef02cac-1e69-4e1d-9e36-d1be7cd31bdb"],
Cell[CellGroupData[{
Cell[89074, 2504, 198, 3, 54, "Subsection",ExpressionUUID->"d383af68-d841-4e8e-bc72-c2e57e194a20"],
Cell[89275, 2509, 220, 5, 30, "Input",ExpressionUUID->"c1e9e82b-2193-4613-8e4d-2d6cceb29213"],
Cell[89498, 2516, 727, 23, 30, "Input",ExpressionUUID->"4156d6c4-2c5a-4bc5-bf26-d744562c286f"],
Cell[CellGroupData[{
Cell[90250, 2543, 181, 3, 30, "Input",ExpressionUUID->"e7fa40ff-baa2-4545-9477-3cc4efc93a7d"],
Cell[90434, 2548, 704, 13, 60, "Output",ExpressionUUID->"96e22f32-4bcb-4175-b233-d6ed7f446568"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91175, 2566, 387, 9, 30, "Input",ExpressionUUID->"003983c7-6b96-4b09-a74a-44c8f2280161"],
Cell[91565, 2577, 221, 4, 34, "Output",ExpressionUUID->"a5c7e72b-654d-45b7-9139-b35dca180148"]
}, Open  ]],
Cell[91801, 2584, 563, 12, 30, "Input",ExpressionUUID->"400543bc-706e-4866-87ec-f3b1f866bd21"],
Cell[92367, 2598, 697, 19, 30, "Input",ExpressionUUID->"191d32e5-3c55-4a80-8741-7146296f4d95"],
Cell[CellGroupData[{
Cell[93089, 2621, 120, 2, 30, "Input",ExpressionUUID->"02fb049e-bb93-4e52-b7bc-9591de114fc4"],
Cell[93212, 2625, 3169, 68, 196, "Output",ExpressionUUID->"1922cdca-4c02-4de8-aedf-3816d0eca057"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96418, 2698, 652, 16, 52, "Input",ExpressionUUID->"449ef872-5214-434e-890c-6928c8723012"],
Cell[97073, 2716, 7209, 142, 246, "Output",ExpressionUUID->"4e48e08c-dc2b-410a-b0e4-cbb060a96cd7"]
}, Open  ]],
Cell[104297, 2861, 823, 22, 30, "Input",ExpressionUUID->"b5cc81ce-95ea-4dfc-9236-ea523d3d3bd1"],
Cell[105123, 2885, 700, 19, 30, "Input",ExpressionUUID->"5166016b-0a05-415f-b634-ab8b435c08a7"],
Cell[CellGroupData[{
Cell[105848, 2908, 445, 10, 52, "Input",ExpressionUUID->"463cfcc5-bf1a-4f23-b637-359554cdc94c"],
Cell[106296, 2920, 24622, 521, 248, "Output",ExpressionUUID->"2a942dac-157b-43c9-85d4-55932bf4ce2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130955, 3446, 629, 18, 52, "Input",ExpressionUUID->"d5703464-7f90-491c-81e4-bde2074c0ad7"],
Cell[131587, 3466, 5876, 118, 231, "Output",ExpressionUUID->"bc056a95-5f65-4a32-8459-a1293e5d9bd7"]
}, Open  ]],
Cell[137478, 3587, 447, 11, 30, "Input",ExpressionUUID->"f9703f34-3aec-4dde-a344-315bfe2131a9"],
Cell[137928, 3600, 399, 11, 30, "Input",ExpressionUUID->"a64f50b3-5570-402e-8c3c-ff5b421a3fed"],
Cell[138330, 3613, 1753, 49, 136, "Input",ExpressionUUID->"af15e473-64c6-41d5-90b3-e2ce2991ebba"],
Cell[140086, 3664, 796, 23, 30, "Input",ExpressionUUID->"295fb008-b8e3-48a9-abf6-c67a6f299a31"],
Cell[CellGroupData[{
Cell[140907, 3691, 1283, 35, 52, "Input",ExpressionUUID->"1091844f-403d-4cad-b2e4-1d24a4962b0e"],
Cell[142193, 3728, 9685, 217, 350, "Output",ExpressionUUID->"d296716f-83f8-4ae0-931a-7ca394c27de9"]
}, Open  ]],
Cell[151893, 3948, 1042, 28, 52, "Input",ExpressionUUID->"309b553d-8240-4178-b51a-f8ad1d51810c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[152984, 3982, 262, 4, 53, "Section",ExpressionUUID->"9204e9ed-c7f3-43b6-8912-53fee529bbed"],
Cell[CellGroupData[{
Cell[153271, 3990, 164, 3, 54, "Subsection",ExpressionUUID->"e009240c-b191-4f3c-910d-a1115b606475"],
Cell[153438, 3995, 960, 27, 52, "Input",ExpressionUUID->"878e5f0e-6601-4f4c-be9a-54c4fd4495e1"],
Cell[154401, 4024, 1629, 46, 73, "Input",ExpressionUUID->"638a3760-bf9c-4ef4-b9be-6f0784ff8cd9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156067, 4075, 171, 3, 54, "Subsection",ExpressionUUID->"ca3fe7ea-5b2a-4560-91c0-2828dff260a9"],
Cell[156241, 4080, 217, 6, 30, "Input",ExpressionUUID->"9d1def16-b635-4a65-bb83-f8f1bb376b4c"],
Cell[CellGroupData[{
Cell[156483, 4090, 440, 10, 30, "Input",ExpressionUUID->"cd64a19a-99d8-447c-b3f5-035cef7a36ab"],
Cell[156926, 4102, 1268, 21, 56, "Output",ExpressionUUID->"7ea8fee5-37e3-4a15-a979-417e168ae7ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158231, 4128, 495, 13, 30, "Input",ExpressionUUID->"f2c3ae30-6626-43e1-8031-e096fb9813cc"],
Cell[158729, 4143, 3627, 72, 246, "Output",ExpressionUUID->"c1e25f55-5715-459e-a5ac-470e792b0e32"]
}, Open  ]],
Cell[162371, 4218, 962, 27, 52, "Input",ExpressionUUID->"91d30e6c-4d15-4757-973a-92dce55c68c9"],
Cell[163336, 4247, 1722, 54, 94, "Input",ExpressionUUID->"fedb3487-7740-4a34-a080-fd51c128c0b5"],
Cell[165061, 4303, 1156, 26, 52, "Input",ExpressionUUID->"8f2f5990-6135-4793-8192-55ebf109734c"],
Cell[166220, 4331, 2282, 55, 73, "Input",ExpressionUUID->"23c5b21e-8aa7-4b4f-8305-a2426b051a30"],
Cell[CellGroupData[{
Cell[168527, 4390, 209, 4, 30, "Input",ExpressionUUID->"1dba38d1-6c07-4887-911e-a3282564cfd9"],
Cell[168739, 4396, 983, 17, 34, "Output",ExpressionUUID->"142c645d-aa3d-4144-aee9-d69cfb258137"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169759, 4418, 965, 25, 52, "Input",ExpressionUUID->"65b2d10e-1a93-4001-bb9e-37e077112afa"],
Cell[170727, 4445, 1280, 31, 34, "Output",ExpressionUUID->"a84955b0-433e-42f9-a420-2f39b45662ef"],
Cell[172010, 4478, 957, 17, 34, "Output",ExpressionUUID->"89ecaf3c-3c0d-4465-b56c-818c75447aa4"]
}, Open  ]],
Cell[172982, 4498, 1302, 26, 30, "Input",ExpressionUUID->"8819da25-31b9-415f-959c-808d0f4058cc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[174333, 4530, 211, 4, 53, "Section",ExpressionUUID->"885bb96d-33f6-4dba-b198-3251c0af37b9"],
Cell[174547, 4536, 651, 14, 52, "Input",ExpressionUUID->"47edaed4-e6f9-484f-a0d2-ecbeebea0901"],
Cell[CellGroupData[{
Cell[175223, 4554, 252, 4, 45, "Subsubsection",ExpressionUUID->"a170bb4e-bb60-4f43-9379-48a4251b5414"],
Cell[175478, 4560, 334, 7, 30, "Input",ExpressionUUID->"54ef3f6b-cdd0-42da-861b-20c8c98b4fde"],
Cell[175815, 4569, 3821, 87, 115, "Input",ExpressionUUID->"d87d867f-5dca-484f-a22e-adb748b2d2cb"],
Cell[CellGroupData[{
Cell[179661, 4660, 610, 15, 30, "Input",ExpressionUUID->"18ca31d5-3f06-4e22-855a-10ba36755576"],
Cell[180274, 4677, 213, 3, 34, "Output",ExpressionUUID->"517747c2-d506-4d75-9559-e4b519d499cb"]
}, Open  ]],
Cell[180502, 4683, 4749, 108, 325, "Input",ExpressionUUID->"e835956c-ffe3-4235-92ec-201fe19335d8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[185300, 4797, 159, 3, 67, "Section",ExpressionUUID->"0812490a-1f0f-4b01-aa1e-d9ffe58289f9"],
Cell[185462, 4802, 625, 16, 94, "Input",ExpressionUUID->"c26c9ca7-2c37-41c8-9bc3-4dacbc51a2c8"],
Cell[186090, 4820, 660, 17, 115, "Input",ExpressionUUID->"38592a16-9b17-4f32-823f-9deb3a4c71e9"],
Cell[186753, 4839, 2446, 65, 115, "Input",ExpressionUUID->"8e67a323-e9eb-4064-be03-ba315a6c7184"],
Cell[189202, 4906, 962, 27, 52, "Input",ExpressionUUID->"de0c2898-ea54-429c-98b3-f8369618a57a"],
Cell[190167, 4935, 3443, 107, 283, "Input",ExpressionUUID->"03aff0c9-ba5b-47f2-b7bc-bf5ad516b512"],
Cell[CellGroupData[{
Cell[193635, 5046, 159, 3, 54, "Subsection",ExpressionUUID->"8cdb67ae-2f36-46ff-9b00-7b44fb648baa"],
Cell[193797, 5051, 675, 15, 30, "Input",ExpressionUUID->"7afbfb0e-6a97-4161-8e78-28d30c782490"],
Cell[194475, 5068, 1338, 35, 115, "Input",ExpressionUUID->"9bbce28d-6fa8-4fbb-824e-ccc05c61409a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195850, 5108, 165, 3, 54, "Subsection",ExpressionUUID->"eaa0ef18-65ca-4977-b5d8-65223b925d9d"],
Cell[196018, 5113, 418, 9, 52, "Input",ExpressionUUID->"9e93a03c-0e2e-48d1-9905-740de96a33fd"],
Cell[196439, 5124, 1709, 43, 115, "Input",ExpressionUUID->"17a00aed-244e-49a2-a7b1-0d3e09e6d750"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198185, 5172, 218, 4, 54, "Subsection",ExpressionUUID->"fb06c115-d60e-487c-b094-708438e6b702"],
Cell[198406, 5178, 466, 9, 52, "Input",ExpressionUUID->"edbd18fb-da9c-4cbf-a77b-f19b06985579"],
Cell[198875, 5189, 281, 7, 30, "Input",ExpressionUUID->"f2bcbfcd-5ade-4468-8687-6b0faa64bb25"],
Cell[199159, 5198, 1980, 48, 115, "Input",ExpressionUUID->"150f9e8a-57e5-4f05-80fe-085e13a305cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201176, 5251, 266, 4, 54, "Subsection",ExpressionUUID->"52ae85a7-cca9-4af1-a441-b9ae98912676"],
Cell[201445, 5257, 519, 10, 52, "Input",ExpressionUUID->"a6eb4b90-c972-4173-83ee-21d46726ec7c"],
Cell[201967, 5269, 330, 8, 30, "Input",ExpressionUUID->"69c257e6-c9e5-4d0c-94b7-91a568f32880"],
Cell[202300, 5279, 1959, 48, 115, "Input",ExpressionUUID->"a7fe5e3a-3e8f-4bac-9e4a-a490c1852d99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204296, 5332, 167, 3, 54, "Subsection",ExpressionUUID->"11d4575f-5edc-4b9e-a952-49cb8b3970d9"],
Cell[204466, 5337, 4251, 128, 220, "Input",ExpressionUUID->"5fdbeee3-3b87-438e-9e61-c3715766a2a6"],
Cell[208720, 5467, 692, 20, 94, "Input",ExpressionUUID->"5899209d-a1d0-4587-aa85-4a53e928ffbf"],
Cell[209415, 5489, 7134, 177, 388, "Input",ExpressionUUID->"2f48ffd1-a29b-44e9-9a24-a40cad90ac13"],
Cell[216552, 5668, 528, 10, 30, "Input",ExpressionUUID->"25723b38-ff18-4218-a813-c49af2ae2372"],
Cell[217083, 5680, 618, 13, 30, "Input",ExpressionUUID->"961c687f-3c7b-41c0-b2a6-7a38b59ddb58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217738, 5698, 168, 3, 54, "Subsection",ExpressionUUID->"88cc7c65-730b-4cc0-bc0f-a586c45e531c"],
Cell[217909, 5703, 599, 16, 52, "Input",ExpressionUUID->"a66c76a3-f969-4278-8f37-7b6b3b91873d"],
Cell[218511, 5721, 295, 7, 30, "Input",ExpressionUUID->"e7284f3d-2cf7-4b84-b1ea-b54112721b7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218843, 5733, 184, 3, 54, "Subsection",ExpressionUUID->"fd4a7923-2c87-493a-b9bc-3b833b690779"],
Cell[219030, 5738, 4212, 130, 94, "Input",ExpressionUUID->"77eabd28-4a8a-415b-bf16-4ecc15394a76"],
Cell[223245, 5870, 331, 9, 30, "Input",ExpressionUUID->"93fad6d2-7f2a-4c1a-b078-6a173b3188c2"],
Cell[CellGroupData[{
Cell[223601, 5883, 147, 3, 30, "Input",ExpressionUUID->"f27c0136-8341-4349-8d7c-59b36d843218"],
Cell[223751, 5888, 314, 6, 34, "Output",ExpressionUUID->"b49fc87d-cddb-47d2-84c0-a9e7928e0d90"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[224114, 5900, 184, 3, 54, "Subsection",ExpressionUUID->"c2525d8e-9722-482c-bb71-0c691b44381b"],
Cell[224301, 5905, 4370, 132, 94, "Input",ExpressionUUID->"96ae7372-72b2-4b67-8425-ae2b10519c6f"],
Cell[228674, 6039, 498, 14, 30, "Input",ExpressionUUID->"0119177b-170e-4dea-97b1-8dea43fa73ff"],
Cell[229175, 6055, 474, 14, 30, "Input",ExpressionUUID->"c39e32cb-db79-48e8-8939-9331d20cb8b0"],
Cell[229652, 6071, 1294, 35, 52, "Input",ExpressionUUID->"0654aa40-23e6-4ce6-a4f8-a53a8d3cf4f9"],
Cell[230949, 6108, 872, 24, 30, "Input",ExpressionUUID->"2953fb90-d997-4fa0-bead-6b8e3819de5f"],
Cell[231824, 6134, 332, 9, 30, "Input",ExpressionUUID->"167879e3-4499-40db-8ff2-c55f6fbd9f67"],
Cell[232159, 6145, 638, 18, 30, "Input",ExpressionUUID->"c9f84799-34c5-4b15-9c36-0d6fd4d5f4ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232834, 6168, 168, 3, 54, "Subsection",ExpressionUUID->"69172085-aef1-4261-95ec-69ace37ff409"],
Cell[233005, 6173, 1569, 43, 115, "Input",ExpressionUUID->"18c1c4f8-0a45-4b6d-8f7b-0073d3d79ba4"],
Cell[234577, 6218, 20988, 518, 1942, "Input",ExpressionUUID->"15e958aa-1912-43d3-8946-db5de560a7e0"],
Cell[255568, 6738, 5019, 116, 472, "Input",ExpressionUUID->"4c6bb97d-3dc8-44c5-9bac-8ca55cc91828"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260624, 6859, 169, 3, 54, "Subsection",ExpressionUUID->"dbd1ffc2-a91a-43db-b5ca-c3ae0901f0d2"],
Cell[260796, 6864, 1627, 48, 94, "Input",ExpressionUUID->"f225f713-a710-4418-acac-42f110247960"],
Cell[262426, 6914, 2779, 61, 136, "Input",ExpressionUUID->"4a832b22-9ce0-452d-9343-91506bcd8f5c"],
Cell[265208, 6977, 677, 19, 52, "Input",ExpressionUUID->"003d22c5-c72d-404c-a902-1c087b27b551"],
Cell[265888, 6998, 1829, 42, 115, "Input",ExpressionUUID->"42579d9a-30bc-448d-8677-72823c1a2d0f"],
Cell[267720, 7042, 1054, 27, 52, "Input",ExpressionUUID->"a2f1e743-f563-4162-bf1c-cd6a67cbf65d"],
Cell[268777, 7071, 855, 20, 52, "Input",ExpressionUUID->"2698bda2-af0e-4246-addc-d1beca36d4fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269669, 7096, 155, 3, 54, "Subsection",ExpressionUUID->"9c37c51d-c62b-405a-b356-ef1ffd98d871"],
Cell[269827, 7101, 882, 23, 30, "Input",ExpressionUUID->"574773c7-28ef-40ef-9aa1-f796e70e8d47"],
Cell[270712, 7126, 986, 22, 30, "Input",ExpressionUUID->"4460d991-c03f-45f2-bc65-4da69cb01057"],
Cell[271701, 7150, 4138, 93, 262, "Input",ExpressionUUID->"bbba3472-20d4-4a8b-916c-cb3cb20ee51c"]
}, Open  ]]
}, Open  ]]
}
]
*)

